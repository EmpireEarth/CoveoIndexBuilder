{
    "title" : "Thoughts on custom export to Excel implementation",
    "uri" : "http://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
    "printableUri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
    "clickUri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
    "uniqueId" : "42.4247$http://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
    "excerpt" : "I have already implemented some export to excel functions against our Coveo indexes. ... Iâ ve created HTTP get methods I call on our front end that on the back end composes a Coveo query and execu...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1176,
    "percentScore" : 77.164955,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "Thoughts on custom export to Excel implementation",
      "sysauthor" : "ssantosb",
      "sysurihash" : "gFdFqiLBy0R0hvjT",
      "urihash" : "gFdFqiLBy0R0hvjT",
      "numberofanswers" : 0,
      "sysuri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
      "sysprintableuri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
      "sitemappriority" : 0.1,
      "systransactionid" : 160364,
      "questionaskeddatestring" : "·\n            Mar 13, 2017 at 10:47 AM ·",
      "tags" : [ "searchresults", "jsframework", "aq", "export", "excel" ],
      "sysconcepts" : "queries ; indexes ; Coveo ; export ; AQ ; JavaScript ; filtering ; server ; properties editor ; facets applied ; OpenXML library ; altogether ; developers ; re-execute",
      "concepts" : "queries ; indexes ; Coveo ; export ; AQ ; JavaScript ; filtering ; server ; properties editor ; facets applied ; OpenXML library ; altogether ; developers ; re-execute",
      "printableuri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
      "documenttype" : "WebPage",
      "sysindexeddate" : 1517943045000,
      "permanentid" : "7c3f09d0ac17d67407b131c1617aa3e0476559f7a4321586c76b826c7641",
      "syslanguage" : [ "English" ],
      "transactionid" : 160364,
      "title" : "Thoughts on custom export to Excel implementation",
      "date" : 1489363200000,
      "objecttype" : "Answers",
      "sitemapchangefrequency" : "Monthly",
      "hasanswer" : "false",
      "audience" : [ "Administrator", "Developer" ],
      "hasacceptedanswer" : "false",
      "sourcetype" : "Sitemap",
      "sysconnectortype" : "SitemapCrawler",
      "rowid" : 5448809,
      "numberofcomments" : 0,
      "size" : 64888,
      "sysdocumenttype" : "WebPage",
      "questionvotes" : 0,
      "clickableuri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
      "syssource" : "AnswersCloud",
      "orderingid" : 212384744911579088,
      "acceptedanswers" : 0,
      "syssize" : 64888,
      "sysdate" : 1489363200000,
      "author" : "ssantosb",
      "source" : "AnswersCloud",
      "questionbodyhtml" : "<div class=\"question-body\">\n                <p>I have already implemented some export to excel functions against our Coveo indexes. Iâ\x80\x99ve created HTTP get methods I call on our front end that on the back end composes a Coveo query and executes the query against the index. Then it gets the resulting documents and using the OpenXML library builds the Excel and sends it back to the user. In these cases the parameters for the queries are fixed. So I can compose the query server side. All is well.</p> \n<p>Now I want to build a custom export to excel link that gets the results from the search page which as you know could have any number of search conditions, whatever the user put in the search box, facets applied, filters added from JavaScript, filtering rules from the Coveo search properties editor etc. </p> \n<p>I need to build a export to excel link so a user can export the results they just searched for. The problem with the default Coveo export is all columns are included in the export. We need to specify which columns to export. </p> \n<p>How could I get the full query that the user executed? Does the AQ contain the full query? Could I pass that back to my server side code and re-execute it against the index and get the same results the user would see? If so how do I get the AQ?</p> \n<p>One of our developers recommends gathering the results already queried for and parsing through them in JavaScript and sending a collection back to generate the Excel. Would this be a better approach? I would be interested in your thoughts. Or maybe is there a different way altogether?</p> \n<p>If you have any other insight on this I would appreciate it very much. Thank you, Sybil</p>\n                </div>",
      "sitemaplastmodified" : 1489363200000,
      "collection" : "default",
      "syssourcetype" : "Sitemap",
      "indexeddate" : 1517943045000,
      "questionnumber" : 10742,
      "connectortype" : "SitemapCrawler",
      "filetype" : "html",
      "sysclickableuri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
      "sysfiletype" : "html",
      "language" : [ "English" ],
      "sitemapparenturl" : "http://answers.coveo.com/questions/1.xml",
      "questionauthor" : "ssantosb",
      "sitename" : "Answers",
      "sysrowid" : 5448809,
      "uri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
      "syscollection" : "default",
      "sitelanguage" : [ "English" ]
    },
    "Title" : "Thoughts on custom export to Excel implementation",
    "Uri" : "http://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
    "PrintableUri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
    "ClickUri" : "https://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
    "UniqueId" : "42.4247$http://answers.coveo.com/questions/10742/thoughts-on-custom-export-to-excel-implementation.html",
    "Excerpt" : "I have already implemented some export to excel functions against our Coveo indexes. ... Iâ ve created HTTP get methods I call on our front end that on the back end composes a Coveo query and execu...",
    "FirstSentences" : null
  }