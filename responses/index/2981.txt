{
    "title" : "KeyNotFoundException: The given key was not present in the dictionary.",
    "uri" : "http://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
    "printableUri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
    "clickUri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
    "uniqueId" : "42.4247$http://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
    "excerpt" : "KeyNotFoundException: The given key was not present in the dictionary. ... We have a very weird issue going on with some code we are executing to query Coveo. ... We have the following code running...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1168,
    "percentScore" : 76.90204,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "KeyNotFoundException: The given key was not present in the dictionary.",
      "sysauthor" : "ncipollina",
      "sysurihash" : "gYIgYkiM1lWrhQty",
      "urihash" : "gYIgYkiM1lWrhQty",
      "numberofanswers" : 0,
      "sysuri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
      "sysprintableuri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
      "sitemappriority" : 0.1,
      "systransactionid" : 160363,
      "questionaskeddatestring" : "·\n            Feb 01, 2017 at 04:54 PM ·",
      "tags" : [ "coveoforsitecore", "sitecore", "linq" ],
      "sysconcepts" : "environment ; Coveo ; load balancer ; servers ; Header potentially ; working prior ; configuration settings ; list of exceptions ; VirtualFields ; ReadDocumentFields ; CoveoDocumentTypeMapper ; SearchProvider ; TranslateFieldResult ; LatestVersionFieldProcessor ; ContentSearch",
      "concepts" : "environment ; Coveo ; load balancer ; servers ; Header potentially ; working prior ; configuration settings ; list of exceptions ; VirtualFields ; ReadDocumentFields ; CoveoDocumentTypeMapper ; SearchProvider ; TranslateFieldResult ; LatestVersionFieldProcessor ; ContentSearch",
      "printableuri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
      "documenttype" : "WebPage",
      "sysindexeddate" : 1517942982000,
      "permanentid" : "5d96b81b417f60366696fa9480eeacdc01588343e9cc2da29b911fa566b9",
      "syslanguage" : [ "English" ],
      "transactionid" : 160363,
      "title" : "KeyNotFoundException: The given key was not present in the dictionary.",
      "date" : 1485993600000,
      "objecttype" : "Answers",
      "sitemapchangefrequency" : "Monthly",
      "hasanswer" : "false",
      "audience" : [ "Administrator", "Developer" ],
      "commentauthor" : [ "ncipollina" ],
      "hasacceptedanswer" : "false",
      "sourcetype" : "Sitemap",
      "sysconnectortype" : "SitemapCrawler",
      "rowid" : 5448729,
      "numberofcomments" : 1,
      "size" : 68057,
      "sysdocumenttype" : "WebPage",
      "questionvotes" : 0,
      "clickableuri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
      "syssource" : "AnswersCloud",
      "orderingid" : 212384744911579008,
      "acceptedanswers" : 0,
      "syssize" : 68057,
      "sysdate" : 1485993600000,
      "author" : "ncipollina",
      "source" : "AnswersCloud",
      "questionbodyhtml" : "<div class=\"question-body\">\n                <p>We have a very weird issue going on with some code we are executing to query Coveo. We have the following code running in our test environment (thankfully it hasn't yet gone to production):</p> \n<pre><code> var productIds = orderResponse.Result.LineItems.Select(item => item.ProductId);\n IEnumerable<SearchResultItem> results = Enumerable.Empty<SearchResultItem>();\n ISearchIndex index = ContentSearchManager.GetIndex(CurrentCoveoIndex);\n using (var context = index.CreateSearchContext())\n {\n     var queryable = context.GetQueryable<SearchResultItem>().Where(item => item.TemplateName == IProductSKUModelConstants.TemplateName && productIds.Contains(item[IProductSKUModelConstants.ProductIdFieldName]));\n     results = queryable.ToList();\n }\n\n foreach (var sku in results)\n {\n     var skuModel = SitecoreService.Cast<ProductSKUModel>(sku.GetItem());\n     var product = orderResponse.Result.LineItems.First(item => item.ProductId == skuModel.ProductId);\n     if (product != null)\n         product.WarehouseOnlineOrderable = skuModel.WarehouseOnlineOrderable;\n }\n\n</code></pre> \n<p>Our environment has two load balanced servers. When bypassing the load balancer and going directly to the individual server, this works fine. When we hit this code via the load balancer, we get a list of exceptions similar to the following:</p> \n<pre><code> 18008 16:41:38 WARN  The current item (Home) could not be processed by the field processor Sitecore.ContentSearch.VirtualFields.LatestVersionFieldProcessor.\n Exception: System.Collections.Generic.KeyNotFoundException\n Message: The given key was not present in the dictionary.\n Source: mscorlib\n   at System.Collections.Generic.Dictionary`2.get_Item(TKey key)\n   at Sitecore.ContentSearch.VirtualFields.LatestVersionFieldProcessor.TranslateFieldResult(IDictionary`2 fields, FieldNameTranslator fieldNameTranslator)\n   at Coveo.SearchProvider.CoveoDocumentTypeMapper.ReadDocumentFields[TElement](QueryResult p_Document, IEnumerable`1 p_FieldNames, DocumentTypeMapInfo p_DocumentTypeMapInfo, IEnumerable`1 p_VirtualFieldProcessors, TElement p_Result)\n\n</code></pre> \n<p>Our issue seems very similar to <a rel=\"nofollow\" href=\"https://answers.coveo.com/questions/1825/the-given-key-was-not-present-in-the-dictionar\">this</a> issue, but I feel like if we were having the same issue, it would fail when bypassing the loadbalancer as well as when going through the load balancer. Any assistance in this issue would be very helpful.</p> \n<p>Thanks in advance, Nick</p>\n                </div>",
      "sitemaplastmodified" : 1485993600000,
      "collection" : "default",
      "syssourcetype" : "Sitemap",
      "indexeddate" : 1517942982000,
      "questionnumber" : 10344,
      "connectortype" : "SitemapCrawler",
      "filetype" : "html",
      "sysclickableuri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
      "sysfiletype" : "html",
      "language" : [ "English" ],
      "sitemapparenturl" : "http://answers.coveo.com/questions/1.xml",
      "questionauthor" : "ncipollina",
      "sitename" : "Answers",
      "sysrowid" : 5448729,
      "uri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
      "syscollection" : "default",
      "sitelanguage" : [ "English" ]
    },
    "Title" : "KeyNotFoundException: The given key was not present in the dictionary.",
    "Uri" : "http://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
    "PrintableUri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
    "ClickUri" : "https://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
    "UniqueId" : "42.4247$http://answers.coveo.com/questions/10344/keynotfoundexception-the-given-key-was-not-present.html",
    "Excerpt" : "KeyNotFoundException: The given key was not present in the dictionary. ... We have a very weird issue going on with some code we are executing to query Coveo. ... We have the following code running...",
    "FirstSentences" : null
  }