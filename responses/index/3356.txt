{
    "title" : "Cleaning HTML content in PreConversion for Summary",
    "uri" : "http://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
    "printableUri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
    "clickUri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
    "uniqueId" : "42.4247$http://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
    "excerpt" : "I am currently trying to delete content between certain tags of an HTML source in PreConversion. ... The Summary tab under \"Details\" in the CES Index Browser currently shows information unrelated t...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1142,
    "percentScore" : 76.0413,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "Cleaning HTML content in PreConversion for Summary",
      "sysauthor" : "pxbhuang",
      "sysurihash" : "3LFHqSRvRuXjPxqX",
      "urihash" : "3LFHqSRvRuXjPxqX",
      "numberofanswers" : 1,
      "sysuri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
      "sysprintableuri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
      "sitemappriority" : 0.1,
      "systransactionid" : 160359,
      "questionaskeddatestring" : "·\n            Jul 21, 2016 at 10:27 AM ·",
      "tags" : [ "html", "summary", "preconversion", "inputdocument", "invalidcastexception" ],
      "sysconcepts" : "preconverter ; Charsets ; InputDocument ; coveo ; custom converter ; InvalidCastException ; CP1252 ; deletion operation ; successfully extracted ; Index Browser ; instructions ; WriteAsByteString ; ReadByteString",
      "concepts" : "preconverter ; Charsets ; InputDocument ; coveo ; custom converter ; InvalidCastException ; CP1252 ; deletion operation ; successfully extracted ; Index Browser ; instructions ; WriteAsByteString ; ReadByteString",
      "printableuri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
      "documenttype" : "WebPage",
      "sysindexeddate" : 1517942675000,
      "permanentid" : "7986b8c22d5f0d21b9454856d29af4901e7c15b6f31004a9462a12a3a853",
      "syslanguage" : [ "English" ],
      "transactionid" : 160359,
      "title" : "Cleaning HTML content in PreConversion for Summary",
      "date" : 1469059200000,
      "objecttype" : "Answers",
      "sitemapchangefrequency" : "Monthly",
      "answerauthor" : [ "Jean-François L'Heureux" ],
      "hasanswer" : "true",
      "audience" : [ "Administrator", "Developer" ],
      "commentauthor" : [ "pxbhuang" ],
      "hasacceptedanswer" : "true",
      "sourcetype" : "Sitemap",
      "sysconnectortype" : "SitemapCrawler",
      "rowid" : 5448331,
      "numberofcomments" : 1,
      "size" : 72992,
      "sysdocumenttype" : "WebPage",
      "questionvotes" : 0,
      "clickableuri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
      "syssource" : "AnswersCloud",
      "orderingid" : 212384744911578630,
      "acceptedanswers" : 1,
      "syssize" : 72992,
      "sysdate" : 1469059200000,
      "author" : "pxbhuang",
      "source" : "AnswersCloud",
      "questionbodyhtml" : "<div class=\"question-body\">\n                <p>I am currently trying to delete content between certain tags of an HTML source in PreConversion. The Summary tab under \"Details\" in the CES Index Browser currently shows information unrelated to the documents, and as I understand it, cleaning HTML in PreConversion will prevent Coveo from putting that information in the Summary. My code looks as follows:</p> \n<pre><code> string body = preConversion.InputDocument.ReadByteString(preConversion.InputDocument.BytesCount, Charsets.CP1252_CHARSET);\n // Do deletion modifications to body\n preConversion.InputDocument.WriteAsByteString(body, Charsets.CP1252_CHARSET); // throws InvalidCastException\n\n</code></pre> \n<p>The line where I try to write back to the InputDocument throws an InvalidCastException when a document is run through the preconverter. I have validated that the HTML body is successfully extracted and the deletion operation is performed, but it always fails on the last line. Why is this the case?</p>\n                </div>",
      "sitemaplastmodified" : 1469059200000,
      "collection" : "default",
      "syssourcetype" : "Sitemap",
      "indexeddate" : 1517942675000,
      "questionnumber" : 8587,
      "connectortype" : "SitemapCrawler",
      "filetype" : "html",
      "sysclickableuri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
      "sysfiletype" : "html",
      "language" : [ "English" ],
      "sitemapparenturl" : "http://answers.coveo.com/questions/1.xml",
      "questionauthor" : "pxbhuang",
      "sitename" : "Answers",
      "sysrowid" : 5448331,
      "uri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
      "syscollection" : "default",
      "sitelanguage" : [ "English" ]
    },
    "Title" : "Cleaning HTML content in PreConversion for Summary",
    "Uri" : "http://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
    "PrintableUri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
    "ClickUri" : "https://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
    "UniqueId" : "42.4247$http://answers.coveo.com/questions/8587/cleaning-html-content-in-preconversion-for-summary.html",
    "Excerpt" : "I am currently trying to delete content between certain tags of an HTML source in PreConversion. ... The Summary tab under \"Details\" in the CES Index Browser currently shows information unrelated t...",
    "FirstSentences" : null
  }