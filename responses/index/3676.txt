{
    "title" : "clickUri fails for Media Library",
    "uri" : "http://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
    "printableUri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
    "clickUri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
    "uniqueId" : "42.4247$http://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
    "excerpt" : "So, it's bypassing the Media Handler, and failing to resolve, since we don't have layouts assigned to Media Lib items. ... The solution was simple enough (see code below), but it seems to me that t...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1123,
    "percentScore" : 75.406075,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "clickUri fails for Media Library",
      "sysauthor" : "Daniel Reedy",
      "sysurihash" : "R8o6Nñ4SKhe5CWWR",
      "urihash" : "R8o6Nñ4SKhe5CWWR",
      "numberofanswers" : 0,
      "sysuri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
      "sysprintableuri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
      "sitemappriority" : 0.1,
      "systransactionid" : 160356,
      "questionaskeddatestring" : "·\n            Dec 28, 2015 at 07:11 PM ·",
      "tags" : [ "coveoforsitecore" ],
      "sysconcepts" : "media ; Coveo ; Daniel Reedy ; sensitive information ; index browser ; Sitecore OTB ; see code ; look",
      "concepts" : "media ; Coveo ; Daniel Reedy ; sensitive information ; index browser ; Sitecore OTB ; see code ; look",
      "printableuri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
      "documenttype" : "WebPage",
      "sysindexeddate" : 1517942444000,
      "permanentid" : "c79cc271f3857bfa8816825233765a156144ce3043851f2bc7988cfff136",
      "syslanguage" : [ "English" ],
      "transactionid" : 160356,
      "title" : "clickUri fails for Media Library",
      "date" : 1452643200000,
      "objecttype" : "Answers",
      "sitemapchangefrequency" : "Monthly",
      "hasanswer" : "false",
      "audience" : [ "Administrator", "Developer" ],
      "commentauthor" : [ "Simon \u2666\u2666", "Daniel Reedy", "Simon \u2666\u2666", "Daniel Reedy", "Jean-François L'Heureux \u2666\u2666" ],
      "hasacceptedanswer" : "false",
      "sourcetype" : "Sitemap",
      "sysconnectortype" : "SitemapCrawler",
      "rowid" : 5448011,
      "numberofcomments" : 5,
      "size" : 75358,
      "sysdocumenttype" : "WebPage",
      "questionvotes" : 0,
      "clickableuri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
      "syssource" : "AnswersCloud",
      "orderingid" : 212384744911578310,
      "acceptedanswers" : 0,
      "syssize" : 75358,
      "sysdate" : 1452643200000,
      "author" : "Daniel Reedy",
      "source" : "AnswersCloud",
      "questionbodyhtml" : "<div class=\"question-body\">\n                <p>I upgraded from Coveo 3.0 March 2015 to December 2015. The clickUri for ordinary items works. However, the clickUri for Media Library items comes back like this:</p> \n<ul> \n <li><p> /sitecore/media_library/Downloads/Insights/Viewpoints/082714_MKTwp3434.aspx</p> </li> \n</ul> \n<p>So, it's bypassing the Media Handler, and failing to resolve, since we don't have layouts assigned to Media Lib items. The solution was simple enough (see code below), but it seems to me that this should be done by Coveo/Sitecore OTB. It was before!</p> \n<pre><code> public void Process(CoveoProcessParsedRestResponseArgs p_Args)\n {\n   string clickUri;\n   string hostName = System.Web.HttpContext.Current.Request.Url.Host;\n \n   SearchResponse response = p_Args.ResponseContent;\n   foreach (SearchResult result in response.Results)\n   {\n     clickUri = result.ClickUri;\n     if (!string.IsNullOrEmpty(clickUri))\n     {\n       if (clickUri.Contains(@\"/sitecore/media_library/\"))\n       {\n         clickUri = clickUri.Replace(@\"/sitecore/media_library/\", @\"/~/media/\");\n       }\n       result.ClickUri = clickUri;\n     }\n   }\n }\n</code></pre>\n                </div>",
      "sitemaplastmodified" : 1452643200000,
      "collection" : "default",
      "syssourcetype" : "Sitemap",
      "indexeddate" : 1517942444000,
      "questionnumber" : 7030,
      "connectortype" : "SitemapCrawler",
      "filetype" : "html",
      "sysclickableuri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
      "sysfiletype" : "html",
      "language" : [ "English" ],
      "sitemapparenturl" : "http://answers.coveo.com/questions/1.xml",
      "questionauthor" : "Daniel Reedy",
      "sitename" : "Answers",
      "sysrowid" : 5448011,
      "uri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
      "syscollection" : "default",
      "sitelanguage" : [ "English" ]
    },
    "Title" : "clickUri fails for Media Library",
    "Uri" : "http://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
    "PrintableUri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
    "ClickUri" : "https://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
    "UniqueId" : "42.4247$http://answers.coveo.com/questions/7030/clickuri-fails-for-media-library.html",
    "Excerpt" : "So, it's bypassing the Media Handler, and failing to resolve, since we don't have layouts assigned to Media Lib items. ... The solution was simple enough (see code below), but it seems to me that t...",
    "FirstSentences" : null
  }