{
    "title" : "500: Server Error - Perform Authentication",
    "uri" : "http://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
    "printableUri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
    "clickUri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
    "uniqueId" : "42.4247$http://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
    "excerpt" : "500: Server Error - Perform Authentication ... We have just promoted the Coveo build out of our salesforce UAT sandbox and pushed to our BETA environment. ... We are using CoveoV2 for Salesforce us...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1228,
    "percentScore" : 78.85253,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "500: Server Error - Perform Authentication",
      "sysauthor" : "bciancio",
      "sysurihash" : "hmLbALhXVfglteRJ",
      "urihash" : "hmLbALhXVfglteRJ",
      "numberofanswers" : 2,
      "sysuri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
      "sysprintableuri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
      "sitemappriority" : 0.1,
      "systransactionid" : 160369,
      "questionaskeddatestring" : "·\n            Sep 21, 2017 at 08:03 PM ·",
      "tags" : [ "salesforce", "error", "freeversion", "coveov2", "partner community" ],
      "sysconcepts" : "community ; environment ; salesforce ; Coveo ; UAT ; flow ; profiles ; Enabled permission ; encountered configuration ; Express edition ; using CoveoV2 ; authorizing ; documentation ; Authentication",
      "concepts" : "community ; environment ; salesforce ; Coveo ; UAT ; flow ; profiles ; Enabled permission ; encountered configuration ; Express edition ; using CoveoV2 ; authorizing ; documentation ; Authentication",
      "printableuri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
      "documenttype" : "WebPage",
      "sysindexeddate" : 1517943351000,
      "permanentid" : "832a55957ada22cb8072de530fa05115e964c2679b0ea43a2a748c0c008b",
      "syslanguage" : [ "English" ],
      "transactionid" : 160369,
      "title" : "500: Server Error - Perform Authentication",
      "date" : 1506038400000,
      "objecttype" : "Answers",
      "sitemapchangefrequency" : "Monthly",
      "answerauthor" : [ "bciancio", "maveilleux" ],
      "hasanswer" : "true",
      "audience" : [ "Administrator", "Developer" ],
      "commentauthor" : [ "bciancio", "maveilleux \u2666", "bciancio" ],
      "hasacceptedanswer" : "true",
      "sourcetype" : "Sitemap",
      "sysconnectortype" : "SitemapCrawler",
      "rowid" : 5449220,
      "numberofcomments" : 1,
      "size" : 90239,
      "sysdocumenttype" : "WebPage",
      "questionvotes" : 0,
      "clickableuri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
      "syssource" : "AnswersCloud",
      "orderingid" : 212384744911579500,
      "acceptedanswers" : 1,
      "syssize" : 90239,
      "sysdate" : 1506038400000,
      "author" : "bciancio",
      "source" : "AnswersCloud",
      "questionbodyhtml" : "<div class=\"question-body\">\n                <p>\n<p>We have just promoted the Coveo build out of our salesforce UAT sandbox and pushed to our BETA environment. We are using CoveoV2 for Salesforce using the <strong>Free/Express</strong> edition.</p>\n<p><strong>When/What:</strong> We are receiving an error when we navigate to the search logged in as a <u>community user</u>. We are not getting errors when viewing the same page as an internal user.</p>\n<p>We have performed the steps in the documentation<a rel=\"nofollow\" href=\"https://developers.coveo.com/display/public/SalesforceV2/Step+3+-+Allowing+User+Impersonation\"> here</a>. Which goes over authorizing specific users or profiles as well as setting up the JWT flow.</p>\n<p>Here is the full error:</p>\n<pre>{\n  \"status\": 500,\n  \"message\": \"Server Error\",\n  \"type\": \"UnexpectedErrorFault\",\n  \"name\": \"UnexpectedErrorFault\",\n  \"queryExecutionReport\": [\n    {\n      \"children\": [\n        {\n          \"description\": \"Perform authentication\",\n          \"duration\": 1,\n          \"configured\": {\n            \"primary\": \"CloudToken\",\n            \"secondary\": [],\n            \"mandatory\": []\n          },\n          \"result\": {\n            \"userIds\": [\n              {\n                \"name\": \"bciancio@trident-it.com\",\n                \"kind\": \"User\",\n                \"provider\": \"Email Security Provider\",\n                \"infos\": {}\n              }\n            ],\n            \"roles\": [\n              \"queryExecutor\"\n            ],\n            \"queryRestrictions\": {\n              \"pipeline\": null,\n              \"filter\": \"NOT @sfResource_Type__c==(\\\"Cloud Academy\\\",\\\"Product Video\\\",\\\"LOA/SOW\\\") ((NOT @sfDisplay_In_Community__c=false NOT @sfVisible_to_All_Sellers__c=false) OR (NOT @sfid)) NOT @sfrecordtypename==(\\\"Avant Accounts\\\",\\\"Provider: non-BattleApp\\\",\\\"Seller\\\",\\\"Team LED Accounts\\\") NOT @sfstatus__c==(\\\"Draft\\\",\\\"Inactive\\\") (NOT @objecttype)\"\n            },\n            \"userGroups\": [\n              \"Avant Partner Community User\"\n            ]\n          },\n          \"children\": [\n            {\n              \"description\": \"Resolve authentication of provider: CloudToken\",\n              \"duration\": 1,\n              \"result\": {\n                \"userIds\": [\n                  {\n                    \"name\": \"bciancio@trident-it.com\",\n                    \"kind\": \"User\",\n                    \"provider\": \"Email Security Provider\",\n                    \"infos\": {}\n                  }\n                ],\n                \"roles\": [\n                  \"queryExecutor\"\n                ],\n                \"queryRestrictions\": {\n                  \"pipeline\": null,\n                  \"filter\": \"NOT @sfResource_Type__c==(\\\"Cloud Academy\\\",\\\"Product Video\\\",\\\"LOA/SOW\\\") ((NOT @sfDisplay_In_Community__c=false NOT @sfVisible_to_All_Sellers__c=false) OR (NOT @sfid)) NOT @sfrecordtypename==(\\\"Avant Accounts\\\",\\\"Provider: non-BattleApp\\\",\\\"Seller\\\",\\\"Team LED Accounts\\\") NOT @sfstatus__c==(\\\"Draft\\\",\\\"Inactive\\\") (NOT @objecttype)\"\n                },\n                \"userGroups\": [\n                  \"Avant Partner Community User\"\n                ]\n              }\n            },\n            {\n              \"description\": \"Merge authentications (if needed)\",\n              \"duration\": 0,\n              \"result\": {\n                \"userIds\": [\n                  {\n                    \"name\": \"bciancio@trident-it.com\",\n                    \"kind\": \"User\",\n                    \"provider\": \"Email Security Provider\",\n                    \"infos\": {}\n                  }\n                ],\n                \"roles\": [\n                  \"queryExecutor\"\n                ],\n                \"queryRestrictions\": {\n                  \"pipeline\": null,\n                  \"filter\": \"NOT @sfResource_Type__c==(\\\"Cloud Academy\\\",\\\"Product Video\\\",\\\"LOA/SOW\\\") ((NOT @sfDisplay_In_Community__c=false NOT @sfVisible_to_All_Sellers__c=false) OR (NOT @sfid)) NOT @sfrecordtypename==(\\\"Avant Accounts\\\",\\\"Provider: non-BattleApp\\\",\\\"Seller\\\",\\\"Team LED Accounts\\\") NOT @sfstatus__c==(\\\"Draft\\\",\\\"Inactive\\\") (NOT @objecttype)\"\n                },\n                \"userGroups\": [\n                  \"Avant Partner Community User\"\n                ]\n              }\n            }\n          ]\n        },\n        {\n          \"description\": \"Resolve context\",\n          \"duration\": 1,\n          \"result\": {\n            \"userAgent\": {\n              \"raw\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36\",\n              \"browser\": [\n                \"chrome\"\n              ],\n              \"device\": [\n                \"desktop\",\n                \"pc\",\n                \"windows\"\n              ],\n              \"os\": [\n                \"windows\"\n              ]\n            },\n            \"expressions\": {\n              \"q\": {\n                \"original\": \"8x8\",\n                \"parsed\": \"8x8\"\n              },\n              \"aq\": {\n                \"original\": \"\",\n                \"parsed\": null\n              },\n              \"cq\": {\n                \"original\": \"@objecttype==(Account, Resource_List__c, scormanywhere__Course__c, redwing__Learning_Category__c, Lead_Forms__c)\",\n                \"parsed\": \"@objecttype==(Account,Resource_List__c,scormanywhere__Course__c,redwing__Learning_Category__c,Lead_Forms__c)\"\n              },\n              \"dq\": {\n                \"original\": \"\",\n                \"parsed\": null\n              }\n            },\n            \"enableDuplicateFiltering\": false,\n            \"filterField\": null,\n            \"filterFieldRange\": 5,\n            \"parentField\": null,\n            \"childField\": null,\n            \"searchHub\": \"default\",\n            \"tab\": \"All\",\n            \"recommendation\": null,\n            \"locale\": \"en\",\n            \"lowercaseOperators\": false,\n            \"context\": {},\n            \"sortCriteria\": [\n              \"relevancy\"\n            ]\n          }\n        },\n        {\n          \"description\": \"Resolve pipeline\",\n          \"duration\": 0,\n          \"result\": {\n            \"pipeline\": \"default\",\n            \"splitTest\": null\n          }\n        }\n      ]\n    }\n  ]\n}\n</pre>\n<p>We are unsure if this is related if the following is related, but when we were setting up Coveo in our UAT environment, we previously encountered configuration errors when setting up <a rel=\"nofollow\" href=\"https://answers.coveo.com/answers/11934/view.html\"> JWT </a>and this was the reason:</p>\n<p><em>\"JWT flow needs the URL of the community, and the package is sending in <a rel=\"nofollow\" href=\"http://www.battleapp.info\">www.battleapp.info</a> to our backend (this being the public site url), but it should instead send in the <a rel=\"nofollow\" href=\"http://force.com\">force.com</a> URL for the community.\"</em></p>\n<p>Any help and thoughts are appreciated. Thank you!</p> \n<p>\n                </div>",
      "sitemaplastmodified" : 1506038400000,
      "collection" : "default",
      "syssourcetype" : "Sitemap",
      "indexeddate" : 1517943351000,
      "questionnumber" : 12878,
      "connectortype" : "SitemapCrawler",
      "filetype" : "html",
      "sysclickableuri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
      "sysfiletype" : "html",
      "language" : [ "English" ],
      "sitemapparenturl" : "http://answers.coveo.com/questions/1.xml",
      "questionauthor" : "bciancio",
      "sitename" : "Answers",
      "sysrowid" : 5449220,
      "uri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
      "syscollection" : "default",
      "sitelanguage" : [ "English" ]
    },
    "Title" : "500: Server Error - Perform Authentication",
    "Uri" : "http://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
    "PrintableUri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
    "ClickUri" : "https://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
    "UniqueId" : "42.4247$http://answers.coveo.com/questions/12878/500-server-error-perform-authentication.html",
    "Excerpt" : "500: Server Error - Perform Authentication ... We have just promoted the Coveo build out of our salesforce UAT sandbox and pushed to our BETA environment. ... We are using CoveoV2 for Salesforce us...",
    "FirstSentences" : null
  }