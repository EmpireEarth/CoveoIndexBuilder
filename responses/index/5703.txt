{
    "title" : "Javascript version of Finding Available Metadata VBScript",
    "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
    "printableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
    "clickUri" : "https://na61.salesforce.com/kA13200000006GC",
    "uniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
    "excerpt" : "This topic explain how to use the AllFieldValues JavaScript postconversion script. ... It will help extract and review all the available metadata in the document of a repository. ... Environment .....",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1330,
    "percentScore" : 82.062035,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "Javascript version of Finding Available Metadata VBScript",
      "sysurihash" : "ECTCDnpt4FyLtwXS",
      "urihash" : "ECTCDnpt4FyLtwXS",
      "parents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Javascript version of Finding Available Metadata VBScript\" uri=\"https://na61.salesforce.com/kA13200000006GC\" /></parents>",
      "sfdcarticletype" : "How To/Question",
      "sfresolutionc" : "The main difference between VBS and JS is the following:\n<p>Once at step 3 of the <span style=\"font-size: 12px;\"><span style=\"font-weight: bold;\"><a href=\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/finding_available_metadata.htm\" target=\"_blank\">Finding Available Metadata</a> </span></span>online help article, instead of naming the custom field &quot;AllFieldValues&quot;, it will have to be named &quot;everything&quot;</p>\nHere is an example of the JS script:\n\n<pre class=\"ckeditor_codeblock\">\nvar everything = &quot;&quot;;\n\n// fields\nvar DOUBLE_QUOTE = &#39;&quot;&#39;;\nvar NEW_LINE     = &quot;\\r\\n&quot;;\n// This buffer variable holds all metadata names and values.\nvar allValues = &quot;&lt;AllFieldValues&gt;&quot; + NEW_LINE;\n// A collection of all field names.\nvar fieldNames = new VBArray(DocumentInfo.Fields());\n// For each document field name.\nfor (var i = fieldNames.lbound(); i &lt;= fieldNames.ubound(); ++i) {\n  // Get the field value.\n  var fieldName  = fieldNames.getItem(i);\n  var fieldValue = DocumentInfo.GetFieldValue(fieldName);\n  // Add the metadata name and its value to the buffer variable.\n  allValues += &quot;&lt;Field&quot;;\n  allValues += &quot; name=&quot;  + DOUBLE_QUOTE + XmlEncode(fieldName)  + DOUBLE_QUOTE;\n  allValues += &quot; value=&quot; + DOUBLE_QUOTE + XmlEncode(fieldValue) + DOUBLE_QUOTE;\n  allValues += &quot; type=&quot;  + DOUBLE_QUOTE + typeof(fieldValue)    + DOUBLE_QUOTE;\n  allValues += &quot; /&gt;&quot; + NEW_LINE;\n}\n\neverything += allValues;\n\n// bodytext\nPostConversion.Text.SeekReadPointerInChars(0);\nvar documentContent = PostConversion.Text.ReadString(PostConversion.Text.CharsCount);\neverything += documentContent;\n\nDocumentInfo.SetFieldValue(&quot;everything&quot;, everything);\n\n\n// function\nfunction XmlEncode(value)\n{\n  var ret = &quot;&quot;;\n  if (value != null) {\n    var val = value + &quot;&quot;;\n    for (var i = 0; i &lt; val.length; ++i) {\n      var ch = val.charAt(i);\n      if (ch != &#39; &#39; &amp;&amp; !(ch &gt;= &#39;a&#39; &amp;&amp; ch &lt;= &#39;z&#39;) &amp;&amp; !(ch &gt;= &#39;A&#39; &amp;&amp; ch &lt;= &#39;Z&#39;) &amp;&amp; !(ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;)) {\n        ch = &quot;&amp;#&quot; + ch.charCodeAt(0) + &quot;;&quot;;\n      }\n      ret += ch;\n    }\n  }\n  return ret;\n}</pre>\n<br><br> ",
      "sysuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
      "sysprintableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
      "sflastpublisheddate" : 1488206358000,
      "systransactionid" : 161139,
      "sfversionc" : "CES7",
      "sfurlname" : "1205",
      "sfsystemmodstamp" : 1515757479000,
      "sfisvisibleinapp" : "true",
      "sysconcepts" : "metadata ; script ; AllFieldValues ; online help ; var ; repository ; extract ; Resolution ; Environment",
      "sfkbversionnumber" : "1",
      "concepts" : "metadata ; script ; AllFieldValues ; online help ; var ; repository ; extract ; Resolution ; Environment",
      "printableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
      "documenttype" : "article",
      "sfkbarticlekavid" : "ka1320000000Bc2AAE",
      "sysindexeddate" : 1518187569000,
      "sfknowledgearticleid" : "kA13200000006GCCAY",
      "sfcreatedbyid" : "00560000002MKBSAA4",
      "sfconnectorc" : "N/A",
      "permanentid" : "4779b9f65dd33ccaf146c6c36d3103fd34efb2b5e9f00a9d9c5fb85b9ce3",
      "syslanguage" : [ "English" ],
      "transactionid" : 161139,
      "sfisvisibleinprm" : "true",
      "title" : "Javascript version of Finding Available Metadata VBScript",
      "sfversionnumber" : 1,
      "sfarticlenumber" : "000001205",
      "date" : 1515757479000,
      "objecttype" : "KB Article",
      "allmetadatavalues" : "{\"kav_lastmodifiedby.attribute.type\": [\"User\"], \"coveo_short_id\": [\"kA13200000006GC\"], \"sflastmodifiedbyname\": [\"Christian Bilodeau\"], \"kav_coveo_version__c__html_stripped\": [\"\"], \"fileextension\": [\"\"], \"sfdcexpandedproduct\": [\"All;All|Coveo Enterprise Search\"], \"kav_createdby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"sflanguage\": [\"en_US\"], \"kav_createdby.attribute.type\": [\"User\"], \"kav_createdby.id\": [\"00560000002MKBSAA4\"], \"kav_language\": [\"en_US\"], \"sfsitecoreversionc\": [\"N/A\"], \"sourcetype\": [\"Salesforce\"], \"title\": [\"Javascript version of Finding Available Metadata VBScript\"], \"source\": [\"Salesforce Public Items\"], \"kav_owner.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"parents\": [\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?><parents><parent name=\\\"Organization\\\" uri=\\\"https://na61.salesforce.com/home/home.jsp\\\" /><parent name=\\\"KB_Article__ka\\\" uri=\\\"http://www.salesforce.com/org:organization/articletype:KB_Article\\\" /><parent name=\\\"Javascript version of Finding Available Metadata VBScript\\\" uri=\\\"https://na61.salesforce.com/kA13200000006GC\\\" /></parents>\"], \"sfisvisibleinprm\": [true], \"kav_title\": [\"Javascript version of Finding Available Metadata VBScript\"], \"kav_isvisibleincsp\": [true], \"hashtmlversion\": [true], \"kav_version__c\": [\"CES7\"], \"kav_versionnumber\": [1], \"sfcreatedbyname\": [\"Karel Mpungi\"], \"sflastpublisheddate\": [1488206358], \"objecttypelabel\": [\"KB Article\"], \"kav_cause__c__html_stripped\": [\"This is similar to this  article . But instead of using VBS, we will use JS. \\n \\u00a0\"], \"originalhtmlcharset\": [1200], \"coveo_connector_hasbinarydata\": [false], \"kav_lastpublisheddate\": [1488206358], \"sfsystemmodstamp\": [1515757479], \"ka_attribute.type\": [\"KB_Article__ka\"], \"sfdcproduct\": [\"Coveo Enterprise Search\"], \"clickableuri\": [\"https://na61.salesforce.com/kA13200000006GC\"], \"kav_dc_expanded_product\": [\"All;All|Coveo Enterprise Search\"], \"sftitle\": [\"Javascript version of Finding Available Metadata VBScript\"], \"kav_owner.id\": [\"00560000002MKBSAA4\"], \"sfbuildc\": [\"All\"], \"sfisvisibleinapp\": [true], \"ka_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__ka/kA13200000006GCCAY\"], \"sfdcarticletype\": [\"How To/Question\"], \"kav_cause__c\": [\"This is similar to this <a href=\\\"http://https://onlinehelp.coveo.com/en/ces/7.0/administrator/finding_available_metadata.htm\\\" target=\\\"_blank\\\">article</a>. But instead of using VBS, we will use JS.<br>\\u00a0\"], \"sfislatestversion\": [true], \"sfcausec\": [\"This is similar to this <a href=\\\"http://https://onlinehelp.coveo.com/en/ces/7.0/administrator/finding_available_metadata.htm\\\" target=\\\"_blank\\\">article</a>. But instead of using VBS, we will use JS.<br>\\u00a0\"], \"contenttype\": [\"binarydata\"], \"sfurlname\": [\"1205\"], \"ka_id\": [\"kA13200000006GCCAY\"], \"kav_datacategoryselections.datacategoryname\": [\"Coveo_Enterprise_Search;How_To\"], \"coveo_url\": [\"https://na61.salesforce.com/kA13200000006GC\"], \"kav_urlname\": [\"1205\"], \"kav_articletype\": [\"KB_Article__kav\"], \"foldingcollection\": [\"c1b41ca52388531717ed7cf651837aab2154fd602928ec8ecfb3d99c46a6\"], \"body\": [\"<html>   <body>     <div style=\\\"background-color: #fff;border: 2px solid #BBC5CC;border-radius: 4px;float: left;font-family: lato;margin-left: 15px;margin-right: 15px;margin-bottom: 4%;padding: 10px;width: 60%;\\\">       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Description         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> This topic explain how to use the AllFieldValues JavaScript postconversion script. It will help extract and review all the available metadata in the document of a repository.</div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Environment         </div>       </div>       <br/>       <table>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Product</td>           <td>Coveo Enterprise Search</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Sitecore Version</td>           <td>N/A</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Connector</td>           <td>N/A</td>         </tr>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Published</td>           <td>1488206358</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Version</td>           <td>CES7</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Build</td>           <td>All</td>         </tr>       </table>       <br/>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Cause         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> This is similar to this <a href=\\\"http://https://onlinehelp.coveo.com/en/ces/7.0/administrator/finding_available_metadata.htm\\\" target=\\\"_blank\\\">article</a>. But instead of using VBS, we will use JS.<br>\\u00a0</div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Resolution         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> The main difference between VBS and JS is the following:\\n<p>Once at step\\u00a03 of the\\u00a0<span style=\\\"font-size: 12px;\\\"><span style=\\\"font-weight: bold;\\\"><a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/finding_available_metadata.htm\\\" target=\\\"_blank\\\">Finding Available Metadata</a>\\u00a0</span></span>online help article, instead of naming the custom field &quot;AllFieldValues&quot;, it will have to be named &quot;everything&quot;</p>\\nHere is an example of the JS script:\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nvar everything = &quot;&quot;;\\n\\n// fields\\nvar DOUBLE_QUOTE = &#39;&quot;&#39;;\\nvar NEW_LINE     = &quot;\\\\r\\\\n&quot;;\\n// This buffer variable holds all metadata names and values.\\nvar allValues = &quot;&lt;AllFieldValues&gt;&quot; + NEW_LINE;\\n// A collection of all field names.\\nvar fieldNames = new VBArray(DocumentInfo.Fields());\\n// For each document field name.\\nfor (var i = fieldNames.lbound(); i &lt;= fieldNames.ubound(); ++i) {\\n  // Get the field value.\\n  var fieldName  = fieldNames.getItem(i);\\n  var fieldValue = DocumentInfo.GetFieldValue(fieldName);\\n  // Add the metadata name and its value to the buffer variable.\\n  allValues += &quot;&lt;Field&quot;;\\n  allValues += &quot; name=&quot;  + DOUBLE_QUOTE + XmlEncode(fieldName)  + DOUBLE_QUOTE;\\n  allValues += &quot; value=&quot; + DOUBLE_QUOTE + XmlEncode(fieldValue) + DOUBLE_QUOTE;\\n  allValues += &quot; type=&quot;  + DOUBLE_QUOTE + typeof(fieldValue)    + DOUBLE_QUOTE;\\n  allValues += &quot; /&gt;&quot; + NEW_LINE;\\n}\\n\\neverything += allValues;\\n\\n// bodytext\\nPostConversion.Text.SeekReadPointerInChars(0);\\nvar documentContent = PostConversion.Text.ReadString(PostConversion.Text.CharsCount);\\neverything += documentContent;\\n\\nDocumentInfo.SetFieldValue(&quot;everything&quot;, everything);\\n\\n\\n// function\\nfunction XmlEncode(value)\\n{\\n  var ret = &quot;&quot;;\\n  if (value != null) {\\n    var val = value + &quot;&quot;;\\n    for (var i = 0; i &lt; val.length; ++i) {\\n      var ch = val.charAt(i);\\n      if (ch != &#39; &#39; &amp;&amp; !(ch &gt;= &#39;a&#39; &amp;&amp; ch &lt;= &#39;z&#39;) &amp;&amp; !(ch &gt;= &#39;A&#39; &amp;&amp; ch &lt;= &#39;Z&#39;) &amp;&amp; !(ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;)) {\\n        ch = &quot;&amp;#&quot; + ch.charCodeAt(0) + &quot;;&quot;;\\n      }\\n      ret += ch;\\n    }\\n  }\\n  return ret;\\n}</pre>\\n<br><br>\\u00a0</div>     </div>   </body> </html>\"], \"kav_product__c\": [\"Coveo Enterprise Search\"], \"sfpublishstatus\": [\"Online\"], \"sfcreatedbyid\": [\"00560000002MKBSAA4\"], \"kav_description__c__html_stripped\": [\"This topic explain how to use the AllFieldValues JavaScript postconversion script. It will help extract and review all the available metadata in the document of a repository.\"], \"kav_islatestversion\": [true], \"kav_knowledgearticleid\": [\"kA13200000006GCCAY\"], \"sfknowledgearticleid\": [\"kA13200000006GCCAY\"], \"sfownername\": [\"Karel Mpungi\"], \"kav_datacategoryselections.attribute.type\": [\"KB_Article__DataCategorySelection;KB_Article__DataCategorySelection\"], \"detectedtitle\": [\"Description\"], \"kav_createddate\": [1456772076], \"kav_build__c\": [\"All\"], \"language\": [\"English\"], \"coveo_foldingchild\": [\"e881ed886e0b3af6636505c7debef24e6e9f02235e54d631e61f5de8f02b\"], \"sfownerid\": [\"00560000002MKBSAA4\"], \"kav_createdby.coveo_record_size\": [2], \"kav_systemmodstamp\": [1515757479], \"objecttype\": [\"KB Article\"], \"connectortype\": [\"Salesforce2\"], \"kav_coveo_record_size\": [4], \"originaluri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US\"], \"sfisvisibleincsp\": [true], \"convertertype\": [\"TYPE_HTML\"], \"filetype\": [\"SalesforceItem\"], \"kav_owner.name\": [\"Karel Mpungi\"], \"sfdcexpandedarticletype\": [\"All;All|How To/Question\"], \"objecttypelabelplural\": [\"KB Articles\"], \"sfcurrencyisocode\": [\"USD\"], \"sfisdeleted\": [false], \"extractedsize\": [4230], \"size\": [7004], \"kav_publishstatus\": [\"Online\"], \"kav_connector__c\": [\"N/A\"], \"generateexcerpt\": [true], \"sfdescriptionc\": [\"This topic explain how to use the AllFieldValues JavaScript postconversion script. It will help extract and review all the available metadata in the document of a repository.\"], \"sfarticletype\": [\"KB_Article__kav\"], \"kav_lastmodifieddate\": [1488206358], \"documenttype\": [\"article\"], \"sfkbarticlekavid\": [\"ka1320000000Bc2AAE\"], \"kav_currencyisocode\": [\"USD\"], \"sfproductc\": [\"Coveo Enterprise Search\"], \"foldingparent\": [\"e881ed886e0b3af6636505c7debef24e6e9f02235e54d631e61f5de8f02b\"], \"mappingtype\": [\"KB_Article\"], \"kav_isvisibleinpkb\": [true], \"kav_sourceid\": [\"5003200000y9C80AAE\"], \"sfkbversionnumber\": [1], \"kav_isvisibleinapp\": [true], \"kav_resolution__c\": [\"The main difference between VBS and JS is the following:\\n<p>Once at step\\u00a03 of the\\u00a0<span style=\\\"font-size: 12px;\\\"><span style=\\\"font-weight: bold;\\\"><a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/finding_available_metadata.htm\\\" target=\\\"_blank\\\">Finding Available Metadata</a>\\u00a0</span></span>online help article, instead of naming the custom field &quot;AllFieldValues&quot;, it will have to be named &quot;everything&quot;</p>\\nHere is an example of the JS script:\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nvar everything = &quot;&quot;;\\n\\n// fields\\nvar DOUBLE_QUOTE = &#39;&quot;&#39;;\\nvar NEW_LINE     = &quot;\\\\r\\\\n&quot;;\\n// This buffer variable holds all metadata names and values.\\nvar allValues = &quot;&lt;AllFieldValues&gt;&quot; + NEW_LINE;\\n// A collection of all field names.\\nvar fieldNames = new VBArray(DocumentInfo.Fields());\\n// For each document field name.\\nfor (var i = fieldNames.lbound(); i &lt;= fieldNames.ubound(); ++i) {\\n  // Get the field value.\\n  var fieldName  = fieldNames.getItem(i);\\n  var fieldValue = DocumentInfo.GetFieldValue(fieldName);\\n  // Add the metadata name and its value to the buffer variable.\\n  allValues += &quot;&lt;Field&quot;;\\n  allValues += &quot; name=&quot;  + DOUBLE_QUOTE + XmlEncode(fieldName)  + DOUBLE_QUOTE;\\n  allValues += &quot; value=&quot; + DOUBLE_QUOTE + XmlEncode(fieldValue) + DOUBLE_QUOTE;\\n  allValues += &quot; type=&quot;  + DOUBLE_QUOTE + typeof(fieldValue)    + DOUBLE_QUOTE;\\n  allValues += &quot; /&gt;&quot; + NEW_LINE;\\n}\\n\\neverything += allValues;\\n\\n// bodytext\\nPostConversion.Text.SeekReadPointerInChars(0);\\nvar documentContent = PostConversion.Text.ReadString(PostConversion.Text.CharsCount);\\neverything += documentContent;\\n\\nDocumentInfo.SetFieldValue(&quot;everything&quot;, everything);\\n\\n\\n// function\\nfunction XmlEncode(value)\\n{\\n  var ret = &quot;&quot;;\\n  if (value != null) {\\n    var val = value + &quot;&quot;;\\n    for (var i = 0; i &lt; val.length; ++i) {\\n      var ch = val.charAt(i);\\n      if (ch != &#39; &#39; &amp;&amp; !(ch &gt;= &#39;a&#39; &amp;&amp; ch &lt;= &#39;z&#39;) &amp;&amp; !(ch &gt;= &#39;A&#39; &amp;&amp; ch &lt;= &#39;Z&#39;) &amp;&amp; !(ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;)) {\\n        ch = &quot;&amp;#&quot; + ch.charCodeAt(0) + &quot;;&quot;;\\n      }\\n      ret += ch;\\n    }\\n  }\\n  return ret;\\n}</pre>\\n<br><br>\\u00a0\"], \"coveo_objecttype\": [\"KB_Article\"], \"printableuri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US\"], \"kav_datacategoryselections.attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o320000003l9nAAA;/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o32000000q2cRAAQ\"], \"kav_id\": [\"ka1320000000Bc2AAE\"], \"sfresolutionc\": [\"The main difference between VBS and JS is the following:\\n<p>Once at step\\u00a03 of the\\u00a0<span style=\\\"font-size: 12px;\\\"><span style=\\\"font-weight: bold;\\\"><a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/finding_available_metadata.htm\\\" target=\\\"_blank\\\">Finding Available Metadata</a>\\u00a0</span></span>online help article, instead of naming the custom field &quot;AllFieldValues&quot;, it will have to be named &quot;everything&quot;</p>\\nHere is an example of the JS script:\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nvar everything = &quot;&quot;;\\n\\n// fields\\nvar DOUBLE_QUOTE = &#39;&quot;&#39;;\\nvar NEW_LINE     = &quot;\\\\r\\\\n&quot;;\\n// This buffer variable holds all metadata names and values.\\nvar allValues = &quot;&lt;AllFieldValues&gt;&quot; + NEW_LINE;\\n// A collection of all field names.\\nvar fieldNames = new VBArray(DocumentInfo.Fields());\\n// For each document field name.\\nfor (var i = fieldNames.lbound(); i &lt;= fieldNames.ubound(); ++i) {\\n  // Get the field value.\\n  var fieldName  = fieldNames.getItem(i);\\n  var fieldValue = DocumentInfo.GetFieldValue(fieldName);\\n  // Add the metadata name and its value to the buffer variable.\\n  allValues += &quot;&lt;Field&quot;;\\n  allValues += &quot; name=&quot;  + DOUBLE_QUOTE + XmlEncode(fieldName)  + DOUBLE_QUOTE;\\n  allValues += &quot; value=&quot; + DOUBLE_QUOTE + XmlEncode(fieldValue) + DOUBLE_QUOTE;\\n  allValues += &quot; type=&quot;  + DOUBLE_QUOTE + typeof(fieldValue)    + DOUBLE_QUOTE;\\n  allValues += &quot; /&gt;&quot; + NEW_LINE;\\n}\\n\\neverything += allValues;\\n\\n// bodytext\\nPostConversion.Text.SeekReadPointerInChars(0);\\nvar documentContent = PostConversion.Text.ReadString(PostConversion.Text.CharsCount);\\neverything += documentContent;\\n\\nDocumentInfo.SetFieldValue(&quot;everything&quot;, everything);\\n\\n\\n// function\\nfunction XmlEncode(value)\\n{\\n  var ret = &quot;&quot;;\\n  if (value != null) {\\n    var val = value + &quot;&quot;;\\n    for (var i = 0; i &lt; val.length; ++i) {\\n      var ch = val.charAt(i);\\n      if (ch != &#39; &#39; &amp;&amp; !(ch &gt;= &#39;a&#39; &amp;&amp; ch &lt;= &#39;z&#39;) &amp;&amp; !(ch &gt;= &#39;A&#39; &amp;&amp; ch &lt;= &#39;Z&#39;) &amp;&amp; !(ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;)) {\\n        ch = &quot;&amp;#&quot; + ch.charCodeAt(0) + &quot;;&quot;;\\n      }\\n      ret += ch;\\n    }\\n  }\\n  return ret;\\n}</pre>\\n<br><br>\\u00a0\"], \"foldingchild\": [\"e881ed886e0b3af6636505c7debef24e6e9f02235e54d631e61f5de8f02b\"], \"sfcreateddate\": [1456772076], \"kav_sitecore_version__c\": [\"N/A\"], \"kav_owner.coveo_record_size\": [2], \"kav_coveo_effective_modstamp\": [1515757479], \"kav_summary__html_stripped\": [\"\"], \"kav_dc_article_type\": [\"How To/Question\"], \"sfconnectorc\": [\"N/A\"], \"kav_dc_product\": [\"Coveo Enterprise Search\"], \"ka_coveo_record_size\": [2], \"kav_dc_expanded_article_type\": [\"All;All|How To/Question\"], \"kav_datacategoryselections.coveo_record_size\": [\"2;2\"], \"concepts\": [\"metadata ; script ; AllFieldValues ; online help ; var ; repository ; extract ; Resolution ; Environment\"], \"sfkbid\": [\"kA13200000006GCCAY\"], \"kav_firstpublisheddate\": [1488206358], \"coveo_organization_id\": [\"00D3000000007r2\"], \"coveo_foldingcollection\": [\"c1b41ca52388531717ed7cf651837aab2154fd602928ec8ecfb3d99c46a6\"], \"sffirstpublisheddate\": [1488206358], \"sflastmodifieddate\": [1488206358], \"kav_resolution__c__html_stripped\": [\"The main difference between VBS and JS is the following:\\n Once at step\\u00a03 of the\\u00a0 Finding Available Metadata \\u00a0 online help article, instead of naming the custom field \\\"AllFieldValues\\\", it will have to be named \\\"everything\\\"\\n \\nHere is an example of the JS script:\\n\\n \\nvar everything = \\\"\\\";\\n\\n// fields\\nvar DOUBLE_QUOTE = '\\\"';\\nvar NEW_LINE     = \\\"\\\\r\\\\n\\\";\\n// This buffer variable holds all metadata names and values.\\nvar allValues = \\\"<AllFieldValues>\\\" + NEW_LINE;\\n// A collection of all field names.\\nvar fieldNames = new VBArray(DocumentInfo.Fields());\\n// For each document field name.\\nfor (var i = fieldNames.lbound(); i <= fieldNames.ubound(); ++i) {\\n  // Get the field value.\\n  var fieldName  = fieldNames.getItem(i);\\n  var fieldValue = DocumentInfo.GetFieldValue(fieldName);\\n  // Add the metadata name and its value to the buffer variable.\\n  allValues += \\\"<Field\\\";\\n  allValues += \\\" name=\\\"  + DOUBLE_QUOTE + XmlEncode(fieldName)  + DOUBLE_QUOTE;\\n  allValues += \\\" value=\\\" + DOUBLE_QUOTE + XmlEncode(fieldValue) + DOUBLE_QUOTE;\\n  allValues += \\\" type=\\\"  + DOUBLE_QUOTE + typeof(fieldValue)    + DOUBLE_QUOTE;\\n  allValues += \\\" />\\\" + NEW_LINE;\\n}\\n\\neverything += allValues;\\n\\n// bodytext\\nPostConversion.Text.SeekReadPointerInChars(0);\\nvar documentContent = PostConversion.Text.ReadString(PostConversion.Text.CharsCount);\\neverything += documentContent;\\n\\nDocumentInfo.SetFieldValue(\\\"everything\\\", everything);\\n\\n\\n// function\\nfunction XmlEncode(value)\\n{\\n  var ret = \\\"\\\";\\n  if (value != null) {\\n    var val = value + \\\"\\\";\\n    for (var i = 0; i < val.length; ++i) {\\n      var ch = val.charAt(i);\\n      if (ch != ' ' && !(ch >= 'a' && ch <= 'z') && !(ch >= 'A' && ch <= 'Z') && !(ch >= '0' && ch <= '9')) {\\n        ch = \\\"&#\\\" + ch.charCodeAt(0) + \\\";\\\";\\n      }\\n      ret += ch;\\n    }\\n  }\\n  return ret;\\n} \\n \\n \\n \\u00a0\"], \"kav_vendor_version__c__html_stripped\": [\"\"], \"detectedlanguage\": [1], \"kav_isvisibleinprm\": [true], \"kav_owner.attribute.type\": [\"Name\"], \"kav_lastmodifiedby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000004Y4fRAAS\"], \"sfversionc\": [\"CES7\"], \"sitename\": [\"Community\"], \"kav_createdby.name\": [\"Karel Mpungi\"], \"sfarticlenumber\": [\"000001205\"], \"kav_lastmodifiedby.coveo_record_size\": [2], \"sfisvisibleinpkb\": [true], \"kav_datacategoryselections.id\": [\"02o320000003l9nAAA;02o32000000q2cRAAQ\"], \"kav_description__c\": [\"This topic explain how to use the AllFieldValues JavaScript postconversion script. It will help extract and review all the available metadata in the document of a repository.\"], \"kav_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__kav/ka1320000000Bc2AAE\"], \"kav_articlenumber__stripped\": [\"1205\"], \"sfversionnumber\": [1], \"kav_attribute.type\": [\"KB_Article__kav\"], \"kav_validationstatus\": [\"Approved\"], \"coveo_foldingparent\": [\"e881ed886e0b3af6636505c7debef24e6e9f02235e54d631e61f5de8f02b\"], \"collection\": [\"default\"], \"sfsourceid\": [\"5003200000y9C80AAE\"], \"date\": [1515757479], \"kav_lastmodifiedby.id\": [\"00560000004Y4fRAAS\"], \"kav_datacategoryselections.datacategorygroupname\": [\"Product;Article_Type\"], \"conversionstate\": [0], \"sfvalidationstatus\": [\"Approved\"], \"kav_isdeleted\": [false], \"sflastmodifiedbyid\": [\"00560000004Y4fRAAS\"], \"kav_lastmodifiedby.name\": [\"Christian Bilodeau\"], \"kav_articlenumber\": [\"000001205\"], \"permanentid\": [\"4779b9f65dd33ccaf146c6c36d3103fd34efb2b5e9f00a9d9c5fb85b9ce3\"]}",
      "sfbuildc" : "All",
      "sflastmodifiedbyid" : "00560000004Y4fRAAS",
      "sfproductc" : "Coveo Enterprise Search",
      "syssfownerid" : "00560000002MKBSAA4",
      "sfsitecoreversionc" : "N/A",
      "sourcetype" : "Salesforce",
      "sysconnectortype" : "Salesforce2",
      "sftitle" : "Javascript version of Finding Available Metadata VBScript",
      "rowid" : 5492846,
      "syssfcreatedbyid" : "00560000002MKBSAA4",
      "sfdescriptionc" : "This topic explain how to use the AllFieldValues JavaScript postconversion script. It will help extract and review all the available metadata in the document of a repository.",
      "size" : 7004,
      "sfislatestversion" : "true",
      "sysdocumenttype" : "article",
      "sfcreateddate" : 1456772076000,
      "sfsourceid" : "5003200000y9C80AAE",
      "clickableuri" : "https://na61.salesforce.com/kA13200000006GC",
      "syssource" : "Salesforce Public Items",
      "sfownerid" : "00560000002MKBSAA4",
      "orderingid" : 212384990660371654,
      "sfpublishstatus" : "Online",
      "syssize" : 7004,
      "sysdate" : 1515757479000,
      "sflanguage" : "en_US",
      "sysparents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Javascript version of Finding Available Metadata VBScript\" uri=\"https://na61.salesforce.com/kA13200000006GC\" /></parents>",
      "sfdcexpandedarticletype" : "All;All|How To/Question",
      "sfcurrencyisocode" : "USD",
      "sfkbid" : "kA13200000006GCCAY",
      "sfcausec" : "This is similar to this <a href=\"http://https://onlinehelp.coveo.com/en/ces/7.0/administrator/finding_available_metadata.htm\" target=\"_blank\">article</a>. But instead of using VBS, we will use JS.<br> ",
      "sfdcexpandedproduct" : "All;All|Coveo Enterprise Search",
      "syssfcreateddate" : 1456772076000,
      "sflastmodifieddate" : 1488206358000,
      "sfisvisibleinpkb" : "true",
      "source" : "Salesforce Public Items",
      "sfisdeleted" : "false",
      "sfisvisibleincsp" : "true",
      "sfvalidationstatus" : "Approved",
      "sflastmodifiedbyname" : "Christian Bilodeau",
      "collection" : "default",
      "sfdcproduct" : [ "Coveo Enterprise Search" ],
      "syssourcetype" : "Salesforce",
      "sfarticletype" : "KB_Article__kav",
      "indexeddate" : 1518187569000,
      "connectortype" : "Salesforce2",
      "filetype" : "SalesforceItem",
      "sfcreatedbyname" : "Karel Mpungi",
      "sysclickableuri" : "https://na61.salesforce.com/kA13200000006GC",
      "sysfiletype" : "SalesforceItem",
      "language" : [ "English" ],
      "sffirstpublisheddate" : 1488206358000,
      "sfownername" : "Karel Mpungi",
      "sitename" : "Community",
      "sysrowid" : 5492846,
      "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
      "syscollection" : "default"
    },
    "Title" : "Javascript version of Finding Available Metadata VBScript",
    "Uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
    "PrintableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
    "ClickUri" : "https://na61.salesforce.com/kA13200000006GC",
    "UniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA13200000006GCCAY/language:en_US",
    "Excerpt" : "This topic explain how to use the AllFieldValues JavaScript postconversion script. ... It will help extract and review all the available metadata in the document of a repository. ... Environment .....",
    "FirstSentences" : null
  }