{
    "title" : "Command line utility for Setting Read only and read-write mode",
    "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
    "printableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
    "clickUri" : "https://na61.salesforce.com/kA1320000004Ks6",
    "uniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
    "excerpt" : "This article explains how to toggle the Index from Read-Write monde to Read-Only mode and vice versa via command line ... Resolution ... In order to automate reactive measures for storage timeouts ...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1251,
    "percentScore" : 79.58755,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "Command line utility for Setting Read only and read-write mode",
      "sysurihash" : "2PeððL9jRpTItZau",
      "urihash" : "2PeððL9jRpTItZau",
      "parents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Command line utility for Setting Read only and read-write mode\" uri=\"https://na61.salesforce.com/kA1320000004Ks6\" /></parents>",
      "sfdcarticletype" : "How To/Question",
      "sfresolutionc" : "In order to automate reactive measures for storage timeouts you mi need commad line or API calls for setting CES7 to read only and read-write mode<br><br>You&#39;ll find the script below. It&#39;s a vbs script. So copy and paste it into a .txt file, rename the extension from .txt to .vbs<br> \n<pre class=\"ckeditor_codeblock\">\nOption Explicit\n\nConst StateTypeCheckingIntegrity = 3\nConst StateTypeFirstTimeSetup = 0\nConst StateTypeNeedIndexRevise = 7\nConst StateTypeOutOfSync = 6\nConst StateTypeRunning = 1\nConst StateTypeRunningReadOnly = 2\nConst StateTypeSwitchingToRunning = 8\nConst StateTypeSwitchingToRunningReadOnly = 9\nConst StateTypeSynchronizing = 5\nConst StateTypeTooManyDocuments = 4\n\nDim Admin: Set Admin = GetAdmin()\n\nDim value: value = WScript.Arguments.Named(&quot;enablereadonly&quot;)\nDim bValue: bValue = CBool(value)\nDim expectedFinalState\nif bValue then\n\tWScript.Echo &quot;enabling read-only&quot;\n\texpectedFinalState = StateTypeRunningReadOnly \nelse\n\tWScript.Echo &quot;disabling read-only&quot;\n\texpectedFinalState = StateTypeRunning\nend if\n\n\nif Admin.State = expectedFinalState Then\n\tWScript.Echo &quot;Already in requested state. End script&quot;\n\tWScript.Quit\nEnd If\n\nCall Admin.EnableREadOnly(bValue)\n\nWhile Admin.State &lt;&gt; expectedFinalState\n\tWScript.Echo &quot;waiting...&quot; &amp; &quot;current state=&quot; &amp; CStr(Admin.State)\n\tWScript.Sleep(1000)\nWend\n\nWScript.Echo &quot;done.&quot;\n\n\n&#39;------------------------------------------------------------------------------\nFunction GetAdmin()\n  Set GetAdmin = CreateObject(&quot;CESAdmin.Admin.7.0&quot;)\n  Call GetAdmin.Connect(&quot;localhost&quot;, &quot;default&quot;)\n  Call GetAdmin.Refresh()\nEnd Function</pre>\n<br>This is how it works: <br><br>Let&#39;s say that you put the &quot;CES7Admin-EnableReadOnly.vbs&quot; file into the &quot;C:\\CES7\\Script&quot; folder. <br><br>- When the index is in RO mode, run the script as follow: <br><br>C:\\CES7\\Script&gt;CES7Admin-EnableReadOnly.vbs /enablereadonly:false <br><br>It&#39;ll put the index in Read Only mode. <br><br>- When the index is in Read Write mode, running the script as follow: <br><br>C:\\CES7\\Script&gt;CES7Admin-EnableReadOnly.vbs /enablereadonly:true <br><br>It&#39;ll put the index in Read Write mode. <br><br><br> ",
      "sysuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
      "sysprintableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
      "sflastpublisheddate" : 1481922556000,
      "systransactionid" : 161138,
      "sfversionc" : "CES7",
      "sfurlname" : "1378",
      "sfsystemmodstamp" : 1509619413000,
      "sfisvisibleinapp" : "true",
      "sfcoveoversionc" : "Coveo Enterprise 7.0",
      "sysconcepts" : "script ; read-write ; Option Explicit ; setting CES7 ; need commad ; storage timeouts ; vice versa ; extension ; Resolution",
      "sfkbversionnumber" : "2",
      "concepts" : "script ; read-write ; Option Explicit ; setting CES7 ; need commad ; storage timeouts ; vice versa ; extension ; Resolution",
      "printableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
      "documenttype" : "article",
      "sfkbarticlekavid" : "ka132000000LK1lAAG",
      "sysindexeddate" : 1518187522000,
      "sfknowledgearticleid" : "kA1320000004Ks6CAE",
      "sfcreatedbyid" : "00560000002MKBSAA4",
      "sfconnectorc" : "N/A",
      "permanentid" : "75282c4ef0c91442f9e55d9bbd8dcb8ab8ff8dd4cf524e197eed88d2d63d",
      "syslanguage" : [ "English" ],
      "transactionid" : 161138,
      "sfisvisibleinprm" : "true",
      "title" : "Command line utility for Setting Read only and read-write mode",
      "sfversionnumber" : 2,
      "sfarticlenumber" : "000001378",
      "date" : 1509619413000,
      "objecttype" : "KB Article",
      "allmetadatavalues" : "{\"kav_lastmodifiedby.attribute.type\": [\"User\"], \"coveo_short_id\": [\"kA1320000004Ks6\"], \"sflastmodifiedbyname\": [\"Frederic Cote\"], \"kav_coveo_version__c__html_stripped\": [\"Coveo Enterprise 7.0\"], \"fileextension\": [\"\"], \"sfdcexpandedproduct\": [\"All;All|Coveo Enterprise Search\"], \"kav_createdby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"sflanguage\": [\"en_US\"], \"kav_createdby.attribute.type\": [\"User\"], \"kav_createdby.id\": [\"00560000002MKBSAA4\"], \"kav_language\": [\"en_US\"], \"sfsitecoreversionc\": [\"N/A\"], \"sourcetype\": [\"Salesforce\"], \"title\": [\"Command line utility for Setting Read only and read-write mode\"], \"source\": [\"Salesforce Public Items\"], \"kav_owner.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"parents\": [\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?><parents><parent name=\\\"Organization\\\" uri=\\\"https://na61.salesforce.com/home/home.jsp\\\" /><parent name=\\\"KB_Article__ka\\\" uri=\\\"http://www.salesforce.com/org:organization/articletype:KB_Article\\\" /><parent name=\\\"Command line utility for Setting Read only and read-write mode\\\" uri=\\\"https://na61.salesforce.com/kA1320000004Ks6\\\" /></parents>\"], \"sfisvisibleinprm\": [true], \"kav_title\": [\"Command line utility for Setting Read only and read-write mode\"], \"kav_isvisibleincsp\": [true], \"hashtmlversion\": [true], \"sfarticletypec\": [\"How To\"], \"kav_version__c\": [\"CES7\"], \"kav_versionnumber\": [2], \"sfcreatedbyname\": [\"Karel Mpungi\"], \"sflastpublisheddate\": [1481922556], \"objecttypelabel\": [\"KB Article\"], \"kav_cause__c__html_stripped\": [\"\"], \"originalhtmlcharset\": [1200], \"coveo_connector_hasbinarydata\": [false], \"kav_lastpublisheddate\": [1481922556], \"sfsystemmodstamp\": [1509619413], \"ka_attribute.type\": [\"KB_Article__ka\"], \"sfdcproduct\": [\"Coveo Enterprise Search\"], \"kav_resolution__c__html_stripped\": [\"In order to automate reactive measures for storage timeouts you mi\\u00a0need commad line or API calls for setting CES7 to read only and read-write mode \\n \\n You'll find the script below. It's a vbs script. So copy and paste it into a .txt file, rename the extension from .txt to .vbs \\n \\u00a0\\n \\nOption Explicit\\n\\nConst StateTypeCheckingIntegrity = 3\\nConst StateTypeFirstTimeSetup = 0\\nConst StateTypeNeedIndexRevise = 7\\nConst StateTypeOutOfSync = 6\\nConst StateTypeRunning = 1\\nConst StateTypeRunningReadOnly = 2\\nConst StateTypeSwitchingToRunning = 8\\nConst StateTypeSwitchingToRunningReadOnly = 9\\nConst StateTypeSynchronizing = 5\\nConst StateTypeTooManyDocuments = 4\\n\\nDim Admin: Set Admin = GetAdmin()\\n\\nDim value: value = WScript.Arguments.Named(\\\"enablereadonly\\\")\\nDim bValue: bValue = CBool(value)\\nDim expectedFinalState\\nif bValue then\\n\\tWScript.Echo \\\"enabling read-only\\\"\\n\\texpectedFinalState = StateTypeRunningReadOnly \\nelse\\n\\tWScript.Echo \\\"disabling read-only\\\"\\n\\texpectedFinalState = StateTypeRunning\\nend if\\n\\n\\nif Admin.State = expectedFinalState Then\\n\\tWScript.Echo \\\"Already in requested state. End script\\\"\\n\\tWScript.Quit\\nEnd If\\n\\nCall Admin.EnableREadOnly(bValue)\\n\\nWhile Admin.State <> expectedFinalState\\n\\tWScript.Echo \\\"waiting...\\\" & \\\"current state=\\\" & CStr(Admin.State)\\n\\tWScript.Sleep(1000)\\nWend\\n\\nWScript.Echo \\\"done.\\\"\\n\\n\\n'------------------------------------------------------------------------------\\nFunction GetAdmin()\\n  Set GetAdmin = CreateObject(\\\"CESAdmin.Admin.7.0\\\")\\n  Call GetAdmin.Connect(\\\"localhost\\\", \\\"default\\\")\\n  Call GetAdmin.Refresh()\\nEnd Function \\n \\n This is how it works:\\u00a0 \\n \\n Let's say that you put the \\\"CES7Admin-EnableReadOnly.vbs\\\" file into the \\\"C:\\\\CES7\\\\Script\\\" folder.\\u00a0 \\n \\n - When the index is in RO mode, run the script as follow:\\u00a0 \\n \\n C:\\\\CES7\\\\Script>CES7Admin-EnableReadOnly.vbs /enablereadonly:false\\u00a0 \\n \\n It'll put the index in Read Only mode.\\u00a0 \\n \\n - When the index is in Read Write mode, running the script as follow:\\u00a0 \\n \\n C:\\\\CES7\\\\Script>CES7Admin-EnableReadOnly.vbs /enablereadonly:true\\u00a0 \\n \\n It'll put the index in Read Write mode.\\u00a0 \\n \\n \\n \\u00a0\"], \"clickableuri\": [\"https://na61.salesforce.com/kA1320000004Ks6\"], \"kav_dc_expanded_product\": [\"All;All|Coveo Enterprise Search\"], \"sftitle\": [\"Command line utility for Setting Read only and read-write mode\"], \"kav_owner.id\": [\"00560000002MKBSAA4\"], \"sfbuildc\": [\"All\"], \"sfisvisibleinapp\": [true], \"ka_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__ka/kA1320000004Ks6CAE\"], \"sfdcarticletype\": [\"How To/Question\"], \"sfislatestversion\": [true], \"sfarticlenumber\": [\"000001378\"], \"contenttype\": [\"binarydata\"], \"sfurlname\": [\"1378\"], \"ka_id\": [\"kA1320000004Ks6CAE\"], \"kav_datacategoryselections.datacategoryname\": [\"Coveo_Enterprise_Search;How_To\"], \"coveo_url\": [\"https://na61.salesforce.com/kA1320000004Ks6\"], \"kav_urlname\": [\"1378\"], \"kav_articletype\": [\"KB_Article__kav\"], \"foldingcollection\": [\"cfc204617174f76030ebf8c3ea4e7a21258932e34a75426426dd89d5e1ec\"], \"body\": [\"<html>   <body>     <div style=\\\"background-color: #fff;border: 2px solid #BBC5CC;border-radius: 4px;float: left;font-family: lato;margin-left: 15px;margin-right: 15px;margin-bottom: 4%;padding: 10px;width: 60%;\\\">       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Description         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> This article explains how to toggle the Index from Read-Write monde to Read-Only mode and vice versa via command line</div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Environment         </div>       </div>       <br/>       <table>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Product</td>           <td>Coveo Enterprise Search</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Sitecore Version</td>           <td>N/A</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Connector</td>           <td>N/A</td>         </tr>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Published</td>           <td>1481922556</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Version</td>           <td>CES7</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Build</td>           <td>All</td>         </tr>       </table>       <br/>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Cause         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> </div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Resolution         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> In order to automate reactive measures for storage timeouts you mi\\u00a0need commad line or API calls for setting CES7 to read only and read-write mode<br><br>You&#39;ll find the script below. It&#39;s a vbs script. So copy and paste it into a .txt file, rename the extension from .txt to .vbs<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nOption Explicit\\n\\nConst StateTypeCheckingIntegrity = 3\\nConst StateTypeFirstTimeSetup = 0\\nConst StateTypeNeedIndexRevise = 7\\nConst StateTypeOutOfSync = 6\\nConst StateTypeRunning = 1\\nConst StateTypeRunningReadOnly = 2\\nConst StateTypeSwitchingToRunning = 8\\nConst StateTypeSwitchingToRunningReadOnly = 9\\nConst StateTypeSynchronizing = 5\\nConst StateTypeTooManyDocuments = 4\\n\\nDim Admin: Set Admin = GetAdmin()\\n\\nDim value: value = WScript.Arguments.Named(&quot;enablereadonly&quot;)\\nDim bValue: bValue = CBool(value)\\nDim expectedFinalState\\nif bValue then\\n\\tWScript.Echo &quot;enabling read-only&quot;\\n\\texpectedFinalState = StateTypeRunningReadOnly \\nelse\\n\\tWScript.Echo &quot;disabling read-only&quot;\\n\\texpectedFinalState = StateTypeRunning\\nend if\\n\\n\\nif Admin.State = expectedFinalState Then\\n\\tWScript.Echo &quot;Already in requested state. End script&quot;\\n\\tWScript.Quit\\nEnd If\\n\\nCall Admin.EnableREadOnly(bValue)\\n\\nWhile Admin.State &lt;&gt; expectedFinalState\\n\\tWScript.Echo &quot;waiting...&quot; &amp; &quot;current state=&quot; &amp; CStr(Admin.State)\\n\\tWScript.Sleep(1000)\\nWend\\n\\nWScript.Echo &quot;done.&quot;\\n\\n\\n&#39;------------------------------------------------------------------------------\\nFunction GetAdmin()\\n  Set GetAdmin = CreateObject(&quot;CESAdmin.Admin.7.0&quot;)\\n  Call GetAdmin.Connect(&quot;localhost&quot;, &quot;default&quot;)\\n  Call GetAdmin.Refresh()\\nEnd Function</pre>\\n<br>This is how it works:\\u00a0<br><br>Let&#39;s say that you put the &quot;CES7Admin-EnableReadOnly.vbs&quot; file into the &quot;C:\\\\CES7\\\\Script&quot; folder.\\u00a0<br><br>- When the index is in RO mode, run the script as follow:\\u00a0<br><br>C:\\\\CES7\\\\Script&gt;CES7Admin-EnableReadOnly.vbs /enablereadonly:false\\u00a0<br><br>It&#39;ll put the index in Read Only mode.\\u00a0<br><br>- When the index is in Read Write mode, running the script as follow:\\u00a0<br><br>C:\\\\CES7\\\\Script&gt;CES7Admin-EnableReadOnly.vbs /enablereadonly:true\\u00a0<br><br>It&#39;ll put the index in Read Write mode.\\u00a0<br><br><br>\\u00a0</div>     </div>   </body> </html>\"], \"kav_product__c\": [\"Coveo Enterprise Search\"], \"kav_article_type__c\": [\"How To\"], \"sfpublishstatus\": [\"Online\"], \"sfcreatedbyid\": [\"00560000002MKBSAA4\"], \"kav_description__c__html_stripped\": [\"This article explains how to toggle the Index from Read-Write monde to Read-Only mode and vice versa via command line\"], \"kav_islatestversion\": [true], \"kav_knowledgearticleid\": [\"kA1320000004Ks6CAE\"], \"sfknowledgearticleid\": [\"kA1320000004Ks6CAE\"], \"sfownername\": [\"Karel Mpungi\"], \"kav_datacategoryselections.attribute.type\": [\"KB_Article__DataCategorySelection;KB_Article__DataCategorySelection\"], \"detectedtitle\": [\"Description\"], \"kav_createddate\": [1481922513], \"kav_build__c\": [\"All\"], \"language\": [\"English\"], \"coveo_foldingchild\": [\"2fb7b312b6b52c35248d7f8acbc7eb7bd3c6e487e616f1ab5a325c45c512\"], \"sfownerid\": [\"00560000002MKBSAA4\"], \"kav_createdby.coveo_record_size\": [2], \"kav_systemmodstamp\": [1509619413], \"objecttype\": [\"KB Article\"], \"connectortype\": [\"Salesforce2\"], \"kav_coveo_record_size\": [4], \"originaluri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US\"], \"sfisvisibleincsp\": [true], \"convertertype\": [\"TYPE_HTML\"], \"filetype\": [\"SalesforceItem\"], \"kav_owner.name\": [\"Karel Mpungi\"], \"sfcoveoversionc\": [\"Coveo Enterprise 7.0\"], \"sfdcexpandedarticletype\": [\"All;All|How To/Question\"], \"objecttypelabelplural\": [\"KB Articles\"], \"sfcurrencyisocode\": [\"USD\"], \"sfisdeleted\": [false], \"extractedsize\": [4542], \"size\": [6874], \"kav_publishstatus\": [\"Online\"], \"kav_connector__c\": [\"N/A\"], \"generateexcerpt\": [true], \"sfdescriptionc\": [\"This article explains how to toggle the Index from Read-Write monde to Read-Only mode and vice versa via command line\"], \"sfarticletype\": [\"KB_Article__kav\"], \"kav_lastmodifieddate\": [1481922556], \"documenttype\": [\"article\"], \"sfkbarticlekavid\": [\"ka132000000LK1lAAG\"], \"kav_currencyisocode\": [\"USD\"], \"sfproductc\": [\"Coveo Enterprise Search\"], \"foldingparent\": [\"2fb7b312b6b52c35248d7f8acbc7eb7bd3c6e487e616f1ab5a325c45c512\"], \"mappingtype\": [\"KB_Article\"], \"kav_isvisibleinpkb\": [true], \"kav_sourceid\": [\"50032000010cA4pAAE\"], \"sfkbversionnumber\": [2], \"kav_isvisibleinapp\": [true], \"kav_resolution__c\": [\"In order to automate reactive measures for storage timeouts you mi\\u00a0need commad line or API calls for setting CES7 to read only and read-write mode<br><br>You&#39;ll find the script below. It&#39;s a vbs script. So copy and paste it into a .txt file, rename the extension from .txt to .vbs<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nOption Explicit\\n\\nConst StateTypeCheckingIntegrity = 3\\nConst StateTypeFirstTimeSetup = 0\\nConst StateTypeNeedIndexRevise = 7\\nConst StateTypeOutOfSync = 6\\nConst StateTypeRunning = 1\\nConst StateTypeRunningReadOnly = 2\\nConst StateTypeSwitchingToRunning = 8\\nConst StateTypeSwitchingToRunningReadOnly = 9\\nConst StateTypeSynchronizing = 5\\nConst StateTypeTooManyDocuments = 4\\n\\nDim Admin: Set Admin = GetAdmin()\\n\\nDim value: value = WScript.Arguments.Named(&quot;enablereadonly&quot;)\\nDim bValue: bValue = CBool(value)\\nDim expectedFinalState\\nif bValue then\\n\\tWScript.Echo &quot;enabling read-only&quot;\\n\\texpectedFinalState = StateTypeRunningReadOnly \\nelse\\n\\tWScript.Echo &quot;disabling read-only&quot;\\n\\texpectedFinalState = StateTypeRunning\\nend if\\n\\n\\nif Admin.State = expectedFinalState Then\\n\\tWScript.Echo &quot;Already in requested state. End script&quot;\\n\\tWScript.Quit\\nEnd If\\n\\nCall Admin.EnableREadOnly(bValue)\\n\\nWhile Admin.State &lt;&gt; expectedFinalState\\n\\tWScript.Echo &quot;waiting...&quot; &amp; &quot;current state=&quot; &amp; CStr(Admin.State)\\n\\tWScript.Sleep(1000)\\nWend\\n\\nWScript.Echo &quot;done.&quot;\\n\\n\\n&#39;------------------------------------------------------------------------------\\nFunction GetAdmin()\\n  Set GetAdmin = CreateObject(&quot;CESAdmin.Admin.7.0&quot;)\\n  Call GetAdmin.Connect(&quot;localhost&quot;, &quot;default&quot;)\\n  Call GetAdmin.Refresh()\\nEnd Function</pre>\\n<br>This is how it works:\\u00a0<br><br>Let&#39;s say that you put the &quot;CES7Admin-EnableReadOnly.vbs&quot; file into the &quot;C:\\\\CES7\\\\Script&quot; folder.\\u00a0<br><br>- When the index is in RO mode, run the script as follow:\\u00a0<br><br>C:\\\\CES7\\\\Script&gt;CES7Admin-EnableReadOnly.vbs /enablereadonly:false\\u00a0<br><br>It&#39;ll put the index in Read Only mode.\\u00a0<br><br>- When the index is in Read Write mode, running the script as follow:\\u00a0<br><br>C:\\\\CES7\\\\Script&gt;CES7Admin-EnableReadOnly.vbs /enablereadonly:true\\u00a0<br><br>It&#39;ll put the index in Read Write mode.\\u00a0<br><br><br>\\u00a0\"], \"coveo_objecttype\": [\"KB_Article\"], \"printableuri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US\"], \"kav_datacategoryselections.attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o32000000pupXAAQ;/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o32000000pupWAAQ\"], \"kav_id\": [\"ka132000000LK1lAAG\"], \"sfresolutionc\": [\"In order to automate reactive measures for storage timeouts you mi\\u00a0need commad line or API calls for setting CES7 to read only and read-write mode<br><br>You&#39;ll find the script below. It&#39;s a vbs script. So copy and paste it into a .txt file, rename the extension from .txt to .vbs<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nOption Explicit\\n\\nConst StateTypeCheckingIntegrity = 3\\nConst StateTypeFirstTimeSetup = 0\\nConst StateTypeNeedIndexRevise = 7\\nConst StateTypeOutOfSync = 6\\nConst StateTypeRunning = 1\\nConst StateTypeRunningReadOnly = 2\\nConst StateTypeSwitchingToRunning = 8\\nConst StateTypeSwitchingToRunningReadOnly = 9\\nConst StateTypeSynchronizing = 5\\nConst StateTypeTooManyDocuments = 4\\n\\nDim Admin: Set Admin = GetAdmin()\\n\\nDim value: value = WScript.Arguments.Named(&quot;enablereadonly&quot;)\\nDim bValue: bValue = CBool(value)\\nDim expectedFinalState\\nif bValue then\\n\\tWScript.Echo &quot;enabling read-only&quot;\\n\\texpectedFinalState = StateTypeRunningReadOnly \\nelse\\n\\tWScript.Echo &quot;disabling read-only&quot;\\n\\texpectedFinalState = StateTypeRunning\\nend if\\n\\n\\nif Admin.State = expectedFinalState Then\\n\\tWScript.Echo &quot;Already in requested state. End script&quot;\\n\\tWScript.Quit\\nEnd If\\n\\nCall Admin.EnableREadOnly(bValue)\\n\\nWhile Admin.State &lt;&gt; expectedFinalState\\n\\tWScript.Echo &quot;waiting...&quot; &amp; &quot;current state=&quot; &amp; CStr(Admin.State)\\n\\tWScript.Sleep(1000)\\nWend\\n\\nWScript.Echo &quot;done.&quot;\\n\\n\\n&#39;------------------------------------------------------------------------------\\nFunction GetAdmin()\\n  Set GetAdmin = CreateObject(&quot;CESAdmin.Admin.7.0&quot;)\\n  Call GetAdmin.Connect(&quot;localhost&quot;, &quot;default&quot;)\\n  Call GetAdmin.Refresh()\\nEnd Function</pre>\\n<br>This is how it works:\\u00a0<br><br>Let&#39;s say that you put the &quot;CES7Admin-EnableReadOnly.vbs&quot; file into the &quot;C:\\\\CES7\\\\Script&quot; folder.\\u00a0<br><br>- When the index is in RO mode, run the script as follow:\\u00a0<br><br>C:\\\\CES7\\\\Script&gt;CES7Admin-EnableReadOnly.vbs /enablereadonly:false\\u00a0<br><br>It&#39;ll put the index in Read Only mode.\\u00a0<br><br>- When the index is in Read Write mode, running the script as follow:\\u00a0<br><br>C:\\\\CES7\\\\Script&gt;CES7Admin-EnableReadOnly.vbs /enablereadonly:true\\u00a0<br><br>It&#39;ll put the index in Read Write mode.\\u00a0<br><br><br>\\u00a0\"], \"foldingchild\": [\"2fb7b312b6b52c35248d7f8acbc7eb7bd3c6e487e616f1ab5a325c45c512\"], \"sfcreateddate\": [1481922513], \"kav_sitecore_version__c\": [\"N/A\"], \"kav_owner.coveo_record_size\": [2], \"kav_coveo_effective_modstamp\": [1509619413], \"kav_summary__html_stripped\": [\"\"], \"kav_dc_article_type\": [\"How To/Question\"], \"sfconnectorc\": [\"N/A\"], \"kav_dc_product\": [\"Coveo Enterprise Search\"], \"ka_coveo_record_size\": [2], \"kav_dc_expanded_article_type\": [\"All;All|How To/Question\"], \"kav_datacategoryselections.coveo_record_size\": [\"2;2\"], \"concepts\": [\"script ; read-write ; Option Explicit ; setting CES7 ; need commad ; storage timeouts ; vice versa ; extension ; Resolution\"], \"sfkbid\": [\"kA1320000004Ks6CAE\"], \"kav_firstpublisheddate\": [1462975981], \"coveo_organization_id\": [\"00D3000000007r2\"], \"coveo_foldingcollection\": [\"cfc204617174f76030ebf8c3ea4e7a21258932e34a75426426dd89d5e1ec\"], \"sffirstpublisheddate\": [1462975981], \"sflastmodifieddate\": [1481922556], \"kav_coveo_version__c\": [\"Coveo Enterprise 7.0\"], \"kav_vendor_version__c__html_stripped\": [\"\"], \"detectedlanguage\": [1], \"kav_isvisibleinprm\": [true], \"kav_owner.attribute.type\": [\"Name\"], \"kav_lastmodifiedby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000003q7JgAAI\"], \"sfversionc\": [\"CES7\"], \"sitename\": [\"Community\"], \"kav_createdby.name\": [\"Karel Mpungi\"], \"kav_lastmodifiedby.coveo_record_size\": [2], \"sfisvisibleinpkb\": [true], \"kav_datacategoryselections.id\": [\"02o32000000pupXAAQ;02o32000000pupWAAQ\"], \"kav_description__c\": [\"This article explains how to toggle the Index from Read-Write monde to Read-Only mode and vice versa via command line\"], \"kav_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__kav/ka132000000LK1lAAG\"], \"kav_articlenumber__stripped\": [\"1378\"], \"sfversionnumber\": [2], \"kav_attribute.type\": [\"KB_Article__kav\"], \"kav_validationstatus\": [\"Reviewed\"], \"coveo_foldingparent\": [\"2fb7b312b6b52c35248d7f8acbc7eb7bd3c6e487e616f1ab5a325c45c512\"], \"collection\": [\"default\"], \"sfsourceid\": [\"50032000010cA4pAAE\"], \"date\": [1509619413], \"kav_lastmodifiedby.id\": [\"00560000003q7JgAAI\"], \"kav_datacategoryselections.datacategorygroupname\": [\"Product;Article_Type\"], \"conversionstate\": [0], \"sfvalidationstatus\": [\"Reviewed\"], \"kav_isdeleted\": [false], \"sflastmodifiedbyid\": [\"00560000003q7JgAAI\"], \"kav_lastmodifiedby.name\": [\"Frederic Cote\"], \"kav_articlenumber\": [\"000001378\"], \"permanentid\": [\"75282c4ef0c91442f9e55d9bbd8dcb8ab8ff8dd4cf524e197eed88d2d63d\"]}",
      "sfbuildc" : "All",
      "sflastmodifiedbyid" : "00560000003q7JgAAI",
      "sfproductc" : "Coveo Enterprise Search",
      "syssfownerid" : "00560000002MKBSAA4",
      "sfsitecoreversionc" : "N/A",
      "sourcetype" : "Salesforce",
      "sysconnectortype" : "Salesforce2",
      "sftitle" : "Command line utility for Setting Read only and read-write mode",
      "rowid" : 5492222,
      "syssfcreatedbyid" : "00560000002MKBSAA4",
      "sfdescriptionc" : "This article explains how to toggle the Index from Read-Write monde to Read-Only mode and vice versa via command line",
      "size" : 6874,
      "sfislatestversion" : "true",
      "sysdocumenttype" : "article",
      "sfcreateddate" : 1481922513000,
      "sfsourceid" : "50032000010cA4pAAE",
      "clickableuri" : "https://na61.salesforce.com/kA1320000004Ks6",
      "syssource" : "Salesforce Public Items",
      "sfownerid" : "00560000002MKBSAA4",
      "orderingid" : 212384990660371028,
      "sfpublishstatus" : "Online",
      "syssize" : 6874,
      "sysdate" : 1509619413000,
      "sflanguage" : "en_US",
      "sysparents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Command line utility for Setting Read only and read-write mode\" uri=\"https://na61.salesforce.com/kA1320000004Ks6\" /></parents>",
      "sfdcexpandedarticletype" : "All;All|How To/Question",
      "sfcurrencyisocode" : "USD",
      "sfkbid" : "kA1320000004Ks6CAE",
      "sfdcexpandedproduct" : "All;All|Coveo Enterprise Search",
      "syssfcreateddate" : 1481922513000,
      "sflastmodifieddate" : 1481922556000,
      "sfisvisibleinpkb" : "true",
      "source" : "Salesforce Public Items",
      "sfarticletypec" : "How To",
      "sfisdeleted" : "false",
      "sfisvisibleincsp" : "true",
      "sfvalidationstatus" : "Reviewed",
      "sflastmodifiedbyname" : "Frederic Cote",
      "collection" : "default",
      "sfdcproduct" : [ "Coveo Enterprise Search" ],
      "syssourcetype" : "Salesforce",
      "sfarticletype" : "KB_Article__kav",
      "indexeddate" : 1518187522000,
      "connectortype" : "Salesforce2",
      "filetype" : "SalesforceItem",
      "sfcreatedbyname" : "Karel Mpungi",
      "sysclickableuri" : "https://na61.salesforce.com/kA1320000004Ks6",
      "sysfiletype" : "SalesforceItem",
      "language" : [ "English" ],
      "sffirstpublisheddate" : 1462975981000,
      "sfownername" : "Karel Mpungi",
      "sitename" : "Community",
      "sysrowid" : 5492222,
      "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
      "syscollection" : "default"
    },
    "Title" : "Command line utility for Setting Read only and read-write mode",
    "Uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
    "PrintableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
    "ClickUri" : "https://na61.salesforce.com/kA1320000004Ks6",
    "UniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA1320000004Ks6CAE/language:en_US",
    "Excerpt" : "This article explains how to toggle the Index from Read-Write monde to Read-Only mode and vice versa via command line ... Resolution ... In order to automate reactive measures for storage timeouts ...",
    "FirstSentences" : null
  }