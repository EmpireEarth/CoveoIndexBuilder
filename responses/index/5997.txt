{
    "title" : "Getting \"Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.\"",
    "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
    "printableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
    "clickUri" : "https://na61.salesforce.com/kA10d0000004MgO",
    "uniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
    "excerpt" : "This KB explains explains the root cause and provides a solution to the error below: ... Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collect...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1457,
    "percentScore" : 85.89072,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "Getting \"Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.\"",
      "sysurihash" : "70mUNblðUgERLhYL",
      "urihash" : "70mUNblðUgERLhYL",
      "parents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Getting &quot;Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.&quot;\" uri=\"https://na61.salesforce.com/kA10d0000004MgO\" /></parents>",
      "sfdcarticletype" : "Product Issue",
      "sfresolutionc" : "First, you need to validate that your crawling account meets the required permissions:\n<ul><li>SharePoint Administrator permission in Office 365 (Only when you index the content of a SharePoint web application), <a href=\"https://support.office.com/en-us/article/Assign-admin-roles-in-Office-365-for-business-eac4d046-1afd-4f1a-85fc-8219c79e1504?ui=en-US&amp;rs=en-US&amp;ad=US\" target=\"_blank\">see Assigning admin roles in Office 365</a></li><li>Administrator permission for all SharePoint Online site collections, including the root site collection,<a href=\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/granting_the_site_collection_administrator_permission_in_sharepoint_online.htm\" target=\"_blank\">see Granting the Site Collection Administrator Permission in SharePoint Online</a></li></ul>\nIf your crawling account has those permissions, and then the solution is to upgrade to the latest Coveo Enterprise Search <a href=\"http://productupdate.coveo.com/en/\" target=\"_blank\">version</a><br><br><span style=\"color: #FF0000;\"><u><b>Notes: </b></u></span>\n\n<ol><li><span style=\"color: #FF0000;\">If you&#39;re using Coveo Enterprise Search 7.0 x64 Build 8996</span> <a href=\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/identifying_the_coveo_enterprise_search_version.htm\" target=\"_blank\">version</a>, <span style=\"color: #FF0000;\">you don&#39;t need to upgrade, instead, you can install this</span> <a href=\"http://download.coveo.com/download/CES/7.0.8996.2/x64/Coveo%20Enterprise%20Search%207.0%20Hotfix%202%20x64%20(8996).exe\" target=\"_blank\">hotfix</a>.</li><li><span style=\"color: #FF0000;\">If you&#39;re using</span> <a href=\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/microsoft_sharepoint_source_quick_setups.htm\" target=\"_blank\">OKTA authentication</a><span style=\"color: #FF0000;\">, you need to upgrade to Coveo Enterprise Search 7.0 December 2017 Build or later.</span></li></ol>\n\n<ul><li>In the SharePoint Online source configuration, add the following parameter:</li></ul>\n\n<div style=\"margin-left: 40px;\">Name: UseWsTrustSpOnlineFederatedAuthentication<br>Value: True</div>\n<br><img alt=\"User-added image\" height=\"157\" src=\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021YI\" width=\"500\"></img>\n<ul><li>Still in the SharePoint Online source configuration page, scroll down and click &quot;Edit&quot; right under the Security Provider name</li></ul>\n<br><img alt=\"User-added image\" height=\"170\" src=\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021Z1\" width=\"500\"></img>\n<ul><li>In the Security Provider configuration page, scroll down to the &quot;Parameters&quot; section</li><li>Add the exact same parameter into the SharePoint Security Provider configuration</li></ul>\n<br><img alt=\"User-added image\" height=\"65\" src=\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021YN\" width=\"500\"></img>\n<ul><li>Rebuild the source</li></ul>",
      "sysuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
      "sysprintableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
      "sflastpublisheddate" : 1511793989000,
      "systransactionid" : 161139,
      "sfurlname" : "2798",
      "sfsystemmodstamp" : 1518176788000,
      "sfisvisibleinapp" : "true",
      "sfcoveoversionc" : "Coveo Enterprise Search",
      "sysconcepts" : "site collections ; crawling identity ; member ; root ; Coveo Enterprise ; SharePoint Online ; authentication ; admin roles ; sign-in experience ; form changed",
      "sfkbversionnumber" : "3",
      "concepts" : "site collections ; crawling identity ; member ; root ; Coveo Enterprise ; SharePoint Online ; authentication ; admin roles ; sign-in experience ; form changed",
      "printableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
      "documenttype" : "article",
      "sfkbarticlekavid" : "ka10d0000004TKOAA2",
      "sysindexeddate" : 1518187595000,
      "sfknowledgearticleid" : "kA10d0000004MgOCAU",
      "sfcreatedbyid" : "00560000002MKBSAA4",
      "sfconnectorc" : "N/A",
      "permanentid" : "a2860c97063ffb8c3fb4f7c9516114402fcc20a2ffb120a411f6e9d8c283",
      "syslanguage" : [ "English" ],
      "transactionid" : 161139,
      "sfisvisibleinprm" : "true",
      "title" : "Getting \"Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.\"",
      "sfversionnumber" : 3,
      "sfarticlenumber" : "000002798",
      "date" : 1518176788000,
      "objecttype" : "KB Article",
      "allmetadatavalues" : "{\"kav_lastmodifiedby.attribute.type\": [\"User\"], \"coveo_short_id\": [\"kA10d0000004MgO\"], \"sflastmodifiedbyname\": [\"Karel Mpungi\"], \"kav_coveo_version__c__html_stripped\": [\"Coveo Enterprise Search\"], \"fileextension\": [\"\"], \"sfdcexpandedproduct\": [\"All;All|Coveo Enterprise Search\"], \"kav_createdby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"sflanguage\": [\"en_US\"], \"kav_createdby.attribute.type\": [\"User\"], \"kav_createdby.id\": [\"00560000002MKBSAA4\"], \"kav_language\": [\"en_US\"], \"sfsitecoreversionc\": [\"N/A\"], \"sourcetype\": [\"Salesforce\"], \"title\": [\"Getting \\\"Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.\\\"\"], \"source\": [\"Salesforce Public Items\"], \"kav_owner.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"parents\": [\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?><parents><parent name=\\\"Organization\\\" uri=\\\"https://na61.salesforce.com/home/home.jsp\\\" /><parent name=\\\"KB_Article__ka\\\" uri=\\\"http://www.salesforce.com/org:organization/articletype:KB_Article\\\" /><parent name=\\\"Getting &quot;Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.&quot;\\\" uri=\\\"https://na61.salesforce.com/kA10d0000004MgO\\\" /></parents>\"], \"sfisvisibleinprm\": [true], \"kav_title\": [\"Getting \\\"Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.\\\"\"], \"kav_isvisibleincsp\": [true], \"hashtmlversion\": [true], \"kav_versionnumber\": [3], \"sfcreatedbyname\": [\"Karel Mpungi\"], \"sflastpublisheddate\": [1511793989], \"objecttypelabel\": [\"KB Article\"], \"kav_cause__c__html_stripped\": [\"Following a Microsoft  update , the login form changed and the SharePoint connector can no longer authenticate to SharePoint Online. \\n \\n So\\u00a0you're now using the new \\\"sign-in experience\\\" to log into Office365 \\n \\n  \\n \\n \\u00a0\"], \"originalhtmlcharset\": [1200], \"coveo_connector_hasbinarydata\": [false], \"kav_lastpublisheddate\": [1511793989], \"sfsystemmodstamp\": [1518176788], \"ka_attribute.type\": [\"KB_Article__ka\"], \"sfdcproduct\": [\"Coveo Enterprise Search\"], \"sfvendorversionc\": [\"SharePoint Online\"], \"kav_resolution__c__html_stripped\": [\"First, you need to validate that your crawling account meets the required permissions:\\n SharePoint Administrator permission in Office 365 (Only when you index the content of a SharePoint web application),  see Assigning admin roles in Office 365 Administrator permission for all SharePoint Online site collections, including the root site collection, see Granting the Site Collection Administrator Permission in SharePoint Online \\nIf your crawling account has those permissions, and then the solution is to upgrade to the latest Coveo Enterprise Search  version \\n \\n Notes:  \\n\\n If you're using Coveo Enterprise Search\\u00a07.0 x64 Build 8996   version ,  you don't need to upgrade, instead, you can install this   hotfix . If you're using   OKTA authentication , you need to upgrade to Coveo Enterprise Search\\u00a07.0 December 2017 Build or later. \\n\\n In the SharePoint Online source configuration, add the following parameter: \\n\\n Name:\\u00a0UseWsTrustSpOnlineFederatedAuthentication \\n Value:\\u00a0True \\n \\n  \\n Still in the SharePoint Online source configuration page, scroll down and click \\\"Edit\\\" right under the Security Provider name \\n \\n  \\n In the Security Provider configuration page, scroll down to the \\\"Parameters\\\" section Add the exact same parameter into the\\u00a0SharePoint Security Provider configuration \\n \\n  \\n Rebuild\\u00a0the source\"], \"clickableuri\": [\"https://na61.salesforce.com/kA10d0000004MgO\"], \"sftitle\": [\"Getting \\\"Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.\\\"\"], \"kav_owner.id\": [\"00560000002MKBSAA4\"], \"sfisvisibleinapp\": [true], \"ka_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__ka/kA10d0000004MgOCAU\"], \"sfdcarticletype\": [\"Product Issue\"], \"kav_cause__c\": [\"Following a Microsoft <a href=\\\"https://cloudblogs.microsoft.com/enterprisemobility/2017/08/02/the-new-azure-ad-signin-experience-is-now-in-public-preview/\\\" target=\\\"_blank\\\">update</a>, the login form changed and the SharePoint connector can no longer authenticate to SharePoint Online.<br><br>So\\u00a0you&#39;re now using the new &quot;sign-in experience&quot; to log into Office365<br><br><img alt=\\\"User-added image\\\" height=\\\"265\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000021Yw\\\" width=\\\"500\\\"></img><br><br>\\u00a0\"], \"sfislatestversion\": [true], \"sfcausec\": [\"Following a Microsoft <a href=\\\"https://cloudblogs.microsoft.com/enterprisemobility/2017/08/02/the-new-azure-ad-signin-experience-is-now-in-public-preview/\\\" target=\\\"_blank\\\">update</a>, the login form changed and the SharePoint connector can no longer authenticate to SharePoint Online.<br><br>So\\u00a0you&#39;re now using the new &quot;sign-in experience&quot; to log into Office365<br><br><img alt=\\\"User-added image\\\" height=\\\"265\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000021Yw\\\" width=\\\"500\\\"></img><br><br>\\u00a0\"], \"contenttype\": [\"binarydata\"], \"sfurlname\": [\"2798\"], \"ka_id\": [\"kA10d0000004MgOCAU\"], \"kav_datacategoryselections.datacategoryname\": [\"Coveo_Enterprise_Search;Product_Issue\"], \"coveo_url\": [\"https://na61.salesforce.com/kA10d0000004MgO\"], \"kav_urlname\": [\"2798\"], \"kav_dc_expanded_product\": [\"All;All|Coveo Enterprise Search\"], \"foldingcollection\": [\"c7e163bb55e1ab7aa04a16e08fcd956e1550005c58a247525024516ddcde\"], \"body\": [\"<html>   <body>     <div style=\\\"background-color: #fff;border: 2px solid #BBC5CC;border-radius: 4px;float: left;font-family: lato;margin-left: 15px;margin-right: 15px;margin-bottom: 4%;padding: 10px;width: 60%;\\\">       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Description         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> This KB explains explains the root cause and provides a solution to the error below:<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nError with ID &#39;SHAREPOINT_AUTHENTICATION_ERROR&#39;: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.</pre>\\n<br>See full error below:<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\n|ERROR|2017-11-17|00:01:25|0|Error with ID &#39;SHAREPOINT_AUTHENTICATION_ERROR&#39;: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SHAREPOINT_AUTHENTICATION_ERROR|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|SharePoint Error details: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. ---&gt; Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com ---&gt; System.Net.WebException: The remote name could not be resolved: &#39;login.microsoftonline.com&#39;|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at System.Net.HttpWebRequest.GetResponse()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CNL.Security.Claims.SharePointClaimsUtil.ParseValuesFromSharePointOnlineAuthenticationForm(String&amp; p_rBkParam, String&amp; p_rLcParam)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CNL.Security.Claims.SharePointClaimsUtil.GetFederatedUserBinarySecurityTokenFromOffice365(String p_AdfsSecurityToken, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0--- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetCookies(AuthenticationType p_AuthType, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.MultiServerAuthenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.SharePointConnection.RecoverRequest(Exception p_Exception, IDictionary`2 p_Parameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, String p_Identifier, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.SharePointConnection.GetSiteCollection(String p_SiteCollectionUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0--- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetSpecificItemFromUrl(String p_ItemUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.SharePoint.SharePointStandaloneCrawler.CreateStartingItemToCrawl(IRepository p_Repository, String p_StartingAddress, Configuration p_Configuration)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.SharePoint.AggregatedContentFetcherFactory.CreateContentFetcher(Int32 p_ContentFetcherPosition, IContentFetcherState p_State)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.Framework.ContentFetchers.ContentFetcherAggregator.&lt;Items&gt;d__0.MoveNext()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|ERROR|2017-11-17|00:01:25|0|Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. -&gt; Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com -&gt; The remote name could not be resolved: &#39;login.microsoftonline.com&#39;|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|IMPORTANT|2017-11-17|00:01:25|0|Incremental refresh of source SP Online was stopped.|||||Intranet||||SP Online|SUCCESS|||20140|12977||</pre>\\n<br>\\u00a0</div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Environment         </div>       </div>       <br/>       <table>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Product</td>           <td></td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Sitecore Version</td>           <td>N/A</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Connector</td>           <td>N/A</td>         </tr>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Published</td>           <td>1511793989</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Version</td>           <td></td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Build</td>           <td></td>         </tr>       </table>       <br/>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Cause         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> Following a Microsoft <a href=\\\"https://cloudblogs.microsoft.com/enterprisemobility/2017/08/02/the-new-azure-ad-signin-experience-is-now-in-public-preview/\\\" target=\\\"_blank\\\">update</a>, the login form changed and the SharePoint connector can no longer authenticate to SharePoint Online.<br><br>So\\u00a0you&#39;re now using the new &quot;sign-in experience&quot; to log into Office365<br><br><img alt=\\\"User-added image\\\" height=\\\"265\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000021Yw\\\" width=\\\"500\\\"></img><br><br>\\u00a0</div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Resolution         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> First, you need to validate that your crawling account meets the required permissions:\\n<ul><li>SharePoint Administrator permission in Office 365 (Only when you index the content of a SharePoint web application), <a href=\\\"https://support.office.com/en-us/article/Assign-admin-roles-in-Office-365-for-business-eac4d046-1afd-4f1a-85fc-8219c79e1504?ui=en-US&amp;rs=en-US&amp;ad=US\\\" target=\\\"_blank\\\">see Assigning admin roles in Office 365</a></li><li>Administrator permission for all SharePoint Online site collections, including the root site collection,<a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/granting_the_site_collection_administrator_permission_in_sharepoint_online.htm\\\" target=\\\"_blank\\\">see Granting the Site Collection Administrator Permission in SharePoint Online</a></li></ul>\\nIf your crawling account has those permissions, and then the solution is to upgrade to the latest Coveo Enterprise Search <a href=\\\"http://productupdate.coveo.com/en/\\\" target=\\\"_blank\\\">version</a><br><br><span style=\\\"color: #FF0000;\\\"><u><b>Notes: </b></u></span>\\n\\n<ol><li><span style=\\\"color: #FF0000;\\\">If you&#39;re using Coveo Enterprise Search\\u00a07.0 x64 Build 8996</span> <a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/identifying_the_coveo_enterprise_search_version.htm\\\" target=\\\"_blank\\\">version</a>, <span style=\\\"color: #FF0000;\\\">you don&#39;t need to upgrade, instead, you can install this</span> <a href=\\\"http://download.coveo.com/download/CES/7.0.8996.2/x64/Coveo%20Enterprise%20Search%207.0%20Hotfix%202%20x64%20(8996).exe\\\" target=\\\"_blank\\\">hotfix</a>.</li><li><span style=\\\"color: #FF0000;\\\">If you&#39;re using</span> <a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/microsoft_sharepoint_source_quick_setups.htm\\\" target=\\\"_blank\\\">OKTA authentication</a><span style=\\\"color: #FF0000;\\\">, you need to upgrade to Coveo Enterprise Search\\u00a07.0 December 2017 Build or later.</span></li></ol>\\n\\n<ul><li>In the SharePoint Online source configuration, add the following parameter:</li></ul>\\n\\n<div style=\\\"margin-left: 40px;\\\">Name:\\u00a0UseWsTrustSpOnlineFederatedAuthentication<br>Value:\\u00a0True</div>\\n<br><img alt=\\\"User-added image\\\" height=\\\"157\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021YI\\\" width=\\\"500\\\"></img>\\n<ul><li>Still in the SharePoint Online source configuration page, scroll down and click &quot;Edit&quot; right under the Security Provider name</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"170\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021Z1\\\" width=\\\"500\\\"></img>\\n<ul><li>In the Security Provider configuration page, scroll down to the &quot;Parameters&quot; section</li><li>Add the exact same parameter into the\\u00a0SharePoint Security Provider configuration</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"65\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021YN\\\" width=\\\"500\\\"></img>\\n<ul><li>Rebuild\\u00a0the source</li></ul></div>     </div>   </body> </html>\"], \"sfpublishstatus\": [\"Online\"], \"sfcreatedbyid\": [\"00560000002MKBSAA4\"], \"kav_description__c__html_stripped\": [\"This KB explains explains the root cause and provides a solution to the error below: \\n \\u00a0\\n \\nError with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. \\n \\n See full error below: \\n \\u00a0\\n \\n|ERROR|2017-11-17|00:01:25|0|Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SHAREPOINT_AUTHENTICATION_ERROR|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|SharePoint Error details: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. ---> Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com ---> System.Net.WebException: The remote name could not be resolved: 'login.microsoftonline.com'|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at System.Net.HttpWebRequest.GetResponse()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CNL.Security.Claims.SharePointClaimsUtil.ParseValuesFromSharePointOnlineAuthenticationForm(String& p_rBkParam, String& p_rLcParam)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CNL.Security.Claims.SharePointClaimsUtil.GetFederatedUserBinarySecurityTokenFromOffice365(String p_AdfsSecurityToken, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0--- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetCookies(AuthenticationType p_AuthType, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.MultiServerAuthenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.SharePointConnection.RecoverRequest(Exception p_Exception, IDictionary`2 p_Parameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, String p_Identifier, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.SharePointConnection.GetSiteCollection(String p_SiteCollectionUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0--- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetSpecificItemFromUrl(String p_ItemUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.SharePoint.SharePointStandaloneCrawler.CreateStartingItemToCrawl(IRepository p_Repository, String p_StartingAddress, Configuration p_Configuration)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.SharePoint.AggregatedContentFetcherFactory.CreateContentFetcher(Int32 p_ContentFetcherPosition, IContentFetcherState p_State)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.Framework.ContentFetchers.ContentFetcherAggregator.<Items>d__0.MoveNext()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|ERROR|2017-11-17|00:01:25|0|Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. -> Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com -> The remote name could not be resolved: 'login.microsoftonline.com'|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|IMPORTANT|2017-11-17|00:01:25|0|Incremental refresh of source SP Online was stopped.|||||Intranet||||SP Online|SUCCESS|||20140|12977|| \\n \\n \\u00a0\"], \"kav_islatestversion\": [true], \"kav_knowledgearticleid\": [\"kA10d0000004MgOCAU\"], \"sfknowledgearticleid\": [\"kA10d0000004MgOCAU\"], \"sfownername\": [\"Karel Mpungi\"], \"kav_datacategoryselections.attribute.type\": [\"KB_Article__DataCategorySelection;KB_Article__DataCategorySelection\"], \"detectedtitle\": [\"Description\"], \"kav_createddate\": [1511296776], \"language\": [\"English\"], \"coveo_foldingchild\": [\"76a076cd6c52c2e95bf1902f82e85cb66a0b2bd4e833fcdd2755e80ded22\"], \"sfownerid\": [\"00560000002MKBSAA4\"], \"kav_createdby.coveo_record_size\": [2], \"kav_vendor_version__c\": [\"SharePoint Online\"], \"kav_systemmodstamp\": [1518176788], \"objecttype\": [\"KB Article\"], \"connectortype\": [\"Salesforce2\"], \"kav_coveo_record_size\": [4], \"originaluri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US\"], \"sfisvisibleincsp\": [true], \"convertertype\": [\"TYPE_HTML\"], \"filetype\": [\"SalesforceItem\"], \"kav_owner.name\": [\"Karel Mpungi\"], \"sfcoveoversionc\": [\"Coveo Enterprise Search\"], \"sfdcexpandedarticletype\": [\"All;All|Product Issue\"], \"objecttypelabelplural\": [\"KB Articles\"], \"sfcurrencyisocode\": [\"USD\"], \"sfisdeleted\": [false], \"extractedsize\": [16160], \"size\": [21231], \"kav_publishstatus\": [\"Online\"], \"kav_connector__c\": [\"N/A\"], \"generateexcerpt\": [true], \"sfdescriptionc\": [\"This KB explains explains the root cause and provides a solution to the error below:<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nError with ID &#39;SHAREPOINT_AUTHENTICATION_ERROR&#39;: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.</pre>\\n<br>See full error below:<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\n|ERROR|2017-11-17|00:01:25|0|Error with ID &#39;SHAREPOINT_AUTHENTICATION_ERROR&#39;: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SHAREPOINT_AUTHENTICATION_ERROR|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|SharePoint Error details: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. ---&gt; Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com ---&gt; System.Net.WebException: The remote name could not be resolved: &#39;login.microsoftonline.com&#39;|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at System.Net.HttpWebRequest.GetResponse()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CNL.Security.Claims.SharePointClaimsUtil.ParseValuesFromSharePointOnlineAuthenticationForm(String&amp; p_rBkParam, String&amp; p_rLcParam)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CNL.Security.Claims.SharePointClaimsUtil.GetFederatedUserBinarySecurityTokenFromOffice365(String p_AdfsSecurityToken, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0--- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetCookies(AuthenticationType p_AuthType, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.MultiServerAuthenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.SharePointConnection.RecoverRequest(Exception p_Exception, IDictionary`2 p_Parameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, String p_Identifier, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.SharePointConnection.GetSiteCollection(String p_SiteCollectionUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0--- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetSpecificItemFromUrl(String p_ItemUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.SharePoint.SharePointStandaloneCrawler.CreateStartingItemToCrawl(IRepository p_Repository, String p_StartingAddress, Configuration p_Configuration)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.SharePoint.AggregatedContentFetcherFactory.CreateContentFetcher(Int32 p_ContentFetcherPosition, IContentFetcherState p_State)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.Framework.ContentFetchers.ContentFetcherAggregator.&lt;Items&gt;d__0.MoveNext()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|ERROR|2017-11-17|00:01:25|0|Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. -&gt; Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com -&gt; The remote name could not be resolved: &#39;login.microsoftonline.com&#39;|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|IMPORTANT|2017-11-17|00:01:25|0|Incremental refresh of source SP Online was stopped.|||||Intranet||||SP Online|SUCCESS|||20140|12977||</pre>\\n<br>\\u00a0\"], \"sfarticletype\": [\"KB_Article__kav\"], \"kav_articletype\": [\"KB_Article__kav\"], \"kav_lastmodifieddate\": [1511793989], \"documenttype\": [\"article\"], \"sfkbarticlekavid\": [\"ka10d0000004TKOAA2\"], \"kav_currencyisocode\": [\"USD\"], \"foldingparent\": [\"76a076cd6c52c2e95bf1902f82e85cb66a0b2bd4e833fcdd2755e80ded22\"], \"mappingtype\": [\"KB_Article\"], \"kav_isvisibleinpkb\": [true], \"kav_sourceid\": [\"5000d00001FzVZdAAN\"], \"sfkbversionnumber\": [3], \"kav_isvisibleinapp\": [true], \"kav_resolution__c\": [\"First, you need to validate that your crawling account meets the required permissions:\\n<ul><li>SharePoint Administrator permission in Office 365 (Only when you index the content of a SharePoint web application), <a href=\\\"https://support.office.com/en-us/article/Assign-admin-roles-in-Office-365-for-business-eac4d046-1afd-4f1a-85fc-8219c79e1504?ui=en-US&amp;rs=en-US&amp;ad=US\\\" target=\\\"_blank\\\">see Assigning admin roles in Office 365</a></li><li>Administrator permission for all SharePoint Online site collections, including the root site collection,<a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/granting_the_site_collection_administrator_permission_in_sharepoint_online.htm\\\" target=\\\"_blank\\\">see Granting the Site Collection Administrator Permission in SharePoint Online</a></li></ul>\\nIf your crawling account has those permissions, and then the solution is to upgrade to the latest Coveo Enterprise Search <a href=\\\"http://productupdate.coveo.com/en/\\\" target=\\\"_blank\\\">version</a><br><br><span style=\\\"color: #FF0000;\\\"><u><b>Notes: </b></u></span>\\n\\n<ol><li><span style=\\\"color: #FF0000;\\\">If you&#39;re using Coveo Enterprise Search\\u00a07.0 x64 Build 8996</span> <a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/identifying_the_coveo_enterprise_search_version.htm\\\" target=\\\"_blank\\\">version</a>, <span style=\\\"color: #FF0000;\\\">you don&#39;t need to upgrade, instead, you can install this</span> <a href=\\\"http://download.coveo.com/download/CES/7.0.8996.2/x64/Coveo%20Enterprise%20Search%207.0%20Hotfix%202%20x64%20(8996).exe\\\" target=\\\"_blank\\\">hotfix</a>.</li><li><span style=\\\"color: #FF0000;\\\">If you&#39;re using</span> <a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/microsoft_sharepoint_source_quick_setups.htm\\\" target=\\\"_blank\\\">OKTA authentication</a><span style=\\\"color: #FF0000;\\\">, you need to upgrade to Coveo Enterprise Search\\u00a07.0 December 2017 Build or later.</span></li></ol>\\n\\n<ul><li>In the SharePoint Online source configuration, add the following parameter:</li></ul>\\n\\n<div style=\\\"margin-left: 40px;\\\">Name:\\u00a0UseWsTrustSpOnlineFederatedAuthentication<br>Value:\\u00a0True</div>\\n<br><img alt=\\\"User-added image\\\" height=\\\"157\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021YI\\\" width=\\\"500\\\"></img>\\n<ul><li>Still in the SharePoint Online source configuration page, scroll down and click &quot;Edit&quot; right under the Security Provider name</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"170\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021Z1\\\" width=\\\"500\\\"></img>\\n<ul><li>In the Security Provider configuration page, scroll down to the &quot;Parameters&quot; section</li><li>Add the exact same parameter into the\\u00a0SharePoint Security Provider configuration</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"65\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021YN\\\" width=\\\"500\\\"></img>\\n<ul><li>Rebuild\\u00a0the source</li></ul>\"], \"coveo_objecttype\": [\"KB_Article\"], \"printableuri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US\"], \"kav_datacategoryselections.attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o0d000000m79rAAA;/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o0d000000m79sAAA\"], \"kav_id\": [\"ka10d0000004TKOAA2\"], \"sfresolutionc\": [\"First, you need to validate that your crawling account meets the required permissions:\\n<ul><li>SharePoint Administrator permission in Office 365 (Only when you index the content of a SharePoint web application), <a href=\\\"https://support.office.com/en-us/article/Assign-admin-roles-in-Office-365-for-business-eac4d046-1afd-4f1a-85fc-8219c79e1504?ui=en-US&amp;rs=en-US&amp;ad=US\\\" target=\\\"_blank\\\">see Assigning admin roles in Office 365</a></li><li>Administrator permission for all SharePoint Online site collections, including the root site collection,<a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/granting_the_site_collection_administrator_permission_in_sharepoint_online.htm\\\" target=\\\"_blank\\\">see Granting the Site Collection Administrator Permission in SharePoint Online</a></li></ul>\\nIf your crawling account has those permissions, and then the solution is to upgrade to the latest Coveo Enterprise Search <a href=\\\"http://productupdate.coveo.com/en/\\\" target=\\\"_blank\\\">version</a><br><br><span style=\\\"color: #FF0000;\\\"><u><b>Notes: </b></u></span>\\n\\n<ol><li><span style=\\\"color: #FF0000;\\\">If you&#39;re using Coveo Enterprise Search\\u00a07.0 x64 Build 8996</span> <a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/identifying_the_coveo_enterprise_search_version.htm\\\" target=\\\"_blank\\\">version</a>, <span style=\\\"color: #FF0000;\\\">you don&#39;t need to upgrade, instead, you can install this</span> <a href=\\\"http://download.coveo.com/download/CES/7.0.8996.2/x64/Coveo%20Enterprise%20Search%207.0%20Hotfix%202%20x64%20(8996).exe\\\" target=\\\"_blank\\\">hotfix</a>.</li><li><span style=\\\"color: #FF0000;\\\">If you&#39;re using</span> <a href=\\\"https://onlinehelp.coveo.com/en/ces/7.0/administrator/microsoft_sharepoint_source_quick_setups.htm\\\" target=\\\"_blank\\\">OKTA authentication</a><span style=\\\"color: #FF0000;\\\">, you need to upgrade to Coveo Enterprise Search\\u00a07.0 December 2017 Build or later.</span></li></ol>\\n\\n<ul><li>In the SharePoint Online source configuration, add the following parameter:</li></ul>\\n\\n<div style=\\\"margin-left: 40px;\\\">Name:\\u00a0UseWsTrustSpOnlineFederatedAuthentication<br>Value:\\u00a0True</div>\\n<br><img alt=\\\"User-added image\\\" height=\\\"157\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021YI\\\" width=\\\"500\\\"></img>\\n<ul><li>Still in the SharePoint Online source configuration page, scroll down and click &quot;Edit&quot; right under the Security Provider name</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"170\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021Z1\\\" width=\\\"500\\\"></img>\\n<ul><li>In the Security Provider configuration page, scroll down to the &quot;Parameters&quot; section</li><li>Add the exact same parameter into the\\u00a0SharePoint Security Provider configuration</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"65\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000021YN\\\" width=\\\"500\\\"></img>\\n<ul><li>Rebuild\\u00a0the source</li></ul>\"], \"foldingchild\": [\"76a076cd6c52c2e95bf1902f82e85cb66a0b2bd4e833fcdd2755e80ded22\"], \"sfcreateddate\": [1511296776], \"kav_sitecore_version__c\": [\"N/A\"], \"kav_owner.coveo_record_size\": [2], \"kav_coveo_effective_modstamp\": [1518176788], \"kav_summary__html_stripped\": [\"\"], \"kav_dc_article_type\": [\"Product Issue\"], \"sfconnectorc\": [\"N/A\"], \"kav_dc_product\": [\"Coveo Enterprise Search\"], \"ka_coveo_record_size\": [2], \"kav_dc_expanded_article_type\": [\"All;All|Product Issue\"], \"kav_datacategoryselections.coveo_record_size\": [\"2;2\"], \"concepts\": [\"site collections ; crawling identity ; member ; root ; Coveo Enterprise ; SharePoint Online ; authentication ; admin roles ; sign-in experience ; form changed\"], \"sfkbid\": [\"kA10d0000004MgOCAU\"], \"kav_firstpublisheddate\": [1510960992], \"coveo_organization_id\": [\"00D3000000007r2\"], \"coveo_foldingcollection\": [\"c7e163bb55e1ab7aa04a16e08fcd956e1550005c58a247525024516ddcde\"], \"sffirstpublisheddate\": [1510960992], \"sflastmodifieddate\": [1511793989], \"kav_coveo_version__c\": [\"Coveo Enterprise Search\"], \"kav_vendor_version__c__html_stripped\": [\"SharePoint Online\"], \"detectedlanguage\": [1], \"kav_isvisibleinprm\": [true], \"kav_owner.attribute.type\": [\"Name\"], \"kav_lastmodifiedby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"sitename\": [\"Community\"], \"kav_createdby.name\": [\"Karel Mpungi\"], \"sfarticlenumber\": [\"000002798\"], \"kav_lastmodifiedby.coveo_record_size\": [2], \"sfisvisibleinpkb\": [true], \"kav_datacategoryselections.id\": [\"02o0d000000m79rAAA;02o0d000000m79sAAA\"], \"kav_description__c\": [\"This KB explains explains the root cause and provides a solution to the error below:<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nError with ID &#39;SHAREPOINT_AUTHENTICATION_ERROR&#39;: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.</pre>\\n<br>See full error below:<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\n|ERROR|2017-11-17|00:01:25|0|Error with ID &#39;SHAREPOINT_AUTHENTICATION_ERROR&#39;: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SHAREPOINT_AUTHENTICATION_ERROR|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|SharePoint Error details: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. ---&gt; Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com ---&gt; System.Net.WebException: The remote name could not be resolved: &#39;login.microsoftonline.com&#39;|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at System.Net.HttpWebRequest.GetResponse()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CNL.Security.Claims.SharePointClaimsUtil.ParseValuesFromSharePointOnlineAuthenticationForm(String&amp; p_rBkParam, String&amp; p_rLcParam)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CNL.Security.Claims.SharePointClaimsUtil.GetFederatedUserBinarySecurityTokenFromOffice365(String p_AdfsSecurityToken, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0--- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetCookies(AuthenticationType p_AuthType, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.Authentication.MultiServerAuthenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.SharePointConnection.RecoverRequest(Exception p_Exception, IDictionary`2 p_Parameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, String p_Identifier, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Connection.SharePointConnection.GetSiteCollection(String p_SiteCollectionUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0--- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.Connectors.SharePoint.Repository.GetSpecificItemFromUrl(String p_ItemUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.SharePoint.SharePointStandaloneCrawler.CreateStartingItemToCrawl(IRepository p_Repository, String p_StartingAddress, Configuration p_Configuration)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.SharePoint.AggregatedContentFetcherFactory.CreateContentFetcher(Int32 p_ContentFetcherPosition, IContentFetcherState p_State)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|NORMAL|2017-11-17|00:01:25|0|... \\u00a0 \\u00a0at Coveo.CES.CustomCrawlers.Framework.ContentFetchers.ContentFetcherAggregator.&lt;Items&gt;d__0.MoveNext()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|ERROR|2017-11-17|00:01:25|0|Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. -&gt; Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com -&gt; The remote name could not be resolved: &#39;login.microsoftonline.com&#39;|||||Intranet||||SP Online|SUCCESS|||20140|12977||\\n|IMPORTANT|2017-11-17|00:01:25|0|Incremental refresh of source SP Online was stopped.|||||Intranet||||SP Online|SUCCESS|||20140|12977||</pre>\\n<br>\\u00a0\"], \"kav_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__kav/ka10d0000004TKOAA2\"], \"kav_articlenumber__stripped\": [\"2798\"], \"sfversionnumber\": [3], \"kav_attribute.type\": [\"KB_Article__kav\"], \"kav_validationstatus\": [\"Reviewed\"], \"coveo_foldingparent\": [\"76a076cd6c52c2e95bf1902f82e85cb66a0b2bd4e833fcdd2755e80ded22\"], \"collection\": [\"default\"], \"sfsourceid\": [\"5000d00001FzVZdAAN\"], \"date\": [1518176788], \"kav_lastmodifiedby.id\": [\"00560000002MKBSAA4\"], \"kav_datacategoryselections.datacategorygroupname\": [\"Product;Article_Type\"], \"conversionstate\": [0], \"sfvalidationstatus\": [\"Reviewed\"], \"kav_isdeleted\": [false], \"sflastmodifiedbyid\": [\"00560000002MKBSAA4\"], \"kav_lastmodifiedby.name\": [\"Karel Mpungi\"], \"kav_articlenumber\": [\"000002798\"], \"permanentid\": [\"a2860c97063ffb8c3fb4f7c9516114402fcc20a2ffb120a411f6e9d8c283\"]}",
      "sflastmodifiedbyid" : "00560000002MKBSAA4",
      "syssfownerid" : "00560000002MKBSAA4",
      "sfsitecoreversionc" : "N/A",
      "sourcetype" : "Salesforce",
      "sysconnectortype" : "Salesforce2",
      "sftitle" : "Getting \"Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.\"",
      "rowid" : 5493250,
      "syssfcreatedbyid" : "00560000002MKBSAA4",
      "sfdescriptionc" : "This KB explains explains the root cause and provides a solution to the error below:<br> \n<pre class=\"ckeditor_codeblock\">\nError with ID &#39;SHAREPOINT_AUTHENTICATION_ERROR&#39;: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.</pre>\n<br>See full error below:<br> \n<pre class=\"ckeditor_codeblock\">\n|ERROR|2017-11-17|00:01:25|0|Error with ID &#39;SHAREPOINT_AUTHENTICATION_ERROR&#39;: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SHAREPOINT_AUTHENTICATION_ERROR|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|SharePoint Error details: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|... Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. ---&gt; Coveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com ---&gt; System.Net.WebException: The remote name could not be resolved: &#39;login.microsoftonline.com&#39;|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at System.Net.HttpWebRequest.GetResponse()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.CNL.Security.Claims.SharePointClaimsUtil.ParseValuesFromSharePointOnlineAuthenticationForm(String&amp; p_rBkParam, String&amp; p_rLcParam)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.CNL.Security.Claims.SharePointClaimsUtil.GetFederatedUserBinarySecurityTokenFromOffice365(String p_AdfsSecurityToken, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    --- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetSpOnlineFederatedCookies(String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.GetCookies(AuthenticationType p_AuthType, String p_ServerUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Connection.Authentication.MultiServerAuthenticator.Authenticate(String p_ServerUrl, Boolean p_ForceReauthentication)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Connection.SharePointConnection.RecoverRequest(Exception p_Exception, IDictionary`2 p_Parameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, String p_Identifier, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.Utilities.Http.RequestRetryExecutioner.Execute[T](Func`1 p_Request, IDictionary`2 p_RecoverParameters)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Connection.SharePointConnection.GetSiteCollection(String p_SiteCollectionUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    --- End of inner exception stack trace ---|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Repository.GetRootWebApplication()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.Connectors.SharePoint.Repository.GetSpecificItemFromUrl(String p_ItemUrl)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.CES.CustomCrawlers.SharePoint.SharePointStandaloneCrawler.CreateStartingItemToCrawl(IRepository p_Repository, String p_StartingAddress, Configuration p_Configuration)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.CES.CustomCrawlers.SharePoint.AggregatedContentFetcherFactory.CreateContentFetcher(Int32 p_ContentFetcherPosition, IContentFetcherState p_State)|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|NORMAL|2017-11-17|00:01:25|0|...    at Coveo.CES.CustomCrawlers.Framework.ContentFetchers.ContentFetcherAggregator.&lt;Items&gt;d__0.MoveNext()|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|ERROR|2017-11-17|00:01:25|0|Authentication Failed. Details: Unable to retrieve the Site Collection at https://devcoveo.sharepoint.com. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. -&gt; Authentication Failed. Details: An unexpected error occurred when trying to retrieve the binary security token from Office 365 for the Sharepoint Url https://devcoveo.sharepoint.com -&gt; The remote name could not be resolved: &#39;login.microsoftonline.com&#39;|||||Intranet||||SP Online|SUCCESS|||20140|12977||\n|IMPORTANT|2017-11-17|00:01:25|0|Incremental refresh of source SP Online was stopped.|||||Intranet||||SP Online|SUCCESS|||20140|12977||</pre>\n<br> ",
      "size" : 21231,
      "sfislatestversion" : "true",
      "sysdocumenttype" : "article",
      "sfcreateddate" : 1511296776000,
      "sfsourceid" : "5000d00001FzVZdAAN",
      "clickableuri" : "https://na61.salesforce.com/kA10d0000004MgO",
      "syssource" : "Salesforce Public Items",
      "sfownerid" : "00560000002MKBSAA4",
      "orderingid" : 212384990660372016,
      "sfpublishstatus" : "Online",
      "syssize" : 21231,
      "sysdate" : 1518176788000,
      "sflanguage" : "en_US",
      "sysparents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Getting &quot;Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.&quot;\" uri=\"https://na61.salesforce.com/kA10d0000004MgO\" /></parents>",
      "sfdcexpandedarticletype" : "All;All|Product Issue",
      "sfcurrencyisocode" : "USD",
      "sfkbid" : "kA10d0000004MgOCAU",
      "sfcausec" : "Following a Microsoft <a href=\"https://cloudblogs.microsoft.com/enterprisemobility/2017/08/02/the-new-azure-ad-signin-experience-is-now-in-public-preview/\" target=\"_blank\">update</a>, the login form changed and the SharePoint connector can no longer authenticate to SharePoint Online.<br><br>So you&#39;re now using the new &quot;sign-in experience&quot; to log into Office365<br><br><img alt=\"User-added image\" height=\"265\" src=\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004TKO&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000021Yw\" width=\"500\"></img><br><br> ",
      "sfdcexpandedproduct" : "All;All|Coveo Enterprise Search",
      "syssfcreateddate" : 1511296776000,
      "sflastmodifieddate" : 1511793989000,
      "sfisvisibleinpkb" : "true",
      "source" : "Salesforce Public Items",
      "sfisdeleted" : "false",
      "sfisvisibleincsp" : "true",
      "sfvalidationstatus" : "Reviewed",
      "sflastmodifiedbyname" : "Karel Mpungi",
      "collection" : "default",
      "sfdcproduct" : [ "Coveo Enterprise Search" ],
      "syssourcetype" : "Salesforce",
      "sfarticletype" : "KB_Article__kav",
      "indexeddate" : 1518187595000,
      "connectortype" : "Salesforce2",
      "filetype" : "SalesforceItem",
      "sfcreatedbyname" : "Karel Mpungi",
      "sysclickableuri" : "https://na61.salesforce.com/kA10d0000004MgO",
      "sysfiletype" : "SalesforceItem",
      "sfvendorversionc" : "SharePoint Online",
      "language" : [ "English" ],
      "sffirstpublisheddate" : 1510960992000,
      "sfownername" : "Karel Mpungi",
      "sitename" : "Community",
      "sysrowid" : 5493250,
      "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
      "syscollection" : "default"
    },
    "Title" : "Getting \"Error with ID 'SHAREPOINT_AUTHENTICATION_ERROR': Authentication Failed. Details: Unable to retrieve the Site Collection [...]Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection.\"",
    "Uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
    "PrintableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
    "ClickUri" : "https://na61.salesforce.com/kA10d0000004MgO",
    "UniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004MgOCAU/language:en_US",
    "Excerpt" : "This KB explains explains the root cause and provides a solution to the error below: ... Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collect...",
    "FirstSentences" : null
  }