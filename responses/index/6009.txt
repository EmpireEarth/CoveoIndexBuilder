{
    "title" : "Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild",
    "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
    "printableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
    "clickUri" : "https://na61.salesforce.com/kA132000000L8Qe",
    "uniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
    "excerpt" : "When installing Coveo for Sitecore in an all local environment with a local CES on-premises, when rebuilding the Indexes for the first time in Sitecore Control Panel >> Indexing manager, this error...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1446,
    "percentScore" : 85.56588,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild",
      "sysurihash" : "Nq1SLYUtñ4KTKQV1",
      "urihash" : "Nq1SLYUtñ4KTKQV1",
      "parents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild\" uri=\"https://na61.salesforce.com/kA132000000L8Qe\" /></parents>",
      "sfdcarticletype" : "Problem/Fix",
      "sfresolutionc" : "Restarting the local machine hosting on-premises CES and Coveo for Sitecore resolved the problem.",
      "sysuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
      "sysprintableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
      "sflastpublisheddate" : 1518013431000,
      "systransactionid" : 161139,
      "sfurlname" : "2030",
      "sfsystemmodstamp" : 1518090402000,
      "sfisvisibleinapp" : "true",
      "sfcoveoversionc" : "Coveo for Sitecore 3.0, Coveo for Sitecore 4.0",
      "sysconcepts" : "Exception ; manager ; on-premises ; environment ; Program Files ; Precondition ; AdminService ; SitecoreFeaturesResolver ; ISitecoreFeaturesResolver ; CreateInstance ; ProviderUpdateContextTypeHandler ; SearchProvider ; ParameterName ; NullReferenceException ; TargetInvocationException",
      "sfkbversionnumber" : "2",
      "concepts" : "Exception ; manager ; on-premises ; environment ; Program Files ; Precondition ; AdminService ; SitecoreFeaturesResolver ; ISitecoreFeaturesResolver ; CreateInstance ; ProviderUpdateContextTypeHandler ; SearchProvider ; ParameterName ; NullReferenceException ; TargetInvocationException",
      "printableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
      "documenttype" : "article",
      "sfkbarticlekavid" : "ka10d0000004V22AAE",
      "sysindexeddate" : 1518187607000,
      "sfknowledgearticleid" : "kA132000000L8QeCAK",
      "sfcreatedbyid" : "00560000003q7JgAAI",
      "sfconnectorc" : "N/A",
      "permanentid" : "e8ab0725666317e465fb83115783c31b773c03f5ed3ad53497abfdf9180b",
      "syslanguage" : [ "English" ],
      "transactionid" : 161139,
      "sfisvisibleinprm" : "true",
      "title" : "Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild",
      "sfversionnumber" : 2,
      "sfarticlenumber" : "000002030",
      "date" : 1518090402000,
      "objecttype" : "KB Article",
      "allmetadatavalues" : "{\"kav_lastmodifiedby.attribute.type\": [\"User\"], \"coveo_short_id\": [\"kA132000000L8Qe\"], \"sflastmodifiedbyname\": [\"Frederic Cote\"], \"kav_coveo_version__c__html_stripped\": [\"Coveo for Sitecore 3.0, Coveo for Sitecore 4.0\"], \"fileextension\": [\"\"], \"sfdcexpandedproduct\": [\"All;All|Sitecore\"], \"kav_createdby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000003q7JgAAI\"], \"sflanguage\": [\"en_US\"], \"kav_createdby.attribute.type\": [\"User\"], \"kav_createdby.id\": [\"00560000003q7JgAAI\"], \"kav_language\": [\"en_US\"], \"sfsitecoreversionc\": [\"N/A\"], \"sourcetype\": [\"Salesforce\"], \"title\": [\"Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild\"], \"source\": [\"Salesforce Public Items\"], \"kav_owner.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000003q7JgAAI\"], \"parents\": [\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?><parents><parent name=\\\"Organization\\\" uri=\\\"https://na61.salesforce.com/home/home.jsp\\\" /><parent name=\\\"KB_Article__ka\\\" uri=\\\"http://www.salesforce.com/org:organization/articletype:KB_Article\\\" /><parent name=\\\"Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild\\\" uri=\\\"https://na61.salesforce.com/kA132000000L8Qe\\\" /></parents>\"], \"sfisvisibleinprm\": [true], \"kav_title\": [\"Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild\"], \"kav_isvisibleincsp\": [true], \"hashtmlversion\": [true], \"kav_versionnumber\": [2], \"sfcreatedbyname\": [\"Frederic Cote\"], \"sflastpublisheddate\": [1518013431], \"objecttypelabel\": [\"KB Article\"], \"kav_cause__c__html_stripped\": [\"Because the Admin Service is not  secured , this means that the problem lies in the Admin Service Windows Service itself. \\n \\n Most likely explanation is that:\\n The user running the Windows Service does not have full access to\\u00a0\\u00a0C:\\\\Program Files\\\\Coveo Enterprise Search 7 The user trying to access\\u00a0http://localhost/AdminService does not have sufficient access to\\u00a0C:\\\\Program Files\\\\Coveo Enterprise Search 7\"], \"originalhtmlcharset\": [1200], \"coveo_connector_hasbinarydata\": [false], \"kav_lastpublisheddate\": [1518013431], \"sfsystemmodstamp\": [1518090402], \"ka_attribute.type\": [\"KB_Article__ka\"], \"sfdcproduct\": [\"Sitecore\"], \"kav_resolution__c__html_stripped\": [\"Restarting the local machine hosting on-premises CES and Coveo for Sitecore resolved the problem.\"], \"clickableuri\": [\"https://na61.salesforce.com/kA132000000L8Qe\"], \"sftitle\": [\"Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild\"], \"kav_owner.id\": [\"00560000003q7JgAAI\"], \"sfbuildc\": [\"All\"], \"sfisvisibleinapp\": [true], \"ka_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__ka/kA132000000L8QeCAK\"], \"sfdcarticletype\": [\"Problem/Fix\"], \"kav_cause__c\": [\"Because the Admin Service is not <a href=\\\"https://developers.coveo.com/display/public/SitecoreV4/Securing+the+Admin+Service+-+On-Premises\\\" target=\\\"_blank\\\">secured</a>, this means that the problem lies in the Admin Service Windows Service itself.<br><br>Most likely explanation is that:\\n<ul><li>The user running the Windows Service does not have full access to\\u00a0\\u00a0C:\\\\Program Files\\\\Coveo Enterprise Search 7</li><li>The user trying to access\\u00a0http://localhost/AdminService does not have sufficient access to\\u00a0C:\\\\Program Files\\\\Coveo Enterprise Search 7</li></ul>\"], \"sfislatestversion\": [true], \"sfcausec\": [\"Because the Admin Service is not <a href=\\\"https://developers.coveo.com/display/public/SitecoreV4/Securing+the+Admin+Service+-+On-Premises\\\" target=\\\"_blank\\\">secured</a>, this means that the problem lies in the Admin Service Windows Service itself.<br><br>Most likely explanation is that:\\n<ul><li>The user running the Windows Service does not have full access to\\u00a0\\u00a0C:\\\\Program Files\\\\Coveo Enterprise Search 7</li><li>The user trying to access\\u00a0http://localhost/AdminService does not have sufficient access to\\u00a0C:\\\\Program Files\\\\Coveo Enterprise Search 7</li></ul>\"], \"contenttype\": [\"binarydata\"], \"sfurlname\": [\"2030\"], \"ka_id\": [\"kA132000000L8QeCAK\"], \"kav_datacategoryselections.datacategoryname\": [\"Sitecore;Configuration\"], \"coveo_url\": [\"https://na61.salesforce.com/kA132000000L8Qe\"], \"kav_urlname\": [\"2030\"], \"kav_dc_expanded_product\": [\"All;All|Sitecore\"], \"foldingcollection\": [\"093174d1b95acda838306f557a57b78fb9f9febec25bc28524e0d61fe720\"], \"body\": [\"<html>   <body>     <div style=\\\"background-color: #fff;border: 2px solid #BBC5CC;border-radius: 4px;float: left;font-family: lato;margin-left: 15px;margin-right: 15px;margin-bottom: 4%;padding: 10px;width: 60%;\\\">       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Description         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> When installing Coveo for Sitecore in an all local environment with a local CES on-premises, when rebuilding the Indexes for the first time in Sitecore Control Panel \\u00ad\\u00ad&gt;&gt; Indexing manager, this errors appears in the Manager Window.\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nJob started: Index_Update_IndexName=Coveo_master_index|#Exception: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---&gt; System.NullReferenceException: Object reference not set to an instance of an object. \\nat System.Object.GetType() \\nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, String p_ParameterName) \\nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, Func`1 p_ParameterExpression) \\nat Coveo.SearchProvider.Utils.ProviderUpdateContextTypeHandler.CreateInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \\nat Coveo.Framework.ObjectFactory.TypeHandlers.BaseCreateInstanceTypeHandler`1.Coveo.Framework.ObjectFactory.ICreateInstanceTypeHandler.CreateObjectInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \\nat Coveo.Framework.ObjectFactory.ObjectFactory.CreateInstance[T](Object[] p_Arguments) \\nat Coveo.SearchProvider.ProviderIndex.CreateUpdateContext() \\nat Coveo.SearchProvider.ProviderIndex.&lt;Rebuild&gt;b__42() \\nat Coveo.SearchProvider.ProviderIndex.TryPerformIndexingOperation(IndexingOptions p_IndexingOptions, Action p_Action) \\nat Coveo.SearchProvider.ProviderIndex.Rebuild() \\n--- End of inner exception stack trace --- \\nat System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor) \\nat System.Reflection.RuntimeMethodInfo.UnsafeInvokeInternal(Object obj, Object[] parameters, Object[] arguments) \\nat System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture) \\nat Sitecore.Reflection.ReflectionUtil.InvokeMethod(MethodInfo method, Object[] parameters, Object obj) \\nat Sitecore.Jobs.JobRunner.RunMethod(JobArgs args) \\nat (Object , Object[] ) \\nat Sitecore.Pipelines.CorePipeline.Run(PipelineArgs args) \\nat Sitecore.Jobs.Job.ThreadEntry(Object state)</pre>\\nIn addition, in Coveo for Sitecore diagnostic page, you see this message for the Coveo Search Web Service\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nSystem.ServiceModel.Security.MessageSecurityException: The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;. ---&gt; System.Net.WebException: The remote server returned an error: (403) Forbidden. \\nat System.Net.HttpWebRequest.GetResponse() \\nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \\n--- End of inner exception stack trace --- \\n\\nServer stack trace: \\nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateAuthentication(HttpWebRequest request, HttpWebResponse response, WebException responseException, HttpChannelFactory`1 factory) \\nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest request, HttpWebResponse response, HttpChannelFactory`1 factory, WebException responseException, ChannelBinding channelBinding) \\nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \\nat System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout) \\nat System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout) \\nat System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) \\nat System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) \\nat System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) \\n\\nException rethrown at [0]: \\nat System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) \\nat System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp; msgData, Int32 type) \\nat Coveo.AdminService.AdminService.IAdminService.Ping() \\nat Coveo.AdminService.AdminServiceClientWrapper.PerformAdminServiceCall(Action p_Action) \\nat Coveo.AdminService.AdminServiceClientWrapper.Ping() \\nat Coveo.SearchProvider.Applications.OnPremiseStateVerifier.&lt;&gt;c__DisplayClassb.&lt;GetAdminServiceState&gt;b__a() \\nat Coveo.SearchProvider.Applications.BaseVerifier.VerifyComponent(Func`1 p_VerifyMethod, String p_ComponentName)</pre>\\n<br>Furthermore, accessing Coveo Admin Service at http://localhost/AdminService returns:\\n<pre class=\\\"ckeditor_codeblock\\\">\\n403 unauthorized</pre>\\n<br>Finally, when accessing\\u00a0https://localhost/AdminService returns (meaning the <a href=\\\"https://developers.coveo.com/display/public/SitecoreV4/Securing+the+Admin+Service+-+On-Premises\\\" target=\\\"_blank\\\">Admin Service is not secured</a>):\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nThis site can\\u2019t provide a secure connection \\n\\nlocalhost sent an invalid response. \\nTry running Windows Network Diagnostics. \\nERR_SSL_PROTOCOL_ERROR</pre>\\n<br><br><br><br><br>\\u00a0</div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Environment         </div>       </div>       <br/>       <table>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Product</td>           <td></td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Sitecore Version</td>           <td>N/A</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Connector</td>           <td>N/A</td>         </tr>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Published</td>           <td>1518013431</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Version</td>           <td></td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Build</td>           <td>All</td>         </tr>       </table>       <br/>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Cause         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> Because the Admin Service is not <a href=\\\"https://developers.coveo.com/display/public/SitecoreV4/Securing+the+Admin+Service+-+On-Premises\\\" target=\\\"_blank\\\">secured</a>, this means that the problem lies in the Admin Service Windows Service itself.<br><br>Most likely explanation is that:\\n<ul><li>The user running the Windows Service does not have full access to\\u00a0\\u00a0C:\\\\Program Files\\\\Coveo Enterprise Search 7</li><li>The user trying to access\\u00a0http://localhost/AdminService does not have sufficient access to\\u00a0C:\\\\Program Files\\\\Coveo Enterprise Search 7</li></ul></div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Resolution         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> Restarting the local machine hosting on-premises CES and Coveo for Sitecore resolved the problem.</div>     </div>   </body> </html>\"], \"sfpublishstatus\": [\"Online\"], \"sfcreatedbyid\": [\"00560000003q7JgAAI\"], \"kav_description__c__html_stripped\": [\"When installing Coveo for Sitecore in an all local environment with a local CES on-premises, when rebuilding the Indexes for the first time in Sitecore Control Panel \\u00ad\\u00ad>> Indexing manager, this errors appears in the Manager Window.\\u00a0\\n \\nJob started: Index_Update_IndexName=Coveo_master_index|#Exception: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.NullReferenceException: Object reference not set to an instance of an object. \\nat System.Object.GetType() \\nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, String p_ParameterName) \\nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, Func`1 p_ParameterExpression) \\nat Coveo.SearchProvider.Utils.ProviderUpdateContextTypeHandler.CreateInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \\nat Coveo.Framework.ObjectFactory.TypeHandlers.BaseCreateInstanceTypeHandler`1.Coveo.Framework.ObjectFactory.ICreateInstanceTypeHandler.CreateObjectInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \\nat Coveo.Framework.ObjectFactory.ObjectFactory.CreateInstance[T](Object[] p_Arguments) \\nat Coveo.SearchProvider.ProviderIndex.CreateUpdateContext() \\nat Coveo.SearchProvider.ProviderIndex.<Rebuild>b__42() \\nat Coveo.SearchProvider.ProviderIndex.TryPerformIndexingOperation(IndexingOptions p_IndexingOptions, Action p_Action) \\nat Coveo.SearchProvider.ProviderIndex.Rebuild() \\n--- End of inner exception stack trace --- \\nat System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor) \\nat System.Reflection.RuntimeMethodInfo.UnsafeInvokeInternal(Object obj, Object[] parameters, Object[] arguments) \\nat System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture) \\nat Sitecore.Reflection.ReflectionUtil.InvokeMethod(MethodInfo method, Object[] parameters, Object obj) \\nat Sitecore.Jobs.JobRunner.RunMethod(JobArgs args) \\nat (Object , Object[] ) \\nat Sitecore.Pipelines.CorePipeline.Run(PipelineArgs args) \\nat Sitecore.Jobs.Job.ThreadEntry(Object state) \\nIn addition, in Coveo for Sitecore diagnostic page, you see this message for the Coveo Search Web Service\\n\\n \\nSystem.ServiceModel.Security.MessageSecurityException: The HTTP request was forbidden with client authentication scheme 'Anonymous'. ---> System.Net.WebException: The remote server returned an error: (403) Forbidden. \\nat System.Net.HttpWebRequest.GetResponse() \\nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \\n--- End of inner exception stack trace --- \\n\\nServer stack trace: \\nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateAuthentication(HttpWebRequest request, HttpWebResponse response, WebException responseException, HttpChannelFactory`1 factory) \\nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest request, HttpWebResponse response, HttpChannelFactory`1 factory, WebException responseException, ChannelBinding channelBinding) \\nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \\nat System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout) \\nat System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout) \\nat System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) \\nat System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) \\nat System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) \\n\\nException rethrown at [0]: \\nat System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) \\nat System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) \\nat Coveo.AdminService.AdminService.IAdminService.Ping() \\nat Coveo.AdminService.AdminServiceClientWrapper.PerformAdminServiceCall(Action p_Action) \\nat Coveo.AdminService.AdminServiceClientWrapper.Ping() \\nat Coveo.SearchProvider.Applications.OnPremiseStateVerifier.<>c__DisplayClassb.<GetAdminServiceState>b__a() \\nat Coveo.SearchProvider.Applications.BaseVerifier.VerifyComponent(Func`1 p_VerifyMethod, String p_ComponentName) \\n \\n Furthermore, accessing Coveo Admin Service at http://localhost/AdminService returns:\\n \\n403 unauthorized \\n \\n Finally, when accessing\\u00a0https://localhost/AdminService returns (meaning the  Admin Service is not secured ):\\n\\n \\nThis site can\\u2019t provide a secure connection \\n\\nlocalhost sent an invalid response. \\nTry running Windows Network Diagnostics. \\nERR_SSL_PROTOCOL_ERROR \\n \\n \\n \\n \\n \\n \\u00a0\"], \"kav_islatestversion\": [true], \"kav_knowledgearticleid\": [\"kA132000000L8QeCAK\"], \"sfknowledgearticleid\": [\"kA132000000L8QeCAK\"], \"sfownername\": [\"Frederic Cote\"], \"kav_datacategoryselections.attribute.type\": [\"KB_Article__DataCategorySelection;KB_Article__DataCategorySelection\"], \"detectedtitle\": [\"Description\"], \"kav_createddate\": [1518012920], \"kav_build__c\": [\"All\"], \"language\": [\"English\"], \"coveo_foldingchild\": [\"1ae6a7cbd6f1aefd10143571f8dfefd7883d16ca1f43f0a2967b30393759\"], \"sfownerid\": [\"00560000003q7JgAAI\"], \"kav_createdby.coveo_record_size\": [2], \"kav_systemmodstamp\": [1518090402], \"objecttype\": [\"KB Article\"], \"connectortype\": [\"Salesforce2\"], \"kav_coveo_record_size\": [4], \"originaluri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US\"], \"sfisvisibleincsp\": [true], \"convertertype\": [\"TYPE_HTML\"], \"filetype\": [\"SalesforceItem\"], \"kav_owner.name\": [\"Frederic Cote\"], \"sfcoveoversionc\": [\"Coveo for Sitecore 3.0, Coveo for Sitecore 4.0\"], \"sfdcexpandedarticletype\": [\"All;All|Problem/Fix\"], \"objecttypelabelplural\": [\"KB Articles\"], \"sfcurrencyisocode\": [\"CAD\"], \"sfisdeleted\": [false], \"extractedsize\": [10948], \"size\": [13660], \"kav_publishstatus\": [\"Online\"], \"kav_connector__c\": [\"N/A\"], \"generateexcerpt\": [true], \"sfdescriptionc\": [\"When installing Coveo for Sitecore in an all local environment with a local CES on-premises, when rebuilding the Indexes for the first time in Sitecore Control Panel \\u00ad\\u00ad&gt;&gt; Indexing manager, this errors appears in the Manager Window.\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nJob started: Index_Update_IndexName=Coveo_master_index|#Exception: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---&gt; System.NullReferenceException: Object reference not set to an instance of an object. \\nat System.Object.GetType() \\nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, String p_ParameterName) \\nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, Func`1 p_ParameterExpression) \\nat Coveo.SearchProvider.Utils.ProviderUpdateContextTypeHandler.CreateInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \\nat Coveo.Framework.ObjectFactory.TypeHandlers.BaseCreateInstanceTypeHandler`1.Coveo.Framework.ObjectFactory.ICreateInstanceTypeHandler.CreateObjectInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \\nat Coveo.Framework.ObjectFactory.ObjectFactory.CreateInstance[T](Object[] p_Arguments) \\nat Coveo.SearchProvider.ProviderIndex.CreateUpdateContext() \\nat Coveo.SearchProvider.ProviderIndex.&lt;Rebuild&gt;b__42() \\nat Coveo.SearchProvider.ProviderIndex.TryPerformIndexingOperation(IndexingOptions p_IndexingOptions, Action p_Action) \\nat Coveo.SearchProvider.ProviderIndex.Rebuild() \\n--- End of inner exception stack trace --- \\nat System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor) \\nat System.Reflection.RuntimeMethodInfo.UnsafeInvokeInternal(Object obj, Object[] parameters, Object[] arguments) \\nat System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture) \\nat Sitecore.Reflection.ReflectionUtil.InvokeMethod(MethodInfo method, Object[] parameters, Object obj) \\nat Sitecore.Jobs.JobRunner.RunMethod(JobArgs args) \\nat (Object , Object[] ) \\nat Sitecore.Pipelines.CorePipeline.Run(PipelineArgs args) \\nat Sitecore.Jobs.Job.ThreadEntry(Object state)</pre>\\nIn addition, in Coveo for Sitecore diagnostic page, you see this message for the Coveo Search Web Service\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nSystem.ServiceModel.Security.MessageSecurityException: The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;. ---&gt; System.Net.WebException: The remote server returned an error: (403) Forbidden. \\nat System.Net.HttpWebRequest.GetResponse() \\nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \\n--- End of inner exception stack trace --- \\n\\nServer stack trace: \\nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateAuthentication(HttpWebRequest request, HttpWebResponse response, WebException responseException, HttpChannelFactory`1 factory) \\nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest request, HttpWebResponse response, HttpChannelFactory`1 factory, WebException responseException, ChannelBinding channelBinding) \\nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \\nat System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout) \\nat System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout) \\nat System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) \\nat System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) \\nat System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) \\n\\nException rethrown at [0]: \\nat System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) \\nat System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp; msgData, Int32 type) \\nat Coveo.AdminService.AdminService.IAdminService.Ping() \\nat Coveo.AdminService.AdminServiceClientWrapper.PerformAdminServiceCall(Action p_Action) \\nat Coveo.AdminService.AdminServiceClientWrapper.Ping() \\nat Coveo.SearchProvider.Applications.OnPremiseStateVerifier.&lt;&gt;c__DisplayClassb.&lt;GetAdminServiceState&gt;b__a() \\nat Coveo.SearchProvider.Applications.BaseVerifier.VerifyComponent(Func`1 p_VerifyMethod, String p_ComponentName)</pre>\\n<br>Furthermore, accessing Coveo Admin Service at http://localhost/AdminService returns:\\n<pre class=\\\"ckeditor_codeblock\\\">\\n403 unauthorized</pre>\\n<br>Finally, when accessing\\u00a0https://localhost/AdminService returns (meaning the <a href=\\\"https://developers.coveo.com/display/public/SitecoreV4/Securing+the+Admin+Service+-+On-Premises\\\" target=\\\"_blank\\\">Admin Service is not secured</a>):\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nThis site can\\u2019t provide a secure connection \\n\\nlocalhost sent an invalid response. \\nTry running Windows Network Diagnostics. \\nERR_SSL_PROTOCOL_ERROR</pre>\\n<br><br><br><br><br>\\u00a0\"], \"sfarticletype\": [\"KB_Article__kav\"], \"kav_articletype\": [\"KB_Article__kav\"], \"kav_lastmodifieddate\": [1518013431], \"documenttype\": [\"article\"], \"sfkbarticlekavid\": [\"ka10d0000004V22AAE\"], \"kav_currencyisocode\": [\"CAD\"], \"foldingparent\": [\"1ae6a7cbd6f1aefd10143571f8dfefd7883d16ca1f43f0a2967b30393759\"], \"mappingtype\": [\"KB_Article\"], \"kav_isvisibleinpkb\": [true], \"kav_sourceid\": [\"50032000018iLnNAAU\"], \"sfkbversionnumber\": [2], \"kav_isvisibleinapp\": [true], \"kav_resolution__c\": [\"Restarting the local machine hosting on-premises CES and Coveo for Sitecore resolved the problem.\"], \"coveo_objecttype\": [\"KB_Article\"], \"printableuri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US\"], \"kav_datacategoryselections.attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o0d000000mDrFAAU;/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o0d000000mDrGAAU\"], \"kav_id\": [\"ka10d0000004V22AAE\"], \"sfresolutionc\": [\"Restarting the local machine hosting on-premises CES and Coveo for Sitecore resolved the problem.\"], \"foldingchild\": [\"1ae6a7cbd6f1aefd10143571f8dfefd7883d16ca1f43f0a2967b30393759\"], \"sfcreateddate\": [1518012920], \"kav_sitecore_version__c\": [\"N/A\"], \"kav_owner.coveo_record_size\": [2], \"kav_coveo_effective_modstamp\": [1518090402], \"kav_summary__html_stripped\": [\"\"], \"kav_dc_article_type\": [\"Problem/Fix\"], \"sfconnectorc\": [\"N/A\"], \"kav_dc_product\": [\"Sitecore\"], \"ka_coveo_record_size\": [2], \"kav_dc_expanded_article_type\": [\"All;All|Problem/Fix\"], \"kav_datacategoryselections.coveo_record_size\": [\"2;2\"], \"concepts\": [\"Exception ; manager ; on-premises ; environment ; Program Files ; Precondition ; AdminService ; SitecoreFeaturesResolver ; ISitecoreFeaturesResolver ; CreateInstance ; ProviderUpdateContextTypeHandler ; SearchProvider ; ParameterName ; NullReferenceException ; TargetInvocationException\"], \"sfkbid\": [\"kA132000000L8QeCAK\"], \"kav_firstpublisheddate\": [1485292107], \"coveo_organization_id\": [\"00D3000000007r2\"], \"coveo_foldingcollection\": [\"093174d1b95acda838306f557a57b78fb9f9febec25bc28524e0d61fe720\"], \"sffirstpublisheddate\": [1485292107], \"sflastmodifieddate\": [1518013431], \"kav_coveo_version__c\": [\"Coveo for Sitecore 3.0, Coveo for Sitecore 4.0\"], \"kav_vendor_version__c__html_stripped\": [\"\"], \"detectedlanguage\": [1], \"kav_isvisibleinprm\": [true], \"kav_owner.attribute.type\": [\"Name\"], \"kav_lastmodifiedby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000003q7JgAAI\"], \"sitename\": [\"Community\"], \"kav_createdby.name\": [\"Frederic Cote\"], \"sfarticlenumber\": [\"000002030\"], \"kav_lastmodifiedby.coveo_record_size\": [2], \"sfisvisibleinpkb\": [true], \"kav_datacategoryselections.id\": [\"02o0d000000mDrFAAU;02o0d000000mDrGAAU\"], \"kav_description__c\": [\"When installing Coveo for Sitecore in an all local environment with a local CES on-premises, when rebuilding the Indexes for the first time in Sitecore Control Panel \\u00ad\\u00ad&gt;&gt; Indexing manager, this errors appears in the Manager Window.\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nJob started: Index_Update_IndexName=Coveo_master_index|#Exception: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---&gt; System.NullReferenceException: Object reference not set to an instance of an object. \\nat System.Object.GetType() \\nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, String p_ParameterName) \\nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, Func`1 p_ParameterExpression) \\nat Coveo.SearchProvider.Utils.ProviderUpdateContextTypeHandler.CreateInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \\nat Coveo.Framework.ObjectFactory.TypeHandlers.BaseCreateInstanceTypeHandler`1.Coveo.Framework.ObjectFactory.ICreateInstanceTypeHandler.CreateObjectInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \\nat Coveo.Framework.ObjectFactory.ObjectFactory.CreateInstance[T](Object[] p_Arguments) \\nat Coveo.SearchProvider.ProviderIndex.CreateUpdateContext() \\nat Coveo.SearchProvider.ProviderIndex.&lt;Rebuild&gt;b__42() \\nat Coveo.SearchProvider.ProviderIndex.TryPerformIndexingOperation(IndexingOptions p_IndexingOptions, Action p_Action) \\nat Coveo.SearchProvider.ProviderIndex.Rebuild() \\n--- End of inner exception stack trace --- \\nat System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor) \\nat System.Reflection.RuntimeMethodInfo.UnsafeInvokeInternal(Object obj, Object[] parameters, Object[] arguments) \\nat System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture) \\nat Sitecore.Reflection.ReflectionUtil.InvokeMethod(MethodInfo method, Object[] parameters, Object obj) \\nat Sitecore.Jobs.JobRunner.RunMethod(JobArgs args) \\nat (Object , Object[] ) \\nat Sitecore.Pipelines.CorePipeline.Run(PipelineArgs args) \\nat Sitecore.Jobs.Job.ThreadEntry(Object state)</pre>\\nIn addition, in Coveo for Sitecore diagnostic page, you see this message for the Coveo Search Web Service\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nSystem.ServiceModel.Security.MessageSecurityException: The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;. ---&gt; System.Net.WebException: The remote server returned an error: (403) Forbidden. \\nat System.Net.HttpWebRequest.GetResponse() \\nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \\n--- End of inner exception stack trace --- \\n\\nServer stack trace: \\nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateAuthentication(HttpWebRequest request, HttpWebResponse response, WebException responseException, HttpChannelFactory`1 factory) \\nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest request, HttpWebResponse response, HttpChannelFactory`1 factory, WebException responseException, ChannelBinding channelBinding) \\nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \\nat System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout) \\nat System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout) \\nat System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) \\nat System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) \\nat System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) \\n\\nException rethrown at [0]: \\nat System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) \\nat System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp; msgData, Int32 type) \\nat Coveo.AdminService.AdminService.IAdminService.Ping() \\nat Coveo.AdminService.AdminServiceClientWrapper.PerformAdminServiceCall(Action p_Action) \\nat Coveo.AdminService.AdminServiceClientWrapper.Ping() \\nat Coveo.SearchProvider.Applications.OnPremiseStateVerifier.&lt;&gt;c__DisplayClassb.&lt;GetAdminServiceState&gt;b__a() \\nat Coveo.SearchProvider.Applications.BaseVerifier.VerifyComponent(Func`1 p_VerifyMethod, String p_ComponentName)</pre>\\n<br>Furthermore, accessing Coveo Admin Service at http://localhost/AdminService returns:\\n<pre class=\\\"ckeditor_codeblock\\\">\\n403 unauthorized</pre>\\n<br>Finally, when accessing\\u00a0https://localhost/AdminService returns (meaning the <a href=\\\"https://developers.coveo.com/display/public/SitecoreV4/Securing+the+Admin+Service+-+On-Premises\\\" target=\\\"_blank\\\">Admin Service is not secured</a>):\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\nThis site can\\u2019t provide a secure connection \\n\\nlocalhost sent an invalid response. \\nTry running Windows Network Diagnostics. \\nERR_SSL_PROTOCOL_ERROR</pre>\\n<br><br><br><br><br>\\u00a0\"], \"kav_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__kav/ka10d0000004V22AAE\"], \"kav_articlenumber__stripped\": [\"2030\"], \"sfversionnumber\": [2], \"kav_attribute.type\": [\"KB_Article__kav\"], \"kav_validationstatus\": [\"Reviewed\"], \"coveo_foldingparent\": [\"1ae6a7cbd6f1aefd10143571f8dfefd7883d16ca1f43f0a2967b30393759\"], \"collection\": [\"default\"], \"sfsourceid\": [\"50032000018iLnNAAU\"], \"date\": [1518090402], \"kav_lastmodifiedby.id\": [\"00560000003q7JgAAI\"], \"kav_datacategoryselections.datacategorygroupname\": [\"Product;Article_Type\"], \"conversionstate\": [0], \"sfvalidationstatus\": [\"Reviewed\"], \"kav_isdeleted\": [false], \"sflastmodifiedbyid\": [\"00560000003q7JgAAI\"], \"kav_lastmodifiedby.name\": [\"Frederic Cote\"], \"kav_articlenumber\": [\"000002030\"], \"permanentid\": [\"e8ab0725666317e465fb83115783c31b773c03f5ed3ad53497abfdf9180b\"]}",
      "sfbuildc" : "All",
      "sflastmodifiedbyid" : "00560000003q7JgAAI",
      "syssfownerid" : "00560000003q7JgAAI",
      "sfsitecoreversionc" : "N/A",
      "sourcetype" : "Salesforce",
      "sysconnectortype" : "Salesforce2",
      "sftitle" : "Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild",
      "rowid" : 5493455,
      "syssfcreatedbyid" : "00560000003q7JgAAI",
      "sfdescriptionc" : "When installing Coveo for Sitecore in an all local environment with a local CES on-premises, when rebuilding the Indexes for the first time in Sitecore Control Panel ­­&gt;&gt; Indexing manager, this errors appears in the Manager Window. \n<pre class=\"ckeditor_codeblock\">\nJob started: Index_Update_IndexName=Coveo_master_index|#Exception: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---&gt; System.NullReferenceException: Object reference not set to an instance of an object. \nat System.Object.GetType() \nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, String p_ParameterName) \nat Coveo.Framework.CNL.Precondition.InstanceOf[TExpected](Object p_Parameter, Func`1 p_ParameterExpression) \nat Coveo.SearchProvider.Utils.ProviderUpdateContextTypeHandler.CreateInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \nat Coveo.Framework.ObjectFactory.TypeHandlers.BaseCreateInstanceTypeHandler`1.Coveo.Framework.ObjectFactory.ICreateInstanceTypeHandler.CreateObjectInstance(ISitecoreFeaturesResolver p_SitecoreFeaturesResolver, Object[] p_Arguments) \nat Coveo.Framework.ObjectFactory.ObjectFactory.CreateInstance[T](Object[] p_Arguments) \nat Coveo.SearchProvider.ProviderIndex.CreateUpdateContext() \nat Coveo.SearchProvider.ProviderIndex.&lt;Rebuild&gt;b__42() \nat Coveo.SearchProvider.ProviderIndex.TryPerformIndexingOperation(IndexingOptions p_IndexingOptions, Action p_Action) \nat Coveo.SearchProvider.ProviderIndex.Rebuild() \n--- End of inner exception stack trace --- \nat System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor) \nat System.Reflection.RuntimeMethodInfo.UnsafeInvokeInternal(Object obj, Object[] parameters, Object[] arguments) \nat System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture) \nat Sitecore.Reflection.ReflectionUtil.InvokeMethod(MethodInfo method, Object[] parameters, Object obj) \nat Sitecore.Jobs.JobRunner.RunMethod(JobArgs args) \nat (Object , Object[] ) \nat Sitecore.Pipelines.CorePipeline.Run(PipelineArgs args) \nat Sitecore.Jobs.Job.ThreadEntry(Object state)</pre>\nIn addition, in Coveo for Sitecore diagnostic page, you see this message for the Coveo Search Web Service\n\n<pre class=\"ckeditor_codeblock\">\nSystem.ServiceModel.Security.MessageSecurityException: The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;. ---&gt; System.Net.WebException: The remote server returned an error: (403) Forbidden. \nat System.Net.HttpWebRequest.GetResponse() \nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \n--- End of inner exception stack trace --- \n\nServer stack trace: \nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateAuthentication(HttpWebRequest request, HttpWebResponse response, WebException responseException, HttpChannelFactory`1 factory) \nat System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest request, HttpWebResponse response, HttpChannelFactory`1 factory, WebException responseException, ChannelBinding channelBinding) \nat System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) \nat System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout) \nat System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout) \nat System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) \nat System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) \nat System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) \n\nException rethrown at [0]: \nat System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) \nat System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp; msgData, Int32 type) \nat Coveo.AdminService.AdminService.IAdminService.Ping() \nat Coveo.AdminService.AdminServiceClientWrapper.PerformAdminServiceCall(Action p_Action) \nat Coveo.AdminService.AdminServiceClientWrapper.Ping() \nat Coveo.SearchProvider.Applications.OnPremiseStateVerifier.&lt;&gt;c__DisplayClassb.&lt;GetAdminServiceState&gt;b__a() \nat Coveo.SearchProvider.Applications.BaseVerifier.VerifyComponent(Func`1 p_VerifyMethod, String p_ComponentName)</pre>\n<br>Furthermore, accessing Coveo Admin Service at http://localhost/AdminService returns:\n<pre class=\"ckeditor_codeblock\">\n403 unauthorized</pre>\n<br>Finally, when accessing https://localhost/AdminService returns (meaning the <a href=\"https://developers.coveo.com/display/public/SitecoreV4/Securing+the+Admin+Service+-+On-Premises\" target=\"_blank\">Admin Service is not secured</a>):\n\n<pre class=\"ckeditor_codeblock\">\nThis site cant provide a secure connection \n\nlocalhost sent an invalid response. \nTry running Windows Network Diagnostics. \nERR_SSL_PROTOCOL_ERROR</pre>\n<br><br><br><br><br> ",
      "size" : 13660,
      "sfislatestversion" : "true",
      "sysdocumenttype" : "article",
      "sfcreateddate" : 1518012920000,
      "sfsourceid" : "50032000018iLnNAAU",
      "clickableuri" : "https://na61.salesforce.com/kA132000000L8Qe",
      "syssource" : "Salesforce Public Items",
      "sfownerid" : "00560000003q7JgAAI",
      "orderingid" : 212384990660372261,
      "sfpublishstatus" : "Online",
      "syssize" : 13660,
      "sysdate" : 1518090402000,
      "sflanguage" : "en_US",
      "sysparents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild\" uri=\"https://na61.salesforce.com/kA132000000L8Qe\" /></parents>",
      "sfdcexpandedarticletype" : "All;All|Problem/Fix",
      "sfcurrencyisocode" : "CAD",
      "sfkbid" : "kA132000000L8QeCAK",
      "sfcausec" : "Because the Admin Service is not <a href=\"https://developers.coveo.com/display/public/SitecoreV4/Securing+the+Admin+Service+-+On-Premises\" target=\"_blank\">secured</a>, this means that the problem lies in the Admin Service Windows Service itself.<br><br>Most likely explanation is that:\n<ul><li>The user running the Windows Service does not have full access to  C:\\Program Files\\Coveo Enterprise Search 7</li><li>The user trying to access http://localhost/AdminService does not have sufficient access to C:\\Program Files\\Coveo Enterprise Search 7</li></ul>",
      "sfdcexpandedproduct" : "All;All|Sitecore",
      "syssfcreateddate" : 1518012920000,
      "sflastmodifieddate" : 1518013431000,
      "sfisvisibleinpkb" : "true",
      "source" : "Salesforce Public Items",
      "sfisdeleted" : "false",
      "sfisvisibleincsp" : "true",
      "sfvalidationstatus" : "Reviewed",
      "sflastmodifiedbyname" : "Frederic Cote",
      "collection" : "default",
      "sfdcproduct" : [ "Sitecore" ],
      "syssourcetype" : "Salesforce",
      "sfarticletype" : "KB_Article__kav",
      "indexeddate" : 1518187607000,
      "connectortype" : "Salesforce2",
      "filetype" : "SalesforceItem",
      "sfcreatedbyname" : "Frederic Cote",
      "sysclickableuri" : "https://na61.salesforce.com/kA132000000L8Qe",
      "sysfiletype" : "SalesforceItem",
      "language" : [ "English" ],
      "sffirstpublisheddate" : 1485292107000,
      "sfownername" : "Frederic Cote",
      "sitename" : "Community",
      "sysrowid" : 5493455,
      "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
      "syscollection" : "default"
    },
    "Title" : "Coveo for Sitecore with On-Premises Index Return 403 Error For Admin Service During First Rebuild",
    "Uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
    "PrintableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
    "ClickUri" : "https://na61.salesforce.com/kA132000000L8Qe",
    "UniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA132000000L8QeCAK/language:en_US",
    "Excerpt" : "When installing Coveo for Sitecore in an all local environment with a local CES on-premises, when rebuilding the Indexes for the first time in Sitecore Control Panel >> Indexing manager, this error...",
    "FirstSentences" : null
  }