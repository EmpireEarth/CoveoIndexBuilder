{
    "title" : "Getting \"Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365\" error when indexing SharePoint On Premise with Crawling Module Beta version",
    "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
    "printableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
    "clickUri" : "https://na61.salesforce.com/kA10d0000004N3X",
    "uniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
    "excerpt" : "This KB explains the root cause and provide a solution to the error below: ... Error description ... Coveo Cloud is not able to authenticate to the SharePoint server and consequently cannot perform...",
    "firstSentences" : null,
    "summary" : null,
    "flags" : "HasHtmlVersion",
    "hasHtmlVersion" : true,
    "hasMobileHtmlVersion" : false,
    "score" : 1386,
    "percentScore" : 83.77184,
    "rankingInfo" : null,
    "rating" : 3.0,
    "isTopResult" : false,
    "isRecommendation" : false,
    "titleHighlights" : [ ],
    "firstSentencesHighlights" : [ ],
    "excerptHighlights" : [ ],
    "printableUriHighlights" : [ ],
    "summaryHighlights" : [ ],
    "parentResult" : null,
    "childResults" : [ ],
    "totalNumberOfChildResults" : 0,
    "raw" : {
      "systitle" : "Getting \"Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365\" error when indexing SharePoint On Premise with Crawling Module Beta version",
      "sysurihash" : "ViLs62KGne0S04ns",
      "urihash" : "ViLs62KGne0S04ns",
      "parents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Getting &quot;Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365&quot; error when indexing SharePoint On Premise with Crawling Module Beta version\" uri=\"https://na61.salesforce.com/kA10d0000004N3X\" /></parents>",
      "sfdcarticletype" : "Problem/Fix",
      "sfresolutionc" : "In the Json of the source, replace &quot;SpOnlineNative&quot; by the appropriate value.\n<ul><li>WindowsClassic or</li><li>WindowsUnderClaims</li></ul>\nClick SAVE AND REBUILD<br><br>Note: \n<ul><li>Every time you&#39;ll edit the source via the edit panel</li></ul>\n<br><img alt=\"User-added image\" height=\"78\" src=\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000025DT\" width=\"500\"></img>\n<ul><li>The change you did in the source JSON will be overrided.</li><li>So you&#39;ll have to Edit the JSON again to put back the right AuthenticationType value</li></ul>",
      "sysuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
      "sysprintableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
      "sflastpublisheddate" : 1516827567000,
      "systransactionid" : 161139,
      "sfurlname" : "2954",
      "sfsystemmodstamp" : 1517399256000,
      "sfisvisibleinapp" : "true",
      "sfcoveoversionc" : "Cloud Platform\nCoveo On-Premises Crawling Module (Beta)",
      "sysconcepts" : "SharePoint ; source credentials ; cloud ; crawling ; Site Collection Administrators ; connector ; sourceType ; on-premises instances ; authentication mode ; sufficient privileges ; SpOnlineNative ; AuthenticationType ; documentation ; configuration ; Troubleshooting",
      "sfkbversionnumber" : "1",
      "concepts" : "SharePoint ; source credentials ; cloud ; crawling ; Site Collection Administrators ; connector ; sourceType ; on-premises instances ; authentication mode ; sufficient privileges ; SpOnlineNative ; AuthenticationType ; documentation ; configuration ; Troubleshooting",
      "printableuri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
      "documenttype" : "article",
      "sfkbarticlekavid" : "ka10d0000004UjoAAE",
      "sysindexeddate" : 1518187600000,
      "sfknowledgearticleid" : "kA10d0000004N3XCAU",
      "sfcreatedbyid" : "00560000002MKBSAA4",
      "sfconnectorc" : "N/A",
      "permanentid" : "41de1009874a64eecaf629979f41fe7e22bfc793587e6ce3829fabb6ebfc",
      "syslanguage" : [ "English" ],
      "transactionid" : 161139,
      "sfisvisibleinprm" : "true",
      "title" : "Getting \"Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365\" error when indexing SharePoint On Premise with Crawling Module Beta version",
      "sfversionnumber" : 1,
      "sfarticlenumber" : "000002954",
      "date" : 1517399256000,
      "objecttype" : "KB Article",
      "allmetadatavalues" : "{\"kav_lastmodifiedby.attribute.type\": [\"User\"], \"coveo_short_id\": [\"kA10d0000004N3X\"], \"sflastmodifiedbyname\": [\"Karel Mpungi\"], \"kav_coveo_version__c__html_stripped\": [\"Cloud Platform\\r\\nCoveo On-Premises Crawling Module (Beta)\"], \"fileextension\": [\"\"], \"sfdcexpandedproduct\": [\"All;All|Cloud Platform\"], \"kav_createdby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"sflanguage\": [\"en_US\"], \"kav_createdby.attribute.type\": [\"User\"], \"kav_createdby.id\": [\"00560000002MKBSAA4\"], \"kav_language\": [\"en_US\"], \"sfsitecoreversionc\": [\"N/A\"], \"sourcetype\": [\"Salesforce\"], \"title\": [\"Getting \\\"Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365\\\" error when indexing SharePoint On Premise with Crawling Module Beta version\"], \"source\": [\"Salesforce Public Items\"], \"kav_owner.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"parents\": [\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?><parents><parent name=\\\"Organization\\\" uri=\\\"https://na61.salesforce.com/home/home.jsp\\\" /><parent name=\\\"KB_Article__ka\\\" uri=\\\"http://www.salesforce.com/org:organization/articletype:KB_Article\\\" /><parent name=\\\"Getting &quot;Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365&quot; error when indexing SharePoint On Premise with Crawling Module Beta version\\\" uri=\\\"https://na61.salesforce.com/kA10d0000004N3X\\\" /></parents>\"], \"sfisvisibleinprm\": [true], \"kav_title\": [\"Getting \\\"Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365\\\" error when indexing SharePoint On Premise with Crawling Module Beta version\"], \"kav_isvisibleincsp\": [true], \"hashtmlversion\": [true], \"kav_versionnumber\": [1], \"sfcreatedbyname\": [\"Karel Mpungi\"], \"sflastpublisheddate\": [1516827567], \"objecttypelabel\": [\"KB Article\"], \"kav_cause__c__html_stripped\": [\"In the  documentation , there is a note:\\u00a0 \\n Although your SharePoint instance is of the on-premises type, you must enter SHAREPOINT_ONLINE as the sourceType value. This value refers to the version 2 of the SharePoint connector developed by Coveo, and this connector is used both for cloud and on-premises instances.\\u00a0 \\n Since the sourceType is SharePoint Online, the AuthenticationType is set to SpOnlineNative by default. \\n \\u00a0\\n \\n},\\n      \\\"AuthenticationType\\\": {\\n        \\\"sensitive\\\": false,\\n        \\\"value\\\": \\\"SpOnlineNative\\\"\\n      }, \\n \\n To validate that, simply access to your source JSON: \\n \\n  \\u200b \\n \\n Check the AuthenticationType value: \\n \\n \"], \"originalhtmlcharset\": [1200], \"coveo_connector_hasbinarydata\": [false], \"kav_lastpublisheddate\": [1516827567], \"sfsystemmodstamp\": [1517399256], \"ka_attribute.type\": [\"KB_Article__ka\"], \"sfdcproduct\": [\"Cloud Platform\"], \"kav_resolution__c__html_stripped\": [\"In the Json of the source, replace\\u00a0\\\"SpOnlineNative\\\" by the appropriate value.\\n WindowsClassic or WindowsUnderClaims \\nClick SAVE AND REBUILD \\n \\n Note:\\u00a0\\n Every time you'll edit the source\\u00a0via the edit panel \\n \\n  \\n The change you did in the source JSON will be\\u00a0overrided. So you'll have to Edit the JSON again to put back the right\\u00a0AuthenticationType value\"], \"clickableuri\": [\"https://na61.salesforce.com/kA10d0000004N3X\"], \"sftitle\": [\"Getting \\\"Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365\\\" error when indexing SharePoint On Premise with Crawling Module Beta version\"], \"kav_owner.id\": [\"00560000002MKBSAA4\"], \"sfisvisibleinapp\": [true], \"ka_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__ka/kA10d0000004N3XCAU\"], \"sfdcarticletype\": [\"Problem/Fix\"], \"kav_cause__c\": [\"In the <a href=\\\"https://developers.coveo.com/display/public/CloudPlatform/Creating+a+Crawling+Module+Source\\\" target=\\\"_blank\\\">documentation</a>, there is a note:\\u00a0<br>Although your SharePoint instance is of the on-premises type, you must enter SHAREPOINT_ONLINE as the sourceType value. This value refers to the version 2 of the SharePoint connector developed by Coveo, and this connector is used both for cloud and on-premises instances.\\u00a0<br>Since the sourceType is SharePoint Online, the AuthenticationType is set to SpOnlineNative by default.<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\n},\\n      &quot;AuthenticationType&quot;: {\\n        &quot;sensitive&quot;: false,\\n        &quot;value&quot;: &quot;SpOnlineNative&quot;\\n      },</pre>\\n<br>To validate that, simply access to your source JSON:<br><br><img alt=\\\"User-added image\\\" height=\\\"223\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000025Cz\\\" width=\\\"500\\\"></img>\\u200b<br><br>Check the AuthenticationType value:<br><br><img alt=\\\"User-added image\\\" height=\\\"310\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000025D4\\\" width=\\\"500\\\"></img>\"], \"sfislatestversion\": [true], \"sfcausec\": [\"In the <a href=\\\"https://developers.coveo.com/display/public/CloudPlatform/Creating+a+Crawling+Module+Source\\\" target=\\\"_blank\\\">documentation</a>, there is a note:\\u00a0<br>Although your SharePoint instance is of the on-premises type, you must enter SHAREPOINT_ONLINE as the sourceType value. This value refers to the version 2 of the SharePoint connector developed by Coveo, and this connector is used both for cloud and on-premises instances.\\u00a0<br>Since the sourceType is SharePoint Online, the AuthenticationType is set to SpOnlineNative by default.<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\n},\\n      &quot;AuthenticationType&quot;: {\\n        &quot;sensitive&quot;: false,\\n        &quot;value&quot;: &quot;SpOnlineNative&quot;\\n      },</pre>\\n<br>To validate that, simply access to your source JSON:<br><br><img alt=\\\"User-added image\\\" height=\\\"223\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000025Cz\\\" width=\\\"500\\\"></img>\\u200b<br><br>Check the AuthenticationType value:<br><br><img alt=\\\"User-added image\\\" height=\\\"310\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000025D4\\\" width=\\\"500\\\"></img>\"], \"contenttype\": [\"binarydata\"], \"sfurlname\": [\"2954\"], \"ka_id\": [\"kA10d0000004N3XCAU\"], \"kav_datacategoryselections.datacategoryname\": [\"Cloud_Platform;Configuration\"], \"coveo_url\": [\"https://na61.salesforce.com/kA10d0000004N3X\"], \"kav_urlname\": [\"2954\"], \"kav_dc_expanded_product\": [\"All;All|Cloud Platform\"], \"foldingcollection\": [\"68a36b0effa80f1ef633364c5be6486ab11697a77dd7be8b9c7065a61867\"], \"body\": [\"<html>   <body>     <div style=\\\"background-color: #fff;border: 2px solid #BBC5CC;border-radius: 4px;float: left;font-family: lato;margin-left: 15px;margin-right: 15px;margin-bottom: 4%;padding: 10px;width: 60%;\\\">       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Description         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> This KB explains the root cause and provide a solution to the error below:<br><br>In the Cloud V2 Activity Browser:<br><img alt=\\\"User-added image\\\" height=\\\"84\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy14&amp;refid=0EM0d00000025Cp\\\" width=\\\"500\\\"></img><br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nAUTHENTICATION ISSUE\\nError description\\n\\nCoveo Cloud is not able to authenticate to the SharePoint server and consequently cannot perform any action regarding your source.\\n\\nTroubleshooting\\nEdit the configuration to review the source credentials, and ensure that the source credentials have sufficient privileges and that your authentication mode is supported (see Granting SharePoint Permissions to the Crawling Account).\\n\\nError code\\nSHAREPOINT_AUTHENTICATION_ERROR</pre>\\nIn Kibana:\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\n| ERROR | SharePoint Thread #0 for source ShaPointOnPremClassic | Coveo.Connectors.SharePoint.Repository | Unable to retrieve the Site Collection at http://vm-sp-kmsp2k10. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. \\nCoveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to login to Office 365 with user svc_km_sp2010@sup.coveo.com ---&gt; System.Security.Authentication.AuthenticationException: Could not retrieve a security token from the Office 365 STS located at https://login.microsoftonline.com/extSTS.srf: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---&gt; System.ServiceModel.Security.MessageSecurityException: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---&gt; System.ServiceModel.FaultException: Invalid Request</pre>\\n<br><br>\\u00a0</div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Environment         </div>       </div>       <br/>       <table>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Product</td>           <td></td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Sitecore Version</td>           <td>N/A</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Connector</td>           <td>N/A</td>         </tr>         <tr>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Published</td>           <td>1516827567</td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Version</td>           <td></td>           <td style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;font-weight: 600;\\\">Build</td>           <td></td>         </tr>       </table>       <br/>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Cause         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> In the <a href=\\\"https://developers.coveo.com/display/public/CloudPlatform/Creating+a+Crawling+Module+Source\\\" target=\\\"_blank\\\">documentation</a>, there is a note:\\u00a0<br>Although your SharePoint instance is of the on-premises type, you must enter SHAREPOINT_ONLINE as the sourceType value. This value refers to the version 2 of the SharePoint connector developed by Coveo, and this connector is used both for cloud and on-premises instances.\\u00a0<br>Since the sourceType is SharePoint Online, the AuthenticationType is set to SpOnlineNative by default.<br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\n},\\n      &quot;AuthenticationType&quot;: {\\n        &quot;sensitive&quot;: false,\\n        &quot;value&quot;: &quot;SpOnlineNative&quot;\\n      },</pre>\\n<br>To validate that, simply access to your source JSON:<br><br><img alt=\\\"User-added image\\\" height=\\\"223\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000025Cz\\\" width=\\\"500\\\"></img>\\u200b<br><br>Check the AuthenticationType value:<br><br><img alt=\\\"User-added image\\\" height=\\\"310\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000025D4\\\" width=\\\"500\\\"></img></div>       <div style=\\\"font-size: 1.5em;font-weight: 600;Padding-top: 30px;border-bottom: 1px solid #BBC5CC;\\\">         <div style=\\\"border-left: 1px solid #BBC5CC;border-top: 1px solid #BBC5CC;color: #296896;padding: 10px;width: 15%;\\\">           Resolution         </div>       </div>       <div style=\\\"margin-left: 35px;margin-top: 10px;font-size: 1em;\\\"> In the Json of the source, replace\\u00a0&quot;SpOnlineNative&quot; by the appropriate value.\\n<ul><li>WindowsClassic or</li><li>WindowsUnderClaims</li></ul>\\nClick SAVE AND REBUILD<br><br>Note:\\u00a0\\n<ul><li>Every time you&#39;ll edit the source\\u00a0via the edit panel</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"78\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000025DT\\\" width=\\\"500\\\"></img>\\n<ul><li>The change you did in the source JSON will be\\u00a0overrided.</li><li>So you&#39;ll have to Edit the JSON again to put back the right\\u00a0AuthenticationType value</li></ul></div>     </div>   </body> </html>\"], \"sfpublishstatus\": [\"Online\"], \"sfcreatedbyid\": [\"00560000002MKBSAA4\"], \"kav_description__c__html_stripped\": [\"This KB explains the root cause and provide a solution to the error below: \\n \\n In the Cloud V2 Activity Browser: \\n  \\n \\u00a0\\n \\nAUTHENTICATION ISSUE\\nError description\\n\\nCoveo Cloud is not able to authenticate to the SharePoint server and consequently cannot perform any action regarding your source.\\n\\nTroubleshooting\\nEdit the configuration to review the source credentials, and ensure that the source credentials have sufficient privileges and that your authentication mode is supported (see Granting SharePoint Permissions to the Crawling Account).\\n\\nError code\\nSHAREPOINT_AUTHENTICATION_ERROR \\nIn Kibana:\\n\\n \\n| ERROR | SharePoint Thread #0 for source ShaPointOnPremClassic | Coveo.Connectors.SharePoint.Repository | Unable to retrieve the Site Collection at http://vm-sp-kmsp2k10. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. \\nCoveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to login to Office 365 with user svc_km_sp2010@sup.coveo.com ---> System.Security.Authentication.AuthenticationException: Could not retrieve a security token from the Office 365 STS located at https://login.microsoftonline.com/extSTS.srf: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---> System.ServiceModel.Security.MessageSecurityException: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---> System.ServiceModel.FaultException: Invalid Request \\n \\n \\n \\u00a0\"], \"kav_islatestversion\": [true], \"kav_knowledgearticleid\": [\"kA10d0000004N3XCAU\"], \"sfknowledgearticleid\": [\"kA10d0000004N3XCAU\"], \"sfownername\": [\"Karel Mpungi\"], \"kav_datacategoryselections.attribute.type\": [\"KB_Article__DataCategorySelection;KB_Article__DataCategorySelection\"], \"detectedtitle\": [\"AUTHENTICATION ISSUE\"], \"kav_createddate\": [1516731368], \"language\": [\"English\"], \"coveo_foldingchild\": [\"808aed0ea0907d1b088dacb0ca5d644d130087159b486027c5b6d3141a44\"], \"sfownerid\": [\"00560000002MKBSAA4\"], \"kav_createdby.coveo_record_size\": [2], \"kav_systemmodstamp\": [1517399256], \"objecttype\": [\"KB Article\"], \"connectortype\": [\"Salesforce2\"], \"kav_coveo_record_size\": [4], \"originaluri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US\"], \"sfisvisibleincsp\": [true], \"convertertype\": [\"TYPE_HTML\"], \"filetype\": [\"SalesforceItem\"], \"kav_owner.name\": [\"Karel Mpungi\"], \"sfcoveoversionc\": [\"Cloud Platform\\r\\nCoveo On-Premises Crawling Module (Beta)\"], \"sfdcexpandedarticletype\": [\"All;All|Problem/Fix\"], \"objecttypelabelplural\": [\"KB Articles\"], \"sfcurrencyisocode\": [\"USD\"], \"sfisdeleted\": [false], \"extractedsize\": [5436], \"size\": [9120], \"kav_publishstatus\": [\"Online\"], \"kav_connector__c\": [\"N/A\"], \"generateexcerpt\": [true], \"sfdescriptionc\": [\"This KB explains the root cause and provide a solution to the error below:<br><br>In the Cloud V2 Activity Browser:<br><img alt=\\\"User-added image\\\" height=\\\"84\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy14&amp;refid=0EM0d00000025Cp\\\" width=\\\"500\\\"></img><br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nAUTHENTICATION ISSUE\\nError description\\n\\nCoveo Cloud is not able to authenticate to the SharePoint server and consequently cannot perform any action regarding your source.\\n\\nTroubleshooting\\nEdit the configuration to review the source credentials, and ensure that the source credentials have sufficient privileges and that your authentication mode is supported (see Granting SharePoint Permissions to the Crawling Account).\\n\\nError code\\nSHAREPOINT_AUTHENTICATION_ERROR</pre>\\nIn Kibana:\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\n| ERROR | SharePoint Thread #0 for source ShaPointOnPremClassic | Coveo.Connectors.SharePoint.Repository | Unable to retrieve the Site Collection at http://vm-sp-kmsp2k10. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. \\nCoveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to login to Office 365 with user svc_km_sp2010@sup.coveo.com ---&gt; System.Security.Authentication.AuthenticationException: Could not retrieve a security token from the Office 365 STS located at https://login.microsoftonline.com/extSTS.srf: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---&gt; System.ServiceModel.Security.MessageSecurityException: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---&gt; System.ServiceModel.FaultException: Invalid Request</pre>\\n<br><br>\\u00a0\"], \"sfarticletype\": [\"KB_Article__kav\"], \"kav_articletype\": [\"KB_Article__kav\"], \"kav_lastmodifieddate\": [1516827567], \"documenttype\": [\"article\"], \"sfkbarticlekavid\": [\"ka10d0000004UjoAAE\"], \"kav_currencyisocode\": [\"USD\"], \"foldingparent\": [\"808aed0ea0907d1b088dacb0ca5d644d130087159b486027c5b6d3141a44\"], \"mappingtype\": [\"KB_Article\"], \"kav_isvisibleinpkb\": [true], \"kav_sourceid\": [\"5000d00001H8YUIAA3\"], \"sfkbversionnumber\": [1], \"kav_isvisibleinapp\": [true], \"kav_resolution__c\": [\"In the Json of the source, replace\\u00a0&quot;SpOnlineNative&quot; by the appropriate value.\\n<ul><li>WindowsClassic or</li><li>WindowsUnderClaims</li></ul>\\nClick SAVE AND REBUILD<br><br>Note:\\u00a0\\n<ul><li>Every time you&#39;ll edit the source\\u00a0via the edit panel</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"78\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000025DT\\\" width=\\\"500\\\"></img>\\n<ul><li>The change you did in the source JSON will be\\u00a0overrided.</li><li>So you&#39;ll have to Edit the JSON again to put back the right\\u00a0AuthenticationType value</li></ul>\"], \"coveo_objecttype\": [\"KB_Article\"], \"printableuri\": [\"http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US\"], \"kav_datacategoryselections.attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o0d000000mCX8AAM;/services/data/v34.0/sobjects/KB_Article__DataCategorySelection/02o0d000000mCX9AAM\"], \"kav_id\": [\"ka10d0000004UjoAAE\"], \"sfresolutionc\": [\"In the Json of the source, replace\\u00a0&quot;SpOnlineNative&quot; by the appropriate value.\\n<ul><li>WindowsClassic or</li><li>WindowsUnderClaims</li></ul>\\nClick SAVE AND REBUILD<br><br>Note:\\u00a0\\n<ul><li>Every time you&#39;ll edit the source\\u00a0via the edit panel</li></ul>\\n<br><img alt=\\\"User-added image\\\" height=\\\"78\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1J&amp;refid=0EM0d00000025DT\\\" width=\\\"500\\\"></img>\\n<ul><li>The change you did in the source JSON will be\\u00a0overrided.</li><li>So you&#39;ll have to Edit the JSON again to put back the right\\u00a0AuthenticationType value</li></ul>\"], \"foldingchild\": [\"808aed0ea0907d1b088dacb0ca5d644d130087159b486027c5b6d3141a44\"], \"sfcreateddate\": [1516731368], \"kav_sitecore_version__c\": [\"N/A\"], \"kav_owner.coveo_record_size\": [2], \"kav_coveo_effective_modstamp\": [1517399256], \"kav_summary__html_stripped\": [\"\"], \"kav_dc_article_type\": [\"Problem/Fix\"], \"sfconnectorc\": [\"N/A\"], \"kav_dc_product\": [\"Cloud Platform\"], \"ka_coveo_record_size\": [2], \"kav_dc_expanded_article_type\": [\"All;All|Problem/Fix\"], \"kav_datacategoryselections.coveo_record_size\": [\"2;2\"], \"concepts\": [\"SharePoint ; source credentials ; cloud ; crawling ; Site Collection Administrators ; connector ; sourceType ; on-premises instances ; authentication mode ; sufficient privileges ; SpOnlineNative ; AuthenticationType ; documentation ; configuration ; Troubleshooting\"], \"sfkbid\": [\"kA10d0000004N3XCAU\"], \"kav_firstpublisheddate\": [1516827567], \"coveo_organization_id\": [\"00D3000000007r2\"], \"coveo_foldingcollection\": [\"68a36b0effa80f1ef633364c5be6486ab11697a77dd7be8b9c7065a61867\"], \"sffirstpublisheddate\": [1516827567], \"sflastmodifieddate\": [1516827567], \"kav_coveo_version__c\": [\"Cloud Platform\\r\\nCoveo On-Premises Crawling Module (Beta)\"], \"kav_vendor_version__c__html_stripped\": [\"\"], \"detectedlanguage\": [1], \"kav_isvisibleinprm\": [true], \"kav_owner.attribute.type\": [\"Name\"], \"kav_lastmodifiedby.attribute.url\": [\"/services/data/v34.0/sobjects/User/00560000002MKBSAA4\"], \"sitename\": [\"Community\"], \"kav_createdby.name\": [\"Karel Mpungi\"], \"sfarticlenumber\": [\"000002954\"], \"kav_lastmodifiedby.coveo_record_size\": [2], \"sfisvisibleinpkb\": [true], \"kav_datacategoryselections.id\": [\"02o0d000000mCX8AAM;02o0d000000mCX9AAM\"], \"kav_description__c\": [\"This KB explains the root cause and provide a solution to the error below:<br><br>In the Cloud V2 Activity Browser:<br><img alt=\\\"User-added image\\\" height=\\\"84\\\" src=\\\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy14&amp;refid=0EM0d00000025Cp\\\" width=\\\"500\\\"></img><br>\\u00a0\\n<pre class=\\\"ckeditor_codeblock\\\">\\nAUTHENTICATION ISSUE\\nError description\\n\\nCoveo Cloud is not able to authenticate to the SharePoint server and consequently cannot perform any action regarding your source.\\n\\nTroubleshooting\\nEdit the configuration to review the source credentials, and ensure that the source credentials have sufficient privileges and that your authentication mode is supported (see Granting SharePoint Permissions to the Crawling Account).\\n\\nError code\\nSHAREPOINT_AUTHENTICATION_ERROR</pre>\\nIn Kibana:\\n\\n<pre class=\\\"ckeditor_codeblock\\\">\\n| ERROR | SharePoint Thread #0 for source ShaPointOnPremClassic | Coveo.Connectors.SharePoint.Repository | Unable to retrieve the Site Collection at http://vm-sp-kmsp2k10. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. \\nCoveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to login to Office 365 with user svc_km_sp2010@sup.coveo.com ---&gt; System.Security.Authentication.AuthenticationException: Could not retrieve a security token from the Office 365 STS located at https://login.microsoftonline.com/extSTS.srf: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---&gt; System.ServiceModel.Security.MessageSecurityException: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---&gt; System.ServiceModel.FaultException: Invalid Request</pre>\\n<br><br>\\u00a0\"], \"kav_attribute.url\": [\"/services/data/v34.0/sobjects/KB_Article__kav/ka10d0000004UjoAAE\"], \"kav_articlenumber__stripped\": [\"2954\"], \"sfversionnumber\": [1], \"kav_attribute.type\": [\"KB_Article__kav\"], \"kav_validationstatus\": [\"Reviewed\"], \"coveo_foldingparent\": [\"808aed0ea0907d1b088dacb0ca5d644d130087159b486027c5b6d3141a44\"], \"collection\": [\"default\"], \"sfsourceid\": [\"5000d00001H8YUIAA3\"], \"date\": [1517399256], \"kav_lastmodifiedby.id\": [\"00560000002MKBSAA4\"], \"kav_datacategoryselections.datacategorygroupname\": [\"Product;Article_Type\"], \"conversionstate\": [0], \"sfvalidationstatus\": [\"Reviewed\"], \"kav_isdeleted\": [false], \"sflastmodifiedbyid\": [\"00560000002MKBSAA4\"], \"kav_lastmodifiedby.name\": [\"Karel Mpungi\"], \"kav_articlenumber\": [\"000002954\"], \"permanentid\": [\"41de1009874a64eecaf629979f41fe7e22bfc793587e6ce3829fabb6ebfc\"]}",
      "sflastmodifiedbyid" : "00560000002MKBSAA4",
      "syssfownerid" : "00560000002MKBSAA4",
      "sfsitecoreversionc" : "N/A",
      "sourcetype" : "Salesforce",
      "sysconnectortype" : "Salesforce2",
      "sftitle" : "Getting \"Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365\" error when indexing SharePoint On Premise with Crawling Module Beta version",
      "rowid" : 5493348,
      "syssfcreatedbyid" : "00560000002MKBSAA4",
      "sfdescriptionc" : "This KB explains the root cause and provide a solution to the error below:<br><br>In the Cloud V2 Activity Browser:<br><img alt=\"User-added image\" height=\"84\" src=\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy14&amp;refid=0EM0d00000025Cp\" width=\"500\"></img><br> \n<pre class=\"ckeditor_codeblock\">\nAUTHENTICATION ISSUE\nError description\n\nCoveo Cloud is not able to authenticate to the SharePoint server and consequently cannot perform any action regarding your source.\n\nTroubleshooting\nEdit the configuration to review the source credentials, and ensure that the source credentials have sufficient privileges and that your authentication mode is supported (see Granting SharePoint Permissions to the Crawling Account).\n\nError code\nSHAREPOINT_AUTHENTICATION_ERROR</pre>\nIn Kibana:\n\n<pre class=\"ckeditor_codeblock\">\n| ERROR | SharePoint Thread #0 for source ShaPointOnPremClassic | Coveo.Connectors.SharePoint.Repository | Unable to retrieve the Site Collection at http://vm-sp-kmsp2k10. Make sure the crawling identity is a member of the Site Collection Administrators group of this Site Collection. \nCoveo.Connectors.SharePoint.Exceptions.ConnectionExceptions.AuthenticationException: Authentication Failed. Details: Unable to login to Office 365 with user svc_km_sp2010@sup.coveo.com ---&gt; System.Security.Authentication.AuthenticationException: Could not retrieve a security token from the Office 365 STS located at https://login.microsoftonline.com/extSTS.srf: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---&gt; System.ServiceModel.Security.MessageSecurityException: An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail. ---&gt; System.ServiceModel.FaultException: Invalid Request</pre>\n<br><br> ",
      "size" : 9120,
      "sfislatestversion" : "true",
      "sysdocumenttype" : "article",
      "sfcreateddate" : 1516731368000,
      "sfsourceid" : "5000d00001H8YUIAA3",
      "clickableuri" : "https://na61.salesforce.com/kA10d0000004N3X",
      "syssource" : "Salesforce Public Items",
      "sfownerid" : "00560000002MKBSAA4",
      "orderingid" : 212384990660372155,
      "sfpublishstatus" : "Online",
      "syssize" : 9120,
      "sysdate" : 1517399256000,
      "sflanguage" : "en_US",
      "sysparents" : "<?xml version=\"1.0\" encoding=\"utf-16\"?><parents><parent name=\"Organization\" uri=\"https://na61.salesforce.com/home/home.jsp\" /><parent name=\"KB_Article__ka\" uri=\"http://www.salesforce.com/org:organization/articletype:KB_Article\" /><parent name=\"Getting &quot;Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365&quot; error when indexing SharePoint On Premise with Crawling Module Beta version\" uri=\"https://na61.salesforce.com/kA10d0000004N3X\" /></parents>",
      "sfdcexpandedarticletype" : "All;All|Problem/Fix",
      "sfcurrencyisocode" : "USD",
      "sfkbid" : "kA10d0000004N3XCAU",
      "sfcausec" : "In the <a href=\"https://developers.coveo.com/display/public/CloudPlatform/Creating+a+Crawling+Module+Source\" target=\"_blank\">documentation</a>, there is a note: <br>Although your SharePoint instance is of the on-premises type, you must enter SHAREPOINT_ONLINE as the sourceType value. This value refers to the version 2 of the SharePoint connector developed by Coveo, and this connector is used both for cloud and on-premises instances. <br>Since the sourceType is SharePoint Online, the AuthenticationType is set to SpOnlineNative by default.<br> \n<pre class=\"ckeditor_codeblock\">\n},\n      &quot;AuthenticationType&quot;: {\n        &quot;sensitive&quot;: false,\n        &quot;value&quot;: &quot;SpOnlineNative&quot;\n      },</pre>\n<br>To validate that, simply access to your source JSON:<br><br><img alt=\"User-added image\" height=\"223\" src=\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000025Cz\" width=\"500\"></img>\u200b<br><br>Check the AuthenticationType value:<br><br><img alt=\"User-added image\" height=\"310\" src=\"https://c.na61.content.force.com/servlet/rtaImage?eid=ka10d0000004Ujo&amp;feoid=00N32000002zy1O&amp;refid=0EM0d00000025D4\" width=\"500\"></img>",
      "sfdcexpandedproduct" : "All;All|Cloud Platform",
      "syssfcreateddate" : 1516731368000,
      "sflastmodifieddate" : 1516827567000,
      "sfisvisibleinpkb" : "true",
      "source" : "Salesforce Public Items",
      "sfisdeleted" : "false",
      "sfisvisibleincsp" : "true",
      "sfvalidationstatus" : "Reviewed",
      "sflastmodifiedbyname" : "Karel Mpungi",
      "collection" : "default",
      "sfdcproduct" : [ "Cloud Platform" ],
      "syssourcetype" : "Salesforce",
      "sfarticletype" : "KB_Article__kav",
      "indexeddate" : 1518187600000,
      "connectortype" : "Salesforce2",
      "filetype" : "SalesforceItem",
      "sfcreatedbyname" : "Karel Mpungi",
      "sysclickableuri" : "https://na61.salesforce.com/kA10d0000004N3X",
      "sysfiletype" : "SalesforceItem",
      "language" : [ "English" ],
      "sffirstpublisheddate" : 1516827567000,
      "sfownername" : "Karel Mpungi",
      "sitename" : "Community",
      "sysrowid" : 5493348,
      "uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
      "syscollection" : "default"
    },
    "Title" : "Getting \"Coveo.Connectors.SharePoint.Connection.Authentication.Authenticator | Unable to login to Office 365\" error when indexing SharePoint On Premise with Crawling Module Beta version",
    "Uri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
    "PrintableUri" : "http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
    "ClickUri" : "https://na61.salesforce.com/kA10d0000004N3X",
    "UniqueId" : "42.13819$http://www.salesforce.com/org:organization/articletype:KB_Article/article:kA10d0000004N3XCAU/language:en_US",
    "Excerpt" : "This KB explains the root cause and provide a solution to the error below: ... Error description ... Coveo Cloud is not able to authenticate to the SharePoint server and consequently cannot perform...",
    "FirstSentences" : null
  }